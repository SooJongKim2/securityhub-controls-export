Security Control ID,Title,Description,Severity Rating,Current Region Availability,Remediation URL,Parameters,NbStandardsImplementedIn,ImplementedInStandards,Remediation URL to Crawl,Category,Resource type,AWS Config rule,Schedule type,Remediation
ACM.1,Imported and ACM-issued certificates should be renewed after a specified time period,"This control checks whether an AWS Certificate Manager (ACM) certificate is renewed within the specified time period. It checks both imported certificates and certificates provided by ACM. The control fails if the certificate isn't renewed within the specified time period. Unless you provide a custom parameter value for the renewal period, Security Hub uses a default value of 30 days.",MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/ACM.1/remediation,"Parameter: daysToExpiration
Description: Number of days within which the ACM certificate must be renewed
Type: Integer
Default Value: 30
Min: 14
Max: 365
---
",3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/acm-controls.html#acm-1,Protect > Data Protection > Encryption of data-in-transit,AWS::ACM::Certificate,acm-certificate-expiration-check,Change triggered and periodic,"ACM provides managed renewal for your SSL/TLS certificates issued by Amazon. This means that ACM either renews your certificates automatically (if you use DNS validation), or it sends you email notices when the certificate expiration approaches. These services are provided for both public and private ACM certificates. For domains validated by email When a certificate is 45 days from expiration, ACM sends to the domain owner an email for each domain name. To validate the domains and complete the renewal, you must respond to the email notifications. For more information, see Renewal for domains validated by email in the AWS Certificate Manager User Guide. For domains validated by DNS ACM automatically renews certificates that use DNS validation. 60 days before the expiration, ACM verifies that the certificate can be renewed. If it cannot validate a domain name, then ACM sends a notification that manual validation is required. It sends these notifications 45 days, 30 days, 7 days, and 1 day before the expiration. For more information, see Renewal for domains validated by DNS in the AWS Certificate Manager User Guide."
ACM.2,"RSA certificates managed by ACM should use a key length of at least 2,048 bits","This control checks whether RSA certificates managed by AWS Certificate Manager use a key length of at least 2,048 bits. The control fails if the key length is smaller than 2,048 bits.",HIGH,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/ACM.2/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/acm-controls.html#acm-2,Identify > Inventory > Inventory services,AWS::ACM::Certificate,acm-certificate-rsa-check,Change triggered,"The minimum key length for RSA certificates issued by ACM is already 2,048 bits. For instructions on issuing new RSA certificates with ACM, see Issuing and managing certificates in the AWS Certificate Manager User Guide. While ACM allows you to import certificates with shorter key lengths, you must use keys of at least 2,048 bits to pass this control. You can't change the key length after importing a certificate. Instead, you must delete certificates with a key length smaller than 2,048 bits. For more information about importing certificates into ACM, see Prerequisites for importing certificates in the AWS Certificate Manager User Guide."
ACM.3,ACM certificates should be tagged,"This control checks whether an AWS Certificate Manager (ACM) certificate has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the certificate doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the certificate isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/ACM.3/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/acm-controls.html#acm-3,Identify > Inventory > Tagging,AWS::ACM::Certificate,tagged-acm-certificate (custom Security Hub rule),Change triggered,"To add tags to an ACM certificate, see Tagging AWS Certificate Manager certificates in the AWS Certificate Manager User Guide."
APIGateway.1,API Gateway REST and WebSocket API execution logging should be enabled,"This control checks whether all stages of an Amazon API Gateway REST or WebSocket API have logging enabled. The control fails if the 'loggingLevel' isn't 'ERROR' or 'INFO' for all stages of the API. Unless you provide custom parameter values to indicate that a specific log type should be enabled, Security Hub produces a passed finding if the logging level is either 'ERROR' or 'INFO'.",MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/APIGateway.1/remediation,"Parameter: loggingLevel
Description: Logging level
Type: Enum
Default Value: N/A
Min: N/A
Max: N/A
---
",2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/apigateway-controls.html#apigateway-1,Identify > Logging,AWS::ApiGateway::Stage,api-gw-execution-logging-enabled,Change triggered,"To enable logging for REST and WebSocket API operations, see Set up CloudWatch API logging using the API Gateway console in the API Gateway Developer Guide."
APIGateway.2,API Gateway REST API stages should be configured to use SSL certificates for backend authentication,This control checks whether Amazon API Gateway REST API stages have SSL certificates configured that backend systems can use to authenticate that incoming requests are from the API Gateway.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/APIGateway.2/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/apigateway-controls.html#apigateway-2,Protect > Data Protection > Encryption of data-in-transit,AWS::ApiGateway::Stage,api-gw-ssl-enabled,Change triggered,"For detailed instructions on how to generate and configure API Gateway REST API SSL certificates, see Generate and configure an SSL certificate for backend authentication in the API Gateway Developer Guide."
APIGateway.3,API Gateway REST API stages should have AWS X-Ray tracing enabled,This control checks whether AWS X-Ray active tracing is enabled for your Amazon API Gateway REST API stages.,LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/APIGateway.3/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/apigateway-controls.html#apigateway-3,Detect > Detection services,AWS::ApiGateway::Stage,api-gw-xray-enabled,Change triggered,"For detailed instructions on how to enable X-Ray active tracing for API Gateway REST API operations, see Amazon API Gateway active tracing support for AWS X-Ray in the AWS X-Ray Developer Guide."
APIGateway.4,API Gateway should be associated with a WAF Web ACL,This control checks to see if an API Gateway stage is using an AWS WAF Web ACL. This control fails if an AWS WAF Web ACL is not attached to a REST API Gateway stage.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/APIGateway.4/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/apigateway-controls.html#apigateway-4,Protect > Protective services,AWS::ApiGateway::Stage,api-gw-associated-with-waf,Change triggered,"For information on how to use the API Gateway console to associate an AWS WAF Regional web ACL with an existing API Gateway API stage, see Using AWS WAF to protect your APIs in the API Gateway Developer Guide."
APIGateway.5,API Gateway REST API cache data should be encrypted at rest,This control checks whether all methods in Amazon API Gateway REST API stages that have cache enabled are encrypted. The control fails if any method in API Gateway REST API stage is configured to cache and the cache is not encrypted.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/APIGateway.5/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/apigateway-controls.html#apigateway-5,"Protect > Data protection > Encryption of data at
   rest",AWS::ApiGateway::Stage,api-gw-cache-encrypted (custom Security Hub rule),Change triggered,"To configure API caching for a stage, see Enable Amazon API Gateway caching in the API Gateway Developer Guide. In Cache Settings, choose Encrypt cache data."
APIGateway.8,API Gateway routes should specify an authorization type,"This control checks if Amazon API Gateway routes have an authorization type. The control fails if the API Gateway route doesn't have any authorization type. Optionally, you can provide a custom parameter value if you want the control to pass only if the route uses the authorization type specified in the 'authorizationType' parameter.",MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/APIGateway.8/remediation,"Parameter: authorizationType
Description: Authorization type of the API routes
Type: Enum
Default Value: N/A
Min: N/A
Max: N/A
---
",2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/apigateway-controls.html#apigateway-8,Protect > Secure Access Management,AWS::ApiGatewayV2::Route,api-gwv2-authorization-type-configured,Periodic,"To set an authorization type for HTTP APIs, see Controlling and managing access to an HTTP API in API Gateway in the API Gateway Developer Guide. To set an authorization type for WebSocket APIs, see Controlling and managing access to a WebSocket API in API Gateway in the API Gateway Developer Guide."
APIGateway.9,Access logging should be configured for API Gateway V2 Stages,This control checks if Amazon API Gateway V2 stages have access logging configured. This control fails if access log settings aren’t defined.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/APIGateway.9/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/apigateway-controls.html#apigateway-9,Identify > Logging,AWS::ApiGatewayV2::Stage,api-gwv2-access-logs-enabled,Change triggered,"To set up access logging, see Set up CloudWatch API logging using the API Gateway console in the API Gateway Developer Guide."
Account.1,Security contact information should be provided for an AWS account.,This control checks if an Amazon Web Services (AWS) account has security contact information. The control fails if security contact information is not provided for the account.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Account.1/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, CIS AWS Foundations Benchmark v3.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/account-controls.html#account-1,Identify > Resource Configuration,AWS::::Account,security-account-information-provided,Periodic,"To add an alternate contact as a security contact to your AWS account, see Update the alternate contacts for your AWS account in the AWS Account Management Reference Guide."
Account.2,AWS account should be part of an AWS Organizations organization,This control checks if an AWS account is part of an AWS Organizations organization. The control fails if the account is not part of an organization.,HIGH,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Account.2/remediation,,1,NIST Special Publication 800-53 Revision 5,https://docs.aws.amazon.com/securityhub/latest/userguide/account-controls.html#account-2,Protect > Secure access management > Access control,AWS::::Account,account-part-of-organizations,Periodic,"To create a new organization and automatically add AWS accounts to it, see Creating an organization in the AWS Organizations User Guide. To add accounts to an existing organization, see Inviting an AWS account to join your organization in the AWS Organizations User Guide."
AppConfig.1,AWS AppConfig applications should be tagged,"This control checks whether an AWS AppConfig application has tags with the specific keys defined in the parameter requiredKeyTags. The control fails if the application doesn't have any tag keys or if it doesn't have all the keys specified in the parameter requiredKeyTags. If the parameter requiredKeyTags isn't provided, the control only checks for the existence of a tag key and fails if the application isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/AppConfig.1/remediation,"Parameter: requiredKeyTags
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/appconfig-controls.html#appconfig-1,Identify > Inventory > Tagging,AWS::AppConfig::Application,appconfig-application-tagged,Change triggered,"To add tags to an AWS AppConfig application, see TagResource in the AWS AppConfig API Reference."
AppConfig.2,AWS AppConfig configuration profiles should be tagged,"This control checks whether an AWS AppConfig configuration profile has tags with the specific keys defined in the parameter requiredKeyTags. The control fails if the configuration profile doesn't have any tag keys or if it doesn't have all the keys specified in the parameter requiredKeyTags. If the parameter requiredKeyTags isn't provided, the control only checks for the existence of a tag key and fails if the configuration profile isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/AppConfig.2/remediation,"Parameter: requiredKeyTags
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/appconfig-controls.html#appconfig-2,Identify > Inventory > Tagging,AWS::AppConfig::ConfigurationProfile,appconfig-configuration-profile-tagged,Change triggered,"To add tags to an AWS AppConfig configuration profile, see TagResource in the AWS AppConfig API Reference."
AppConfig.3,AWS AppConfig environments should be tagged,"This control checks whether an AWS AppConfig environment has tags with the specific keys defined in the parameter requiredKeyTags. The control fails if the environment doesn't have any tag keys or if it doesn't have all the keys specified in the parameter requiredKeyTags. If the parameter requiredKeyTags isn't provided, the control only checks for the existence of a tag key and fails if the environment isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/AppConfig.3/remediation,"Parameter: requiredKeyTags
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/appconfig-controls.html#appconfig-3,Identify > Inventory > Tagging,AWS::AppConfig::Environment,appconfig-environment-tagged,Change triggered,"To add tags to an AWS AppConfig environment, see TagResource in the AWS AppConfig API Reference."
AppConfig.4,AWS AppConfig extension associations should be tagged,"This control checks whether an AWS AppConfig extension association has tags with the specific keys defined in the parameter requiredKeyTags. The control fails if the extension association doesn't have any tag keys or if it doesn't have all the keys specified in the parameter requiredKeyTags. If the parameter requiredKeyTags isn't provided, the control only checks for the existence of a tag key and fails if the extension association isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/AppConfig.4/remediation,"Parameter: requiredKeyTags
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/appconfig-controls.html#appconfig-4,Identify > Inventory > Tagging,AWS::AppConfig::ExtensionAssociation,appconfig-extension-association-tagged,Change triggered,"To add tags to an AWS AppConfig extension association, see TagResource in the AWS AppConfig API Reference."
AppFlow.1,Amazon AppFlow flows should be tagged,"This control checks whether an Amazon AppFlow flow has tags with the specific keys defined in the parameter requiredKeyTags. The control fails if the flow doesn't have any tag keys or if it doesn't have all the keys specified in the parameter requiredKeyTags. If the parameter requiredKeyTags isn't provided, the control only checks for the existence of a tag key and fails if the flow isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/AppFlow.1/remediation,"Parameter: requiredKeyTags
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/appflow-controls.html#appflow-1,Identify > Inventory > Tagging,AWS::AppFlow::Flow,appflow-flow-tagged,Change triggered,"To add tags to an Amazon AppFlow flow, see Creating flows in Amazon AppFlow in the Amazon AppFlow User Guide."
AppRunner.1,App Runner services should be tagged,"This control checks whether an AWS App Runner service has tags with the specific keys defined in the parameter requiredKeyTags. The control fails if the App Runner service doesn't have any tag keys or if it doesn't have all the keys specified in the parameter requiredKeyTags. If the parameter requiredKeyTags isn't provided, the control only checks for the existence of a tag key and fails if the App Runner service isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,UNAVAILABLE,https://docs.aws.amazon.com/console/securityhub/AppRunner.1/remediation,"Parameter: requiredKeyTags
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/apprunner-controls.html#apprunner-1,Identify > Inventory > Tagging,AWS::AppRunner::Service,apprunner-service-tagged,Change triggered,"To add tags to an App Runner service, see TagResource in the AWS App Runner API Reference."
AppRunner.2,App Runner VPC connectors should be tagged,"This control checks whether an AWS App Runner VPC connector has tags with the specific keys defined in the parameter requiredKeyTags. The control fails if the VPC connector doesn't have any tag keys or if it doesn't have all the keys specified in the parameter requiredKeyTags. If the parameter requiredKeyTags isn't provided, the control only checks for the existence of a tag key and fails if the VPC connector isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,UNAVAILABLE,https://docs.aws.amazon.com/console/securityhub/AppRunner.2/remediation,"Parameter: requiredKeyTags
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/apprunner-controls.html#apprunner-2,Identify > Inventory > Tagging,AWS::AppRunner::VpcConnector,apprunner-service-tagged,Change triggered,"To add tags to an App Runner VPC connector, see TagResource in the AWS App Runner API Reference."
AppSync.1,AWS AppSync API caches should be encrypted at rest,This control checks whether an AWS AppSync API cache is encrypted at rest. The control fails if the API cache isn't encrypted at rest.,MEDIUM,UNAVAILABLE,https://docs.aws.amazon.com/console/securityhub/AppSync.1/remediation,,1,AWS Foundational Security Best Practices v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/appsync-controls.html#appsync-1,Protect > Data Protection > Encryption of data-at-rest,AWS::AppSync::GraphQLApi,appsync-cache-ct-encryption-at-rest,Change triggered,"You can't change the encryption settings after enabling caching for your AWS AppSync API. Instead, you must delete the cache and and recreate it with encryption enabled. For more information, see Cache encryption in the AWS AppSync Developer Guide."
AppSync.2,AWS AppSync should have field-level logging enabled,"This control checks whether an AWS AppSync API has field-level logging turned on. The control fails if the field resolver log level is set to 'None'. Unless you provide custom parameter values to indicate that a specific log type should be enabled, Security Hub produces a passed finding if the field resolver log level is either 'ERROR' or 'ALL'.",MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/AppSync.2/remediation,"Parameter: fieldLoggingLevel
Description: Field logging level
Type: Enum
Default Value: N/A
Min: N/A
Max: N/A
---
",2,"AWS Foundational Security Best Practices v1.0.0, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/appsync-controls.html#appsync-2,Identify > Logging,AWS::AppSync::GraphQLApi,appsync-logging-enabled,Change triggered,"To turn on logging for AWS AppSync, see Setup and configuration in the AWS AppSync Developer Guide."
AppSync.4,AWS AppSync GraphQL APIs should be tagged,"This control checks whether an AWS AppSync GraphQL API has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the GraphQL API doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the  GraphQL API isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/AppSync.4/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/appsync-controls.html#appsync-4,Identify > Inventory > Tagging,AWS::AppSync::GraphQLApi,tagged-appsync-graphqlapi (custom Security Hub rule),Change triggered,"To add tags to an AWS AppSync GraphQL API, see TagResource in the AWS AppSync API Reference."
AppSync.5,AWS AppSync GraphQL APIs should not be authenticated with API keys,This control checks whether your application uses an API key to interact with an AWS AppSync GraphQL API. The control fails if an AWS AppSync GraphQL API is authenticated with an API key.,HIGH,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/AppSync.5/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/appsync-controls.html#appsync-5,Protect > Secure access management > Passwordless authentication,AWS::AppSync::GraphQLApi,appsync-authorization-check,Change triggered,"To set an authorization option for your AWS AppSync GraphQL API, see Authorization and authentication in the AWS AppSync Developer Guide."
AppSync.6,AWS AppSync API caches should be encrypted in transit,This control checks whether an AWS AppSync API cache is encrypted in transit. The control fails if the API cache isn't encrypted in transit.,MEDIUM,UNAVAILABLE,https://docs.aws.amazon.com/console/securityhub/AppSync.6/remediation,,1,AWS Foundational Security Best Practices v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/appsync-controls.html#appsync-6,Protect > Data Protection > Encryption of data-in-transit,AWS::AppSync::ApiCache,appsync-cache-ct-encryption-in-transit,Change triggered,"You can't change the encryption settings after enabling caching for your AWS AppSync API. Instead, you must delete the cache and and recreate it with encryption enabled. For more information, see Cache encryption in the AWS AppSync Developer Guide."
Athena.2,Athena data catalogs should be tagged,"This control checks whether an Amazon Athena data catalog has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the data catalog doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the data catalog isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Athena.2/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/athena-controls.html#athena-2,Identify > Inventory > Tagging,AWS::Athena::DataCatalog,tagged-athena-datacatalog (custom Security Hub rule),Change triggered,"To add tags to an Athena data catalog, see Tagging Athena resources in the Amazon Athena User Guide."
Athena.3,Athena workgroups should be tagged,"This control checks whether an Amazon Athena workgroup has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the workgroup doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the workgroup isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Athena.3/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/athena-controls.html#athena-3,Identify > Inventory > Tagging,AWS::Athena::WorkGroup,tagged-athena-workgroup (custom Security Hub rule),Change triggered,"To add tags to an Athena workgroup, see Adding and deleting tags on an individual workgroup in the Amazon Athena User Guide."
Athena.4,Athena workgroups should have logging enabled,This control checks whether an Amazon Athena workgroup has logging enabled. The control fails if the workgroup doesn't have logging enabled.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Athena.4/remediation,,1,AWS Foundational Security Best Practices v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/athena-controls.html#athena-4,Identify > Logging,AWS::Athena::WorkGroup,athena-workgroup-logging-enabled,Change triggered,"To enable or disable query metrics for an Athena workgroup, see Enable CloudWatch query metrics in Athena in the Amazon Athena User Guide."
AutoScaling.1,Auto scaling groups associated with a load balancer should use ELB health checks,This control checks whether an Amazon EC2 Auto Scaling group that is associated with a load balancer uses Elastic Load Balancing (ELB) health checks. The control fails if the Auto Scaling group doesn't use ELB health checks.,LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/AutoScaling.1/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v3.2.1",https://docs.aws.amazon.com/securityhub/latest/userguide/autoscaling-controls.html#autoscaling-1,Identify > Inventory,AWS::AutoScaling::AutoScalingGroup,autoscaling-group-elb-healthcheck-required,Change triggered,"To add Elastic Load Balancing health checks, see Add Elastic Load Balancing health checks in the Amazon EC2 Auto Scaling User Guide."
AutoScaling.2,Amazon EC2 Auto Scaling group should cover multiple Availability Zones,"This control checks whether an Amazon EC2 Auto Scaling group spans at least the specified number of Availability Zones (AZs). The control fails if an Auto Scaling group doesn't span at least the specified number of AZs. Unless you provide a custom parameter value for the minimum number of AZs, Security Hub uses a default value of two AZs.",MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/AutoScaling.2/remediation,"Parameter: minAvailabilityZones
Description: Minimum number of Availability Zones
Type: Enum
Default Value: 2
Min: N/A
Max: N/A
---
",2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/autoscaling-controls.html#autoscaling-2,Recover > Resilience > High availability,AWS::AutoScaling::AutoScalingGroup,autoscaling-multiple-az,Change triggered,"To add AZs to an existing Auto Scaling group, see Add and remove Availability Zones in the Amazon EC2 Auto Scaling User Guide."
AutoScaling.3,Auto Scaling group launch configurations should configure EC2 instances to require Instance Metadata Service Version 2 (IMDSv2),"This control checks whether IMDSv2 is enabled on all instances launched by Amazon EC2 Auto Scaling groups. The control fails if the Instance Metadata Service (IMDS) version isn't included in the launch configuration or is configured as token optional, which is a setting that allows either IMDSv1 or IMDSv2.",HIGH,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/AutoScaling.3/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/autoscaling-controls.html#autoscaling-3,Protect > Secure network configuration,AWS::AutoScaling::LaunchConfiguration,autoscaling-launchconfig-requires-imdsv2,Change triggered,"An Auto Scaling group is associated with one launch configuration at a time. You cannot modify a launch configuration after you create it. To change the launch configuration for an Auto Scaling group, use an existing launch configuration as the basis for a new launch configuration with IMDSv2 enabled. For more information, see Configure instance metadata options for new instances in the Amazon EC2 User Guide."
AutoScaling.6,Auto Scaling groups should use multiple instance types in multiple Availability Zones,This control checks whether an Amazon EC2 Auto Scaling group uses multiple instance types. This control fails if the Amazon EC2 Auto Scaling group has only one instance type defined.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/AutoScaling.6/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/autoscaling-controls.html#autoscaling-6,Recover > Resilience > High availability,AWS::AutoScaling::AutoScalingGroup,autoscaling-multiple-instance-types,Change triggered,"To create an Auto Scaling group with multiple instance types, see Auto Scaling groups with multiple instance types and purchase options in the Amazon EC2 Auto Scaling User Guide."
AutoScaling.9,EC2 Auto Scaling groups should use EC2 launch templates,This control checks whether an Amazon EC2 Auto Scaling group is created from an EC2 launch template. This control fails if an Amazon EC2 Auto Scaling group is not created with a launch template or if a launch template is not specified in a mixed instances policy.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/AutoScaling.9/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/autoscaling-controls.html#autoscaling-9,Identify > Resource Configuration,AWS::AutoScaling::AutoScalingGroup,autoscaling-launch-template,Change triggered,"To create an Auto Scaling group with an EC2 launch template, see Create an Auto Scaling group using a launch template in the Amazon EC2 Auto Scaling User Guide. For information about how to replace a launch configuration with a launch template, see Replace a launch configuration with a launch template in the Amazon EC2 User Guide."
AutoScaling.10,EC2 Auto Scaling groups should be tagged,"This control checks whether an Amazon EC2 Auto Scaling group has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the Auto Scaling group doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the Auto Scaling group isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/AutoScaling.10/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/autoscaling-controls.html#autoscaling-10,Identify > Inventory > Tagging,AWS::AutoScaling::AutoScalingGroup,tagged-autoscaling-autoscalinggroup (custom Security Hub rule),Change triggered,"To add tags to an Auto Scaling group, see Tag Auto Scaling groups and instances in the Amazon EC2 Auto Scaling User Guide."
Autoscaling.5,Amazon EC2 instances launched using Auto Scaling group launch configurations should not have Public IP addresses,This control checks whether Amazon EC2 Auto Scaling groups have public IP addresses enabled using launch configurations.,HIGH,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Autoscaling.5/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/autoscaling-controls.html#autoscaling-5,Protect > Secure network configuration > Resources not publicly accessible,AWS::AutoScaling::LaunchConfiguration,autoscaling-launch-config-public-ip-disabled,Change triggered,"An Auto Scaling group is associated with one launch configuration at a time. You cannot modify a launch configuration after you create it. To change the launch configuration for an Auto Scaling group, use an existing launch configuration as the basis for a new launch configuration. Then, update the Auto Scaling group to use the new launch configuration. For step-by-step instructions, see Change the launch configuration for an Auto Scaling group in the Amazon EC2 Auto Scaling User Guide. When creating the new launch configuration, under Additional configuration, for Advanced details, IP address type, choose Do not assign a public IP address to any instances. After you change the launch configuration, Auto Scaling launches new instances with the new configuration options. Existing instances aren't affected. To update an existing instance, we recommend that you refresh your instance, or allow automatic scaling to gradually replace older instances with newer instances based on your termination policies. For more information about updating Auto Scaling instances, see Update Auto Scaling instances in the Amazon EC2 Auto Scaling User Guide."
Backup.1,AWS Backup recovery points should be encrypted at rest,This control checks if an AWS Backup recovery point is encrypted at rest. The control fails if the recovery point isn't encrypted at rest.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Backup.1/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/backup-controls.html#backup-1,Protect > Data Protection > Encryption of data-at-rest,AWS::Backup::RecoveryPoint,backup-recovery-point-encrypted,Change triggered,"To encrypt an AWS Backup recovery point, see Encryption for backups in AWS Backup in the AWS Backup Developer Guide."
Backup.2,AWS Backup recovery points should be tagged,"This control checks whether an AWS Backup recovery point has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the recovery point doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the recovery point isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Backup.2/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/backup-controls.html#backup-2,Identify > Inventory > Tagging,AWS::Backup::RecoveryPoint,tagged-backup-recoverypoint (custom Security Hub rule),Change triggered,"To add tags to an AWS Backup recovery pointOpen the AWS Backup console at https://console.aws.amazon.com/backup.In the navigation pane, choose Backup plans.Select a backup plan from the list.In the Backup plan tags section, choose Manage tags.Enter the key and value for the tag. Choose Add new tag for additional key-value pairs.When you are finished adding tags, choose Save."
Backup.3,AWS Backup vaults should be tagged,"This control checks whether an AWS Backup vault has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the vault doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the vault isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Backup.3/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/backup-controls.html#backup-3,Identify > Inventory > Tagging,AWS::Backup::BackupVault,tagged-backup-backupvault (custom Security Hub rule),Change triggered,"To add tags to an AWS Backup vaultOpen the AWS Backup console at https://console.aws.amazon.com/backup.In the navigation pane, choose Backup vaults.Select a backup vault from the list.In the Backup vault tags section, choose Manage tags.Enter the key and value for the tag. Choose Add new tag for additional key-value pairs.When you are finished adding tags, choose Save."
Backup.4,AWS Backup report plans should be tagged,"This control checks whether an AWS Backup report plan has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the report plan doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the report plan isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Backup.4/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/backup-controls.html#backup-4,Identify > Inventory > Tagging,AWS::Backup::ReportPlan,tagged-backup-reportplan (custom Security Hub rule),Change triggered,"To add tags to an AWS Backup report planOpen the AWS Backup console at https://console.aws.amazon.com/backup.In the navigation pane, choose Backup vaults.Select a backup vault from the list.In the Backup vault tags section, choose Manage tags.Choose Add new tag. Enter the key and value for the tag. Repeat for additional key-value pairs.When you are finished adding tags, choose Save."
Backup.5,AWS Backup backup plans should be tagged,"This control checks whether an AWS Backup backup plan has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the backup plan doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the backup plan isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Backup.5/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/backup-controls.html#backup-5,Identify > Inventory > Tagging,AWS::Backup::BackupPlan,tagged-backup-backupplan (custom Security Hub rule),Change triggered,"To add tags to an AWS Backup backup planOpen the AWS Backup console at https://console.aws.amazon.com/backup.In the navigation pane, choose Backup vaults.Select a backup vault from the list.In the Backup vault tags section, choose Manage tags.Choose Add new tag. Enter the key and value for the tag. Repeat for additional key-value pairs.When you are finished adding tags, choose Save."
Batch.1,Batch job queues should be tagged,"This control checks whether an AWS Batch job queue has tags with the specific keys defined in the parameter requiredKeyTags. The control fails if the job queue doesn't have any tag keys or if it doesn't have all the keys specified in the parameter requiredKeyTags. If the parameter requiredKeyTags isn't provided, the control only checks for the existence of a tag key and fails if the job queue isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Batch.1/remediation,"Parameter: requiredKeyTags
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/batch-controls.html#batch-1,Identify > Inventory > Tagging,AWS::Batch::JobQueue,batch-job-queue-tagged,Change triggered,"To add tags to a Batch job queue, see Tag your resources in the AWS Batch User Guide."
Batch.2,Batch scheduling policies should be tagged,"This control checks whether an AWS Batch scheduling policy has tags with the specific keys defined in the parameter requiredKeyTags. The control fails if the scheduling policy doesn't have any tag keys or if it doesn't have all the keys specified in the parameter requiredKeyTags. If the parameter requiredKeyTags isn't provided, the control only checks for the existence of a tag key and fails if the scheduling policy isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Batch.2/remediation,"Parameter: requiredKeyTags
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/batch-controls.html#batch-2,Identify > Inventory > Tagging,AWS::Batch::SchedulingPolicy,batch-scheduling-policy-tagged,Change triggered,"To add tags to a Batch scheduling policy, see Tag your resources in the AWS Batch User Guide."
Batch.3,Batch compute environments should be tagged,"This control checks whether an AWS Batch compute environment has tags with the specific keys defined in the parameter requiredKeyTags. The control fails if the compute environment doesn't have any tag keys or if it doesn't have all the keys specified in the parameter requiredKeyTags. If the parameter requiredKeyTags isn't provided, the control only checks for the existence of a tag key and fails if the compute environment isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Batch.3/remediation,"Parameter: requiredKeyTags
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/batch-controls.html#batch-3,Identify > Inventory > Tagging,AWS::Batch::ComputeEnvironment,batch-compute-environment-tagged,Change triggered,"To add tags to a Batch compute environment, see Tag your resources in the AWS Batch User Guide."
CloudFormation.2,CloudFormation stacks should be tagged,"This control checks whether an AWS CloudFormation stack has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the stack doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the stack isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/CloudFormation.2/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/cloudformation-controls.html#cloudformation-2,Identify > Inventory > Tagging,AWS::CloudFormation::Stack,tagged-cloudformation-stack (custom Security Hub rule),Change triggered,"To add tags to a CloudFormation stack, see CreateStack in the AWS CloudFormation API Reference."
CloudFront.1,CloudFront distributions should have a default root object configured,This control checks whether an Amazon CloudFront distribution is configured to return a specific object that is the default root object. The control fails if the CloudFront distribution does not have a default root object configured.,HIGH,UNAVAILABLE,https://docs.aws.amazon.com/console/securityhub/CloudFront.1/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/cloudfront-controls.html#cloudfront-1,"Protect > Secure access management > Resources
    not publicly accessible",AWS::CloudFront::Distribution,cloudfront-default-root-object-configured,Change triggered,"To configure a default root object for a CloudFront distribution, see How to specify a default root object in the Amazon CloudFront Developer Guide."
CloudFront.3,CloudFront distributions should require encryption in transit,"This control checks whether an Amazon CloudFront distribution requires viewers to use HTTPS directly, or whether it uses redirection. The control fails if ViewerProtocolPolicy is set to allow-all for defaultCacheBehavior or for cacheBehaviors.",MEDIUM,UNAVAILABLE,https://docs.aws.amazon.com/console/securityhub/CloudFront.3/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/cloudfront-controls.html#cloudfront-3,Protect > Data Protection > Encryption of data-in-transit,AWS::CloudFront::Distribution,cloudfront-viewer-policy-https,Change triggered,"To encrypt a CloudFront distribution in transit, see Requiring HTTPS for communication between viewers and CloudFront in the Amazon CloudFront Developer Guide."
CloudFront.4,CloudFront distributions should have origin failover configured,This control checks whether an Amazon CloudFront distribution is configured with an origin group that has 2 or more origins.,LOW,UNAVAILABLE,https://docs.aws.amazon.com/console/securityhub/CloudFront.4/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/cloudfront-controls.html#cloudfront-4,Recover > Resilience > High availability,AWS::CloudFront::Distribution,cloudfront-origin-failover-enabled,Change triggered,"To configure origin failover for a CloudFront distribution, see Creating an origin group in the Amazon CloudFront Developer Guide."
CloudFront.5,CloudFront distributions should have logging enabled,This control checks to see if server access logging is enabled on Amazon CloudFront Distributions. The control will fail if access logging is not enabled for the distribution.,MEDIUM,UNAVAILABLE,https://docs.aws.amazon.com/console/securityhub/CloudFront.5/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/cloudfront-controls.html#cloudfront-5,Identify > Logging,AWS::CloudFront::Distribution,cloudfront-accesslogs-enabled,Change triggered,"To configure standard logging (legacy) for a CloudFront distribution, see Configure standard logging (legacy) in the Amazon CloudFront Developer Guide."
CloudFront.6,CloudFront distributions should have WAF enabled,This control checks to see if Amazon CloudFront distributions are associated with either WAF or WAFv2 web ACLs. The control fails if a CloudFront distribution is not associated with a web ACL.,MEDIUM,UNAVAILABLE,https://docs.aws.amazon.com/console/securityhub/CloudFront.6/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/cloudfront-controls.html#cloudfront-6,Protect > Protective services,AWS::CloudFront::Distribution,cloudfront-associated-with-waf,Change triggered,"To associate an AWS WAF web ACL with a CloudFront distribution, see Using AWS WAF to control access to your content in the Amazon CloudFront Developer Guide."
CloudFront.7,CloudFront distributions should use custom SSL/TLS certificates,This control checks if CloudFront distributions are using the default SSL/TLS certificate CloudFront provides instead of a custom one. This control fails for a CloudFront distribution if it uses the default SSL/TLS certificate.,MEDIUM,UNAVAILABLE,https://docs.aws.amazon.com/console/securityhub/CloudFront.7/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/cloudfront-controls.html#cloudfront-7,Protect > Data Protection > Encryption of data-in-transit,AWS::CloudFront::Distribution,cloudfront-custom-ssl-certificate,Change triggered,"To add an alternate domain name for a CloudFront distribution using a custom SSL/TLS certificate, see Adding an alternate domain name in the Amazon CloudFront Developer Guide."
CloudFront.8,CloudFront distributions should use SNI to serve HTTPS requests,This control checks if Amazon CloudFront distributions are using a custom SSL/TLS certificate and are configured to use SNI to serve HTTPS requests as opposed to dedicated IP address.,LOW,UNAVAILABLE,https://docs.aws.amazon.com/console/securityhub/CloudFront.8/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/cloudfront-controls.html#cloudfront-8,Protect > Secure network configuration,AWS::CloudFront::Distribution,cloudfront-sni-enabled,Change triggered,"To configure a CloudFront distribution to use SNI to serve HTTPS requests, see Using SNI to Serve HTTPS Requests (works for Most Clients) in the CloudFront Developer Guide. For information about custom SSL certificates, see Requirements for using SSL/TLS certificates with CloudFront."
CloudFront.9,CloudFront distributions should encrypt traffic to custom origins,This control checks if CloudFront distributions are encrypting traffic to custom origins. This control fails if ‘OriginProtocolPolicy’ is ‘http-only’ or if ‘OriginProtocolPolicy’ is ‘match-viewer’ and ‘ViewerProtocolPolicy’ is ‘allow-all’.,MEDIUM,UNAVAILABLE,https://docs.aws.amazon.com/console/securityhub/CloudFront.9/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/cloudfront-controls.html#cloudfront-9,Protect > Data Protection > Encryption of data-in-transit,AWS::CloudFront::Distribution,cloudfront-traffic-to-origin-encrypted,Change triggered,"To update the Origin Protocol Policy to require encryption for a CloudFront connection, see Requiring HTTPS for communication between CloudFront and your custom origin in the Amazon CloudFront Developer Guide."
CloudFront.10,CloudFront distributions should not use deprecated SSL protocols between edge locations and custom origins,This control checks if CloudFront distributions are using deprecated SSL protocols for HTTPS communication between CloudFront edge locations and your custom origins. This control fails for a CloudFront distribution if it has a 'CustomOriginConfig' where ‘OriginSslProtocols’ includes ‘SSLv3’.,MEDIUM,UNAVAILABLE,https://docs.aws.amazon.com/console/securityhub/CloudFront.10/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/cloudfront-controls.html#cloudfront-10,Protect > Data Protection > Encryption of data-in-transit,AWS::CloudFront::Distribution,cloudfront-no-deprecated-ssl-protocols,Change triggered,"To update the Origin SSL Protocols for a CloudFront distribution, see Requiring HTTPS for communication between CloudFront and your custom origin in the Amazon CloudFront Developer Guide."
CloudFront.12,CloudFront distributions should not point to non-existent S3 origins,This control checks whether Amazon CloudFront distributions are pointing to non-existent S3 origins. The control fails for a CloudFront distribution if the origin is configured to point to a non-existent bucket. This control only applies to CloudFront distributions where an S3 bucket without static website hosting is the S3 origin.,HIGH,UNAVAILABLE,https://docs.aws.amazon.com/console/securityhub/CloudFront.12/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/cloudfront-controls.html#cloudfront-12,Identify > Resource configuration,AWS::CloudFront::Distribution,cloudfront-s3-origin-non-existent-bucket,Periodic,"To modify a CloudFront distribution to point to a new origin, see Updating a distribution in the Amazon CloudFront Developer Guide."
CloudFront.13,CloudFront distributions should use origin access control,This control checks whether an Amazon CloudFront distribution with an Amazon S3 origin has origin access control (OAC) configured. The control fails if OAC isn't configured.,MEDIUM,UNAVAILABLE,https://docs.aws.amazon.com/console/securityhub/CloudFront.13/remediation,,1,AWS Foundational Security Best Practices v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/cloudfront-controls.html#cloudfront-13,Protect > Secure access management > Resource not publicly accessible,AWS::CloudFront::Distribution,cloudfront-s3-origin-access-control-enabled,Change triggered,"To configure OAC for a CloudFront distribution with S3 origins, see Restricting access to an Amazon S3 origin in the Amazon CloudFront Developer Guide."
CloudFront.14,CloudFront distributions should be tagged,"This control checks whether an Amazon CloudFront distribution has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the distribution doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the distribution isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,UNAVAILABLE,https://docs.aws.amazon.com/console/securityhub/CloudFront.14/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/cloudfront-controls.html#cloudfront-14,Identify > Inventory > Tagging,AWS::CloudFront::Distribution,tagged-cloudfront-distribution (custom Security Hub rule),Change triggered,"To add tags to a CloudFront distribution, see Tagging Amazon CloudFront distributions in the Amazon CloudFront Developer Guide."
CloudTrail.1,CloudTrail should be enabled and configured with at least one multi-Region trail that includes read and write management events,This AWS control checks that there is at least one multi-region AWS CloudTrail trail includes read and write management events.,HIGH,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/CloudTrail.1/remediation,,5,"AWS Foundational Security Best Practices v1.0.0, CIS AWS Foundations Benchmark v1.2.0, CIS AWS Foundations Benchmark v1.4.0, CIS AWS Foundations Benchmark v3.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/cloudtrail-controls.html#cloudtrail-1,Identify > Logging,AWS::::Account,multi-region-cloudtrail-enabled,Periodic,"To create a new multi-Region trail in CloudTrail, see Creating a trail in the AWS CloudTrail User Guide. Use the following values: Field Value Additional settings, Log file validation Enabled Choose log events, Management events, API activity Read and Write. Clear check boxes for exclusions. To update an existing trail, see Updating a trail in the AWS CloudTrail User Guide. In Management events, for API activity, choose Read and Write."
CloudTrail.2,CloudTrail should have encryption at-rest enabled,This AWS control checks whether AWS CloudTrail is configured to use the server side encryption (SSE) AWS Key Management Service (AWS KMS) customer master key (CMK) encryption. The check will pass if the KmsKeyId is defined.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/CloudTrail.2/remediation,,7,"AWS Foundational Security Best Practices v1.0.0, CIS AWS Foundations Benchmark v1.2.0, CIS AWS Foundations Benchmark v1.4.0, CIS AWS Foundations Benchmark v3.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v3.2.1, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/cloudtrail-controls.html#cloudtrail-2,Protect > Data Protection > Encryption of data-at-rest,AWS::CloudTrail::Trail,cloud-trail-encryption-enabled,Periodic,"To enable SSE-KMS encryption for CloudTrail log files, see Update a trail to use a KMS key in the AWS CloudTrail User Guide."
CloudTrail.3,At least one CloudTrail trail should be enabled,This control checks whether an AWS CloudTrail trail is enabled in your AWS account. The control fails if your account doesn't have at least one CloudTrail trail enabled.,HIGH,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/CloudTrail.3/remediation,,2,"PCI DSS v3.2.1, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/cloudtrail-controls.html#cloudtrail-3,Identify > Logging,AWS::::Account,cloudtrail-enabled,Periodic,"To get started with CloudTrail and create a trail, see the Getting started with AWS CloudTrail tutorial in the AWS CloudTrail User Guide."
CloudTrail.4,CloudTrail log file validation should be enabled,This AWS control checks whether CloudTrail log file validation is enabled.,LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/CloudTrail.4/remediation,,7,"AWS Foundational Security Best Practices v1.0.0, CIS AWS Foundations Benchmark v1.2.0, CIS AWS Foundations Benchmark v1.4.0, CIS AWS Foundations Benchmark v3.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v3.2.1, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/cloudtrail-controls.html#cloudtrail-4,Data protection > Data integrity,AWS::CloudTrail::Trail,cloud-trail-log-file-validation-enabled,Periodic,"To enable CloudTrail log file validation, see Enabling log file integrity validation for CloudTrail in the AWS CloudTrail User Guide."
CloudTrail.5,CloudTrail trails should be integrated with Amazon CloudWatch Logs,This AWS control checks whether AWS CloudTrail trails are configured to send logs to Amazon CloudWatch Logs.,LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/CloudTrail.5/remediation,,5,"AWS Foundational Security Best Practices v1.0.0, CIS AWS Foundations Benchmark v1.2.0, CIS AWS Foundations Benchmark v1.4.0, NIST Special Publication 800-53 Revision 5, PCI DSS v3.2.1",https://docs.aws.amazon.com/securityhub/latest/userguide/cloudtrail-controls.html#cloudtrail-5,Identify > Logging,AWS::CloudTrail::Trail,cloud-trail-cloud-watch-logs-enabled,Periodic,"To integrate CloudTrail with CloudWatch Logs, see Sending events to CloudWatch Logs in the AWS CloudTrail User Guide."
CloudTrail.6,Ensure the S3 bucket used to store CloudTrail logs is not publicly accessible,"CloudTrail logs a record of every API call made in your account. These log files are stored in an S3 bucket. CIS recommends that the S3 bucket policy, or access control list (ACL), applied to the S3 bucket that CloudTrail logs to prevents public access to the CloudTrail logs. Allowing public access to CloudTrail log content might aid an adversary in identifying weaknesses in the affected account's use or configuration.",CRITICAL,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/CloudTrail.6/remediation,,3,"CIS AWS Foundations Benchmark v1.2.0, CIS AWS Foundations Benchmark v1.4.0, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/cloudtrail-controls.html#cloudtrail-6,Identify > Logging,AWS::S3::Bucket,None (custom Security Hub rule),"Periodic and change
                triggered","To block public access to your CloudTrail S3 bucket, see Configuring block public access settings for your S3 buckets in the Amazon Simple Storage Service User Guide. Select all four Amazon S3 Block Public Access Settings."
CloudTrail.7,Ensure S3 bucket access logging is enabled on the CloudTrail S3 bucket,"S3 Bucket Access Logging generates a log that contains access records for each request made to your S3 bucket. An access log record contains details about the request, such as the request type, the resources specified in the request worked, and the time and date the request was processed. It is recommended that bucket access logging be enabled on the CloudTrail S3 bucket.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/CloudTrail.7/remediation,,4,"CIS AWS Foundations Benchmark v1.2.0, CIS AWS Foundations Benchmark v1.4.0, CIS AWS Foundations Benchmark v3.0.0, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/cloudtrail-controls.html#cloudtrail-7,Identify > Logging,AWS::S3::Bucket,None (custom Security Hub rule),Periodic,"To enable server access logging for your CloudTrail S3 bucket, see Enabling Amazon S3 server access logging in the Amazon Simple Storage Service User Guide."
CloudTrail.9,CloudTrail trails should be tagged,"This control checks whether an AWS CloudTrail trail has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the trail doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the trail isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/CloudTrail.9/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/cloudtrail-controls.html#cloudtrail-9,Identify > Inventory > Tagging,AWS::CloudTrail::Trail,tagged-cloudtrail-trail (custom Security Hub rule),Change triggered,"To add tags to a CloudTrail trail, see AddTags in the AWS CloudTrail API Reference."
CloudWatch.1,"A log metric filter and alarm should exist for usage of the ""root"" user","This control checks for the CloudWatch metric filters using the following pattern { $.userIdentity.type = ""Root"" && $.userIdentity.invokedBy NOT EXISTS && $.eventType != ""AwsServiceEvent"" } It checks that the log group name is configured for use with active multi-region CloudTrail, that there is at least one Event Selector for a Trail with IncludeManagementEvents set to true and ReadWriteType set to All, and that there is at least one active subscriber to an SNS topic associated with the alarm.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/CloudWatch.1/remediation,,3,"CIS AWS Foundations Benchmark v1.2.0, CIS AWS Foundations Benchmark v1.4.0, PCI DSS v3.2.1",https://docs.aws.amazon.com/securityhub/latest/userguide/cloudwatch-controls.html#cloudwatch-1,Detect > Detection services,AWS::Logs::MetricFilter,None (custom Security Hub rule),Periodic,"To pass this control, follow these steps to create an Amazon SNS topic, an AWS CloudTrail trail, a metric filter, and an alarm for the metric filter. Create an Amazon SNS topic. For instructions, see Getting started with Amazon SNS in the Amazon Simple Notification Service Developer Guide. Create a topic that receives all CIS alarms, and create at least one subscription to the topic.Create a CloudTrail trail that applies to all AWS Regions. For instructions, see Creating a trail in the AWS CloudTrail User Guide. Make note of the name of the CloudWatch Logs log group that you associate with the CloudTrail trail. You create the metric filter for that log group in the next step.Create a metric filter. For instructions, see Create a metric filter for a log group in the Amazon CloudWatch User Guide. Use the following values: Field Value Define pattern, Filter pattern {$.userIdentity.type=""Root"" && $.userIdentity.invokedBy NOT EXISTS && $.eventType !=""AwsServiceEvent""} Metric namespace LogMetrics Metric value 1 Default value 0 Create an alarm based on the filter. For instructions, see Create a CloudWatch alarm based on a log group-metric filter in the Amazon CloudWatch User Guide. Use the following values: Field Value Conditions, Threshold type Static Whenever your-metric-name is... Greater/Equal than... 1"
CloudWatch.2,Ensure a log metric filter and alarm exist for unauthorized API calls,Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for unauthorized API calls.,LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/CloudWatch.2/remediation,,1,CIS AWS Foundations Benchmark v1.2.0,https://docs.aws.amazon.com/securityhub/latest/userguide/cloudwatch-controls.html#cloudwatch-2,Detect > Detection services,AWS::Logs::MetricFilter,None (custom Security Hub rule),Periodic,"To pass this control, follow these steps to create an Amazon SNS topic, an AWS CloudTrail trail, a metric filter, and an alarm for the metric filter. Create an Amazon SNS topic. For instructions, see Getting started with Amazon SNS in the Amazon Simple Notification Service Developer Guide. Create a topic that receives all CIS alarms, and create at least one subscription to the topic.Create a CloudTrail trail that applies to all AWS Regions. For instructions, see Creating a trail in the AWS CloudTrail User Guide. Make note of the name of the CloudWatch Logs log group that you associate with the CloudTrail trail. You create the metric filter for that log group in the next step.Create a metric filter. For instructions, see Create a metric filter for a log group in the Amazon CloudWatch User Guide. Use the following values: Field Value Define pattern, Filter pattern {($.errorCode=""*UnauthorizedOperation"") || ($.errorCode=""AccessDenied*"")} Metric namespace LogMetrics Metric value 1 Default value 0 Create an alarm based on the filter. For instructions, see Create a CloudWatch alarm based on a log group-metric filter in the Amazon CloudWatch User Guide. Use the following values: Field Value Conditions, Threshold type Static Whenever your-metric-name is... Greater/Equal than... 1"
CloudWatch.3,Ensure a log metric filter and alarm exist for Management Console sign-in without MFA,Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for console logins that are not protected by multi-factor authentication (MFA).,LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/CloudWatch.3/remediation,,1,CIS AWS Foundations Benchmark v1.2.0,https://docs.aws.amazon.com/securityhub/latest/userguide/cloudwatch-controls.html#cloudwatch-3,Detect > Detection services,AWS::Logs::MetricFilter,None (custom Security Hub rule),Periodic,"To pass this control, follow these steps to create an Amazon SNS topic, an AWS CloudTrail trail, a metric filter, and an alarm for the metric filter. Create an Amazon SNS topic. For instructions, see Getting started with Amazon SNS in the Amazon Simple Notification Service Developer Guide. Create a topic that receives all CIS alarms, and create at least one subscription to the topic.Create a CloudTrail trail that applies to all AWS Regions. For instructions, see Creating a trail in the AWS CloudTrail User Guide. Make note of the name of the CloudWatch Logs log group that you associate with the CloudTrail trail. You create the metric filter for that log group in the next step.Create a metric filter. For instructions, see Create a metric filter for a log group in the Amazon CloudWatch User Guide. Use the following values: Field Value Define pattern, Filter pattern { ($.eventName = ""ConsoleLogin"") && ($.additionalEventData.MFAUsed != ""Yes"") && ($.userIdentity.type = ""IAMUser"") && ($.responseElements.ConsoleLogin = ""Success"") } Metric namespace LogMetrics Metric value 1 Default value 0 Create an alarm based on the filter. For instructions, see Create a CloudWatch alarm based on a log group-metric filter in the Amazon CloudWatch User Guide. Use the following values: Field Value Conditions, Threshold type Static Whenever your-metric-name is... Greater/Equal than... 1"
CloudWatch.4,Ensure a log metric filter and alarm exist for IAM policy changes,Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established changes made to Identity and Access Management (IAM) policies.,LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/CloudWatch.4/remediation,,2,"CIS AWS Foundations Benchmark v1.2.0, CIS AWS Foundations Benchmark v1.4.0",https://docs.aws.amazon.com/securityhub/latest/userguide/cloudwatch-controls.html#cloudwatch-4,Detect > Detection services,AWS::Logs::MetricFilter,None (custom Security Hub rule),Periodic,"NoteOur recommended filter pattern in these remediation steps differs from the filter pattern in the CIS guidance. Our recommended filters target only events coming from IAM API calls. To pass this control, follow these steps to create an Amazon SNS topic, an AWS CloudTrail trail, a metric filter, and an alarm for the metric filter. Create an Amazon SNS topic. For instructions, see Getting started with Amazon SNS in the Amazon Simple Notification Service Developer Guide. Create a topic that receives all CIS alarms, and create at least one subscription to the topic.Create a CloudTrail trail that applies to all AWS Regions. For instructions, see Creating a trail in the AWS CloudTrail User Guide. Make note of the name of the CloudWatch Logs log group that you associate with the CloudTrail trail. You create the metric filter for that log group in the next step.Create a metric filter. For instructions, see Create a metric filter for a log group in the Amazon CloudWatch User Guide. Use the following values: Field Value Define pattern, Filter pattern {($.eventSource=iam.amazonaws.com) && (($.eventName=DeleteGroupPolicy) || ($.eventName=DeleteRolePolicy) || ($.eventName=DeleteUserPolicy) || ($.eventName=PutGroupPolicy) || ($.eventName=PutRolePolicy) || ($.eventName=PutUserPolicy) || ($.eventName=CreatePolicy) || ($.eventName=DeletePolicy) || ($.eventName=CreatePolicyVersion) || ($.eventName=DeletePolicyVersion) || ($.eventName=AttachRolePolicy) || ($.eventName=DetachRolePolicy) || ($.eventName=AttachUserPolicy) || ($.eventName=DetachUserPolicy) || ($.eventName=AttachGroupPolicy) || ($.eventName=DetachGroupPolicy))} Metric namespace LogMetrics Metric value 1 Default value 0 Create an alarm based on the filter. For instructions, see Create a CloudWatch alarm based on a log group-metric filter in the Amazon CloudWatch User Guide. Use the following values: Field Value Conditions, Threshold type Static Whenever your-metric-name is... Greater/Equal than... 1"
CloudWatch.5,Ensure a log metric filter and alarm exist for CloudTrail configuration changes,Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for detecting changes to CloudTrail's configurations.,LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/CloudWatch.5/remediation,,2,"CIS AWS Foundations Benchmark v1.2.0, CIS AWS Foundations Benchmark v1.4.0",https://docs.aws.amazon.com/securityhub/latest/userguide/cloudwatch-controls.html#cloudwatch-5,Detect > Detection services,AWS::Logs::MetricFilter,None (custom Security Hub rule),Periodic,"To pass this control, follow these steps to create an Amazon SNS topic, an AWS CloudTrail trail, a metric filter, and an alarm for the metric filter. Create an Amazon SNS topic. For instructions, see Getting started with Amazon SNS in the Amazon Simple Notification Service Developer Guide. Create a topic that receives all CIS alarms, and create at least one subscription to the topic.Create a CloudTrail trail that applies to all AWS Regions. For instructions, see Creating a trail in the AWS CloudTrail User Guide. Make note of the name of the CloudWatch Logs log group that you associate with the CloudTrail trail. You create the metric filter for that log group in the next step.Create a metric filter. For instructions, see Create a metric filter for a log group in the Amazon CloudWatch User Guide. Use the following values: Field Value Define pattern, Filter pattern {($.eventName=CreateTrail) || ($.eventName=UpdateTrail) || ($.eventName=DeleteTrail) || ($.eventName=StartLogging) || ($.eventName=StopLogging)} Metric namespace LogMetrics Metric value 1 Default value 0 Create an alarm based on the filter. For instructions, see Create a CloudWatch alarm based on a log group-metric filter in the Amazon CloudWatch User Guide. Use the following values: Field Value Conditions, Threshold type Static Whenever your-metric-name is... Greater/Equal than... 1"
CloudWatch.6,Ensure a log metric filter and alarm exist for AWS Management Console authentication failures,Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for failed console authentication attempts.,LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/CloudWatch.6/remediation,,2,"CIS AWS Foundations Benchmark v1.2.0, CIS AWS Foundations Benchmark v1.4.0",https://docs.aws.amazon.com/securityhub/latest/userguide/cloudwatch-controls.html#cloudwatch-6,Detect > Detection services,AWS::Logs::MetricFilter,None (custom Security Hub rule),Periodic,"To pass this control, follow these steps to create an Amazon SNS topic, an AWS CloudTrail trail, a metric filter, and an alarm for the metric filter. Create an Amazon SNS topic. For instructions, see Getting started with Amazon SNS in the Amazon Simple Notification Service Developer Guide. Create a topic that receives all CIS alarms, and create at least one subscription to the topic.Create a CloudTrail trail that applies to all AWS Regions. For instructions, see Creating a trail in the AWS CloudTrail User Guide. Make note of the name of the CloudWatch Logs log group that you associate with the CloudTrail trail. You create the metric filter for that log group in the next step.Create a metric filter. For instructions, see Create a metric filter for a log group in the Amazon CloudWatch User Guide. Use the following values: Field Value Define pattern, Filter pattern {($.eventName=ConsoleLogin) && ($.errorMessage=""Failed authentication"")} Metric namespace LogMetrics Metric value 1 Default value 0 Create an alarm based on the filter. For instructions, see Create a CloudWatch alarm based on a log group-metric filter in the Amazon CloudWatch User Guide. Use the following values: Field Value Conditions, Threshold type Static Whenever your-metric-name is... Greater/Equal than... 1"
CloudWatch.7,Ensure a log metric filter and alarm exist for disabling or scheduled deletion of customer created CMKs,Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for customer created CMKs which have changed state to disabled or scheduled deletion.,LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/CloudWatch.7/remediation,,2,"CIS AWS Foundations Benchmark v1.2.0, CIS AWS Foundations Benchmark v1.4.0",https://docs.aws.amazon.com/securityhub/latest/userguide/cloudwatch-controls.html#cloudwatch-7,Detect > Detection services,AWS::Logs::MetricFilter,None (custom Security Hub rule),Periodic,"To pass this control, follow these steps to create an Amazon SNS topic, an AWS CloudTrail trail, a metric filter, and an alarm for the metric filter. Create an Amazon SNS topic. For instructions, see Getting started with Amazon SNS in the Amazon Simple Notification Service Developer Guide. Create a topic that receives all CIS alarms, and create at least one subscription to the topic.Create a CloudTrail trail that applies to all AWS Regions. For instructions, see Creating a trail in the AWS CloudTrail User Guide. Make note of the name of the CloudWatch Logs log group that you associate with the CloudTrail trail. You create the metric filter for that log group in the next step.Create a metric filter. For instructions, see Create a metric filter for a log group in the Amazon CloudWatch User Guide. Use the following values: Field Value Define pattern, Filter pattern {($.eventSource=kms.amazonaws.com) && (($.eventName=DisableKey) || ($.eventName=ScheduleKeyDeletion))} Metric namespace LogMetrics Metric value 1 Default value 0 Create an alarm based on the filter. For instructions, see Create a CloudWatch alarm based on a log group-metric filter in the Amazon CloudWatch User Guide. Use the following values: Field Value Conditions, Threshold type Static Whenever your-metric-name is... Greater/Equal than... 1"
CloudWatch.8,Ensure a log metric filter and alarm exist for S3 bucket policy changes,Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for changes to S3 bucket policies.,LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/CloudWatch.8/remediation,,2,"CIS AWS Foundations Benchmark v1.2.0, CIS AWS Foundations Benchmark v1.4.0",https://docs.aws.amazon.com/securityhub/latest/userguide/cloudwatch-controls.html#cloudwatch-8,Detect > Detection services,AWS::Logs::MetricFilter,None (custom Security Hub rule),Periodic,"To pass this control, follow these steps to create an Amazon SNS topic, an AWS CloudTrail trail, a metric filter, and an alarm for the metric filter. Create an Amazon SNS topic. For instructions, see Getting started with Amazon SNS in the Amazon Simple Notification Service Developer Guide. Create a topic that receives all CIS alarms, and create at least one subscription to the topic.Create a CloudTrail trail that applies to all AWS Regions. For instructions, see Creating a trail in the AWS CloudTrail User Guide. Make note of the name of the CloudWatch Logs log group that you associate with the CloudTrail trail. You create the metric filter for that log group in the next step.Create a metric filter. For instructions, see Create a metric filter for a log group in the Amazon CloudWatch User Guide. Use the following values: Field Value Define pattern, Filter pattern {($.eventSource=s3.amazonaws.com) && (($.eventName=PutBucketAcl) || ($.eventName=PutBucketPolicy) || ($.eventName=PutBucketCors) || ($.eventName=PutBucketLifecycle) || ($.eventName=PutBucketReplication) || ($.eventName=DeleteBucketPolicy) || ($.eventName=DeleteBucketCors) || ($.eventName=DeleteBucketLifecycle) || ($.eventName=DeleteBucketReplication))} Metric namespace LogMetrics Metric value 1 Default value 0 Create an alarm based on the filter. For instructions, see Create a CloudWatch alarm based on a log group-metric filter in the Amazon CloudWatch User Guide. Use the following values: Field Value Conditions, Threshold type Static Whenever your-metric-name is... Greater/Equal than... 1"
CloudWatch.9,Ensure a log metric filter and alarm exist for AWS Config configuration changes,Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for detecting changes to CloudTrail's configurations.,LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/CloudWatch.9/remediation,,2,"CIS AWS Foundations Benchmark v1.2.0, CIS AWS Foundations Benchmark v1.4.0",https://docs.aws.amazon.com/securityhub/latest/userguide/cloudwatch-controls.html#cloudwatch-9,Detect > Detection services,AWS::Logs::MetricFilter,None (custom Security Hub rule),Periodic,"To pass this control, follow these steps to create an Amazon SNS topic, an AWS CloudTrail trail, a metric filter, and an alarm for the metric filter. Create an Amazon SNS topic. For instructions, see Getting started with Amazon SNS in the Amazon Simple Notification Service Developer Guide. Create a topic that receives all CIS alarms, and create at least one subscription to the topic.Create a CloudTrail trail that applies to all AWS Regions. For instructions, see Creating a trail in the AWS CloudTrail User Guide. Make note of the name of the CloudWatch Logs log group that you associate with the CloudTrail trail. You create the metric filter for that log group in the next step.Create a metric filter. For instructions, see Create a metric filter for a log group in the Amazon CloudWatch User Guide. Use the following values: Field Value Define pattern, Filter pattern {($.eventSource=config.amazonaws.com) && (($.eventName=StopConfigurationRecorder) || ($.eventName=DeleteDeliveryChannel) || ($.eventName=PutDeliveryChannel) || ($.eventName=PutConfigurationRecorder))} Metric namespace LogMetrics Metric value 1 Default value 0 Create an alarm based on the filter. For instructions, see Create a CloudWatch alarm based on a log group-metric filter in the Amazon CloudWatch User Guide. Use the following values: Field Value Conditions, Threshold type Static Whenever your-metric-name is... Greater/Equal than... 1"
CloudWatch.10,Ensure a log metric filter and alarm exist for security group changes,Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. Security Groups are a stateful packet filter that controls ingress and egress traffic within a VPC. It is recommended that a metric filter and alarm be established changes to Security Groups.,LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/CloudWatch.10/remediation,,2,"CIS AWS Foundations Benchmark v1.2.0, CIS AWS Foundations Benchmark v1.4.0",https://docs.aws.amazon.com/securityhub/latest/userguide/cloudwatch-controls.html#cloudwatch-10,Detect > Detection services,AWS::Logs::MetricFilter,None (custom Security Hub rule),Periodic,"To pass this control, follow these steps to create an Amazon SNS topic, an AWS CloudTrail trail, a metric filter, and an alarm for the metric filter. Create an Amazon SNS topic. For instructions, see Getting started with Amazon SNS in the Amazon Simple Notification Service Developer Guide. Create a topic that receives all CIS alarms, and create at least one subscription to the topic.Create a CloudTrail trail that applies to all AWS Regions. For instructions, see Creating a trail in the AWS CloudTrail User Guide. Make note of the name of the CloudWatch Logs log group that you associate with the CloudTrail trail. You create the metric filter for that log group in the next step.Create a metric filter. For instructions, see Create a metric filter for a log group in the Amazon CloudWatch User Guide. Use the following values: Field Value Define pattern, Filter pattern {($.eventName=AuthorizeSecurityGroupIngress) || ($.eventName=AuthorizeSecurityGroupEgress) || ($.eventName=RevokeSecurityGroupIngress) || ($.eventName=RevokeSecurityGroupEgress) || ($.eventName=CreateSecurityGroup) || ($.eventName=DeleteSecurityGroup)} Metric namespace LogMetrics Metric value 1 Default value 0 Create an alarm based on the filter. For instructions, see Create a CloudWatch alarm based on a log group-metric filter in the Amazon CloudWatch User Guide. Use the following values: Field Value Conditions, Threshold type Static Whenever your-metric-name is... Greater/Equal than... 1"
CloudWatch.11,Ensure a log metric filter and alarm exist for changes to Network Access Control Lists (NACL),Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. NACLs are used as a stateless packet filter to control ingress and egress traffic for subnets within a VPC. It is recommended that a metric filter and alarm be established for changes made to NACLs.,LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/CloudWatch.11/remediation,,2,"CIS AWS Foundations Benchmark v1.2.0, CIS AWS Foundations Benchmark v1.4.0",https://docs.aws.amazon.com/securityhub/latest/userguide/cloudwatch-controls.html#cloudwatch-11,Detect > Detection services,AWS::Logs::MetricFilter,None (custom Security Hub rule),Periodic,"To pass this control, follow these steps to create an Amazon SNS topic, an AWS CloudTrail trail, a metric filter, and an alarm for the metric filter. Create an Amazon SNS topic. For instructions, see Getting started with Amazon SNS in the Amazon Simple Notification Service Developer Guide. Create a topic that receives all CIS alarms, and create at least one subscription to the topic.Create a CloudTrail trail that applies to all AWS Regions. For instructions, see Creating a trail in the AWS CloudTrail User Guide. Make note of the name of the CloudWatch Logs log group that you associate with the CloudTrail trail. You create the metric filter for that log group in the next step.Create a metric filter. For instructions, see Create a metric filter for a log group in the Amazon CloudWatch User Guide. Use the following values: Field Value Define pattern, Filter pattern {($.eventName=CreateNetworkAcl) || ($.eventName=CreateNetworkAclEntry) || ($.eventName=DeleteNetworkAcl) || ($.eventName=DeleteNetworkAclEntry) || ($.eventName=ReplaceNetworkAclEntry) || ($.eventName=ReplaceNetworkAclAssociation)} Metric namespace LogMetrics Metric value 1 Default value 0 Create an alarm based on the filter. For instructions, see Create a CloudWatch alarm based on a log group-metric filter in the Amazon CloudWatch User Guide. Use the following values: Field Value Conditions, Threshold type Static Whenever your-metric-name is... Greater/Equal than... 1"
CloudWatch.12,Ensure a log metric filter and alarm exist for changes to network gateways,Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. Network gateways are required to send/receive traffic to a destination outside of a VPC. It is recommended that a metric filter and alarm be established for changes to network gateways.,LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/CloudWatch.12/remediation,,2,"CIS AWS Foundations Benchmark v1.2.0, CIS AWS Foundations Benchmark v1.4.0",https://docs.aws.amazon.com/securityhub/latest/userguide/cloudwatch-controls.html#cloudwatch-12,Detect > Detection services,AWS::Logs::MetricFilter,None (custom Security Hub rule),Periodic,"To pass this control, follow these steps to create an Amazon SNS topic, an AWS CloudTrail trail, a metric filter, and an alarm for the metric filter. Create an Amazon SNS topic. For instructions, see Getting started with Amazon SNS in the Amazon Simple Notification Service Developer Guide. Create a topic that receives all CIS alarms, and create at least one subscription to the topic.Create a CloudTrail trail that applies to all AWS Regions. For instructions, see Creating a trail in the AWS CloudTrail User Guide. Make note of the name of the CloudWatch Logs log group that you associate with the CloudTrail trail. You create the metric filter for that log group in the next step.Create a metric filter. For instructions, see Create a metric filter for a log group in the Amazon CloudWatch User Guide. Use the following values: Field Value Define pattern, Filter pattern {($.eventName=CreateCustomerGateway) || ($.eventName=DeleteCustomerGateway) || ($.eventName=AttachInternetGateway) || ($.eventName=CreateInternetGateway) || ($.eventName=DeleteInternetGateway) || ($.eventName=DetachInternetGateway)} Metric namespace LogMetrics Metric value 1 Default value 0 Create an alarm based on the filter. For instructions, see Create a CloudWatch alarm based on a log group-metric filter in the Amazon CloudWatch User Guide. Use the following values: Field Value Conditions, Threshold type Static Whenever your-metric-name is... Greater/Equal than... 1"
CloudWatch.13,Ensure a log metric filter and alarm exist for route table changes,Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. Routing tables are used to route network traffic between subnets and to network gateways. It is recommended that a metric filter and alarm be established for changes to route tables.,LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/CloudWatch.13/remediation,,2,"CIS AWS Foundations Benchmark v1.2.0, CIS AWS Foundations Benchmark v1.4.0",https://docs.aws.amazon.com/securityhub/latest/userguide/cloudwatch-controls.html#cloudwatch-13,Detect > Detection services,AWS::Logs::MetricFilter,None (custom Security Hub rule),Periodic,"NoteOur recommended filter pattern in these remediation steps differs from the filter pattern in the CIS guidance. Our recommended filters target only events coming from Amazon Elastic Compute Cloud (EC2) API calls. To pass this control, follow these steps to create an Amazon SNS topic, an AWS CloudTrail trail, a metric filter, and an alarm for the metric filter. Create an Amazon SNS topic. For instructions, see Getting started with Amazon SNS in the Amazon Simple Notification Service Developer Guide. Create a topic that receives all CIS alarms, and create at least one subscription to the topic.Create a CloudTrail trail that applies to all AWS Regions. For instructions, see Creating a trail in the AWS CloudTrail User Guide. Make note of the name of the CloudWatch Logs log group that you associate with the CloudTrail trail. You create the metric filter for that log group in the next step.Create a metric filter. For instructions, see Create a metric filter for a log group in the Amazon CloudWatch User Guide. Use the following values: Field Value Define pattern, Filter pattern {($.eventSource=ec2.amazonaws.com) && (($.eventName=CreateRoute) || ($.eventName=CreateRouteTable) || ($.eventName=ReplaceRoute) || ($.eventName=ReplaceRouteTableAssociation) || ($.eventName=DeleteRouteTable) || ($.eventName=DeleteRoute) || ($.eventName=DisassociateRouteTable))} Metric namespace LogMetrics Metric value 1 Default value 0 Create an alarm based on the filter. For instructions, see Create a CloudWatch alarm based on a log group-metric filter in the Amazon CloudWatch User Guide. Use the following values: Field Value Conditions, Threshold type Static Whenever your-metric-name is... Greater/Equal than... 1"
CloudWatch.14,Ensure a log metric filter and alarm exist for VPC changes,"Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is possible to have more than 1 VPC within an account, in addition it is also possible to create a peer connection between 2 VPCs enabling network traffic to route between VPCs. It is recommended that a metric filter and alarm be established for changes made to VPCs.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/CloudWatch.14/remediation,,2,"CIS AWS Foundations Benchmark v1.2.0, CIS AWS Foundations Benchmark v1.4.0",https://docs.aws.amazon.com/securityhub/latest/userguide/cloudwatch-controls.html#cloudwatch-14,Detect > Detection services,AWS::Logs::MetricFilter,None (custom Security Hub rule),Periodic,"To pass this control, follow these steps to create an Amazon SNS topic, an AWS CloudTrail trail, a metric filter, and an alarm for the metric filter. Create an Amazon SNS topic. For instructions, see Getting started with Amazon SNS in the Amazon Simple Notification Service Developer Guide. Create a topic that receives all CIS alarms, and create at least one subscription to the topic.Create a CloudTrail trail that applies to all AWS Regions. For instructions, see Creating a trail in the AWS CloudTrail User Guide. Make note of the name of the CloudWatch Logs log group that you associate with the CloudTrail trail. You create the metric filter for that log group in the next step.Create a metric filter. For instructions, see Create a metric filter for a log group in the Amazon CloudWatch User Guide. Use the following values: Field Value Define pattern, Filter pattern {($.eventName=CreateVpc) || ($.eventName=DeleteVpc) || ($.eventName=ModifyVpcAttribute) || ($.eventName=AcceptVpcPeeringConnection) || ($.eventName=CreateVpcPeeringConnection) || ($.eventName=DeleteVpcPeeringConnection) || ($.eventName=RejectVpcPeeringConnection) || ($.eventName=AttachClassicLinkVpc) || ($.eventName=DetachClassicLinkVpc) || ($.eventName=DisableVpcClassicLink) || ($.eventName=EnableVpcClassicLink)} Metric namespace LogMetrics Metric value 1 Default value 0 Create an alarm based on the filter. For instructions, see Create a CloudWatch alarm based on a log group-metric filter in the Amazon CloudWatch User Guide. Use the following values: Field Value Conditions, Threshold type Static Whenever your-metric-name is... Greater/Equal than... 1"
CloudWatch.15,CloudWatch alarms should have specified actions configured,"This control checks whether an Amazon CloudWatch alarm has at least one action configured for the 'ALARM' state. The control fails if the alarm doesn't have an action configured for the 'ALARM' state. Optionally, you can include custom parameter values to also require alarm actions for the 'INSUFFICIENT_DATA' or 'OK' states.",HIGH,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/CloudWatch.15/remediation,"Parameter: insufficientDataActionRequired
Description: The control produces a 'PASSED' finding if the parameter is set to 'true' and the alarm has an action when the alarm state changes to 'INSUFFICIENT_DATA'
Type: Boolean
Default Value: False
Min: N/A
Max: N/A
---
Parameter: okActionRequired
Description: The control produces a 'PASSED' finding if the parameter is set to 'true' and the alarm has an action when the alarm state changes to 'OK'
Type: Boolean
Default Value: False
Min: N/A
Max: N/A
---
",1,NIST Special Publication 800-53 Revision 5,https://docs.aws.amazon.com/securityhub/latest/userguide/cloudwatch-controls.html#cloudwatch-15,Detect > Detection services,AWS::CloudWatch::Alarm,cloudwatch-alarm-action-check,Change triggered,"For information about actions supported by CloudWatch alarms, see Alarm actions in the Amazon CloudWatch User Guide."
CloudWatch.16,CloudWatch log groups should be retained for a specified time period,"This control checks whether an Amazon CloudWatch log group has a retention period of at least the specified number of days. The control fails if the retention period is less than the specified number. Unless you provide a custom parameter value for the retention period, Security Hub uses a default value of 365 days.",MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/CloudWatch.16/remediation,"Parameter: MinRetentionTime
Description: Minimum retention period in days for CloudWatch log groups
Type: Enum
Default Value: 365
Min: N/A
Max: N/A
---
",1,NIST Special Publication 800-53 Revision 5,https://docs.aws.amazon.com/securityhub/latest/userguide/cloudwatch-controls.html#cloudwatch-16,Identify > Logging,AWS::Logs::LogGroup,cw-loggroup-retention-period-check,Periodic,"To configure log retention settings, see Change log data retention in CloudWatch Logs in the Amazon CloudWatch User Guide."
CloudWatch.17,CloudWatch alarm actions should be enabled,This control evaluates if CloudWatch alarm actions are enabled. The control fails if the alarm action is in the disabled state.,HIGH,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/CloudWatch.17/remediation,,1,NIST Special Publication 800-53 Revision 5,https://docs.aws.amazon.com/securityhub/latest/userguide/cloudwatch-controls.html#cloudwatch-17,Detect > Detection services,AWS::CloudWatch::Alarm,cloudwatch-alarm-action-enabled-check,Change triggered,"To activate a CloudWatch alarm action (console)Open the CloudWatch console at https://console.aws.amazon.com/cloudwatch/.In the navigation pane, under Alarms, choose All alarms.Select the alarm that you want to activate actions for.For Actions, choose Alarm actions–new, and then choose Enable. For more information about activating CloudWatch alarm actions, see Alarm actions in the Amazon CloudWatch User Guide."
CodeArtifact.1,CodeArtifact repositories should be tagged,"This control checks whether an AWS CodeArtifact repository has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the repository doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the repository isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,UNAVAILABLE,https://docs.aws.amazon.com/console/securityhub/CodeArtifact.1/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/codeartifact-controls.html#codeartifact-1,Identify > Inventory > Tagging,AWS::CodeArtifact::Repository,tagged-codeartifact-repository (custom Security Hub rule),Change triggered,"To add tags to a CodeArtifact repository, see Tag a repository in CodeArtifact in the AWS CodeArtifact User Guide."
CodeBuild.1,CodeBuild Bitbucket source repository URLs should not contain sensitive credentials,This control checks whether an AWS CodeBuild project Bitbucket source repository URL contains personal access tokens or a user name and password. The control fails if the Bitbucket source repository URL contains personal access tokens or a user name and password.,CRITICAL,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/CodeBuild.1/remediation,,4,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v3.2.1, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/codebuild-controls.html#codebuild-1,Protect > Secure development,AWS::CodeBuild::Project,codebuild-project-source-repo-url-check,Change triggered,"You can update your CodeBuild project to use OAuth. To remove basic authentication / (GitHub) Personal Access Token from CodeBuild project sourceOpen the CodeBuild console at https://console.aws.amazon.com/codebuild/. Choose the build project that contains personal access tokens or a user name and password. From Edit, choose Source. Choose Disconnect from GitHub / Bitbucket. Choose Connect using OAuth, then choose Connect to GitHub / Bitbucket. When prompted, choose authorize as appropriate. Reconfigure your repository URL and additional configuration settings, as needed. Choose Update source. For more information, refer to CodeBuild use case-based samples in the AWS CodeBuild User Guide."
CodeBuild.2,CodeBuild project environment variables should not contain clear text credentials,This AWS control checks whether the project contains environment variables AWS_ACCESS_KEY_ID and AWS_SECRET_ACCESS_KEY.,CRITICAL,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/CodeBuild.2/remediation,,4,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v3.2.1, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/codebuild-controls.html#codebuild-2,Protect > Secure development,AWS::CodeBuild::Project,codebuild-project-envvar-awscred-check,Change triggered,"To remove environment variables from a CodeBuild project, see Change a build project's settings in AWS CodeBuild in the AWS CodeBuild User Guide. Ensure nothing is selected for Environment variables. You can store environment variables with sensitive values in the AWS Systems Manager Parameter Store or AWS Secrets Manager and then retrieve them from your build spec. For instructions, see the box labeled Important in the Environment section in the AWS CodeBuild User Guide."
CodeBuild.3,CodeBuild S3 logs should be encrypted,This control checks if Amazon S3 logs for an AWS CodeBuild project are encrypted. The control fails if encryption is deactivated for S3 Logs for a CodeBuild project.,LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/CodeBuild.3/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/codebuild-controls.html#codebuild-3,Protect > Data Protection > Encryption of data-at-rest,AWS::CodeBuild::Project,codebuild-project-s3-logs-encrypted,Change triggered,"To change the encryption settings for CodeBuild project S3 logs, see Change a build project's settings in AWS CodeBuild in the AWS CodeBuild User Guide."
CodeBuild.4,CodeBuild project environments should have a logging configuration,This control checks whether a CodeBuild project environment has at least one log option enabled.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/CodeBuild.4/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/codebuild-controls.html#codebuild-4,Identify > Logging,AWS::CodeBuild::Project,codebuild-project-logging-enabled,Change triggered,"For more information on how to configure CodeBuild project log settings, see Create a build project (console) in the CodeBuild User Guide."
CodeBuild.7,CodeBuild report group exports should be encrypted at rest,This control checks whether the test results of an AWS CodeBuild report group that are exported to an Amazon Simple Storage Service (Amazon S3) bucket are encrypted at rest. The control fails if the report group export isn't encrypted at rest.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/CodeBuild.7/remediation,,1,AWS Foundational Security Best Practices v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/codebuild-controls.html#codebuild-7,Protect > Data Protection > Encryption of data-at-rest,AWS::CodeBuild::ReportGroup,codebuild-report-group-encrypted-at-rest,Change triggered,"To encrypt the report group export to S3, see Update a report group in the AWS CodeBuild User Guide."
CodeGuruProfiler.1,CodeGuru Profiler profiling groups should be tagged,"This control checks whether an Amazon CodeGuru Profiler profiling group has tags with the specific keys defined in the parameter requiredKeyTags. The control fails if the profiling group doesn't have any tag keys or if it doesn't have all the keys specified in the parameter requiredKeyTags. If the parameter requiredKeyTags isn't provided, the control only checks for the existence of a tag key and fails if the profiling group isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,UNAVAILABLE,https://docs.aws.amazon.com/console/securityhub/CodeGuruProfiler.1/remediation,"Parameter: requiredKeyTags
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/codeguruprofiler-controls.html#codeguruprofiler-1,Identify > Inventory > Tagging,AWS::CodeGuruProfiler::ProfilingGroup,codeguruprofiler-profiling-group-tagged,Change triggered,"To add tags to a CodeGuru Profiler profiling group, see Tagging profiling groups in the Amazon CodeGuru Profiler User Guide."
CodeGuruReviewer.1,CodeGuru Reviewer repository associations should be tagged,"This control checks whether an Amazon CodeGuru Reviewer repository association has tags with the specific keys defined in the parameter requiredKeyTags. The control fails if the repository association doesn't have any tag keys or if it doesn't have all the keys specified in the parameter requiredKeyTags. If the parameter requiredKeyTags isn't provided, the control only checks for the existence of a tag key and fails if the repository association isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,UNAVAILABLE,https://docs.aws.amazon.com/console/securityhub/CodeGuruReviewer.1/remediation,"Parameter: requiredKeyTags
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/codegurureviewer-controls.html#codegurureviewer-1,Identify > Inventory > Tagging,AWS::CodeGuruReviewer::RepositoryAssociation,codegurureviewer-repository-association-tagged,Change triggered,"To add tags to a CodeGuru Reviewer repository association, see Tagging a repository association in the Amazon CodeGuru Reviewer User Guide."
Cognito.1,Cognito user pools should have threat protection activated with full function enforcement mode for standard authentication,This control checks whether an Amazon Cognito user pool has threat protection activated with the enforcement mode set to full function. The control fails if the user pool has threat protection deactivated or if the enforcement mode isn't set to full function.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Cognito.1/remediation,"Parameter: SecurityMode
Description: The threat protection enforcement mode that the control checks for
Type: Enum
Default Value: ENFORCED
Min: N/A
Max: N/A
---
",1,AWS Foundational Security Best Practices v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/cognito-controls.html#cognito-1,Protect > Secure access management,AWS::Cognito::UserPool,cognito-user-pool-advanced-security-enabled,Change triggered,"To activate threat protection for a Cognito user pool, see Advanced security with threat protection in the Amazon Cognito Developer Guide."
Config.1,AWS Config should be enabled and use the service-linked role for resource recording,"This control checks whether AWS Config is enabled in your account in the current AWS Region, records all resources that correspond to controls that are enabled in the current Region, and uses the service-linked AWS Config role.",CRITICAL,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Config.1/remediation,"Parameter: includeConfigServiceLinkedRoleCheck
Description: The control doesn't evaluate whether AWS Config uses the service-linked role if the parameter is set to 'false'.
Type: Boolean
Default Value: True
Min: N/A
Max: N/A
---
",6,"AWS Foundational Security Best Practices v1.0.0, CIS AWS Foundations Benchmark v1.2.0, CIS AWS Foundations Benchmark v1.4.0, CIS AWS Foundations Benchmark v3.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v3.2.1",https://docs.aws.amazon.com/securityhub/latest/userguide/config-controls.html#config-1,Identify > Inventory,AWS::::Account,None (custom Security Hub rule),Periodic,"In the home Region and Regions that aren’t part of an aggregator, record all resources that are required for controls that are enabled in the current Region, including IAM global resources if you have enabled controls that require IAM global resources. In linked Regions, you can use any AWS Config recording mode, as long as you are recording all resources that correspond to controls that are enabled in the current Region. In linked Regions, if you have enabled controls that require recording of IAM global resources, you won’t receive a FAILED finding (your recording of other resources is sufficient). The StatusReasons field in the Compliance object of your finding can help you determine why you have a failed finding for this control. For more information, see Compliance details for control findings. For a list of which resources must be recorded for each control, see Required AWS Config resources for Security Hub control findings. For general information about enabling AWS Config and configuring resource recording, see Enabling and configuring AWS Config for Security Hub."
Connect.1,Amazon Connect Customer Profiles object types should be tagged,"This control checks whether an Amazon Connect Customer Profiles object type has tags with the specific keys defined in the parameter requiredKeyTags. The control fails if the object type doesn't have any tag keys or if it doesn't have all the keys specified in the parameter requiredKeyTags. If the parameter requiredKeyTags isn't provided, the control only checks for the existence of a tag key and fails if the object type isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Connect.1/remediation,"Parameter: requiredKeyTags
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/connect-controls.html#connect-1,Identify > Inventory > Tagging,AWS::CustomerProfiles::ObjectType,customerprofiles-object-type-tagged,Change triggered,"To add tags to a Customer Profiles object type, see Add tags to resources in Amazon Connect in the Amazon Connect Administrator Guide."
Connect.2,Amazon Connect instances should have CloudWatch logging enabled,This control checks whether an Amazon Connect instance is configured to generate and store flow logs in an Amazon CloudWatch log group. The control fails if the Amazon Connect instance isn't configured to generate and store flow logs in a CloudWatch log group.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Connect.2/remediation,,1,AWS Foundational Security Best Practices v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/connect-controls.html#connect-2,Identify > Logging,AWS::Connect::Instance,connect-instance-logging-enabled,Change triggered,"For information about enabling flow logs for an Amazon Connect instance, see Enable Amazon Connect flow logs in an Amazon CloudWatch log group in the Amazon Connect Administrator Guide."
DMS.1,Database Migration Service replication instances should not be public,This AWS control checks whether AWS Database Migration Service replication instances are public by examining the PubliclyAccessible field value.,CRITICAL,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/DMS.1/remediation,,4,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v3.2.1, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/dms-controls.html#dms-1,Protect > Secure network configuration,AWS::DMS::ReplicationInstance,dms-replication-not-public,Periodic,"You can't change the public access setting for a DMS replication instance after creating it. To change the public access setting, delete your current instance, and then recreate it. Don't select the Publicly accessible option."
DMS.2,DMS certificates should be tagged,"This control checks whether an AWS DMS certificate has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the certificate doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the certificate isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/DMS.2/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/dms-controls.html#dms-2,Identify > Inventory > Tagging,AWS::DMS::Certificate,tagged-dms-certificate (custom Security Hub rule),Change triggered,"To add tags to a DMS certificate, see Tagging resources in AWS Database Migration Service in the AWS Database Migration Service User Guide."
DMS.3,DMS event subscriptions should be tagged,"This control checks whether an AWS DMS event subscription has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the event subscription doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the event subscription isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/DMS.3/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/dms-controls.html#dms-3,Identify > Inventory > Tagging,AWS::DMS::EventSubscription,tagged-dms-eventsubscription (custom Security Hub rule),Change triggered,"To add tags to a DMS event subscription, see Tagging resources in AWS Database Migration Service in the AWS Database Migration Service User Guide."
DMS.4,DMS replication instances should be tagged,"This control checks whether an AWS DMS replication instance has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the replication instance doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the replication instance isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/DMS.4/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/dms-controls.html#dms-4,Identify > Inventory > Tagging,AWS::DMS::ReplicationInstance,tagged-dms-replicationinstance (custom Security Hub rule),Change triggered,"To add tags to a DMS replication instance, see Tagging resources in AWS Database Migration Service in the AWS Database Migration Service User Guide."
DMS.5,DMS replication subnet groups should be tagged,"This control checks whether an AWS DMS replication subnet group has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the replication subnet group doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the replication subnet group isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/DMS.5/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/dms-controls.html#dms-5,Identify > Inventory > Tagging,AWS::DMS::ReplicationSubnetGroup,tagged-dms-replicationsubnetgroup (custom Security Hub rule),Change triggered,"To add tags to a DMS replication subnet group, see Tagging resources in AWS Database Migration Service in the AWS Database Migration Service User Guide."
DMS.6,DMS replication instances should have automatic minor version upgrade enabled,This control checks if automatic minor version upgrade is enabled for an AWS DMS replication instance. The control fails if automatic minor version upgrade isn't enabled for a DMS replication instance.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/DMS.6/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/dms-controls.html#dms-6,"Identify > Vulnerability, patch, and version management",AWS::DMS::ReplicationInstance,dms-auto-minor-version-upgrade-check,Change triggered,"To enable automatic minor version upgrade on DMS replication instances, see Modifying a replication instance in the AWS Database Migration Service User Guide."
DMS.7,DMS replication tasks for the target database should have logging enabled,This control checks whether logging is enabled with the minimum severity level of LOGGER_SEVERITY_DEFAULT for DMS replication task events TARGET_APPLY and TARGET_LOAD. The control fails if logging isn't enabled for these events or if the minimum severity level is less than LOGGER_SEVERITY_DEFAULT.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/DMS.7/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/dms-controls.html#dms-7,Identify > Logging,AWS::DMS::ReplicationTask,dms-replication-task-targetdb-logging,Change triggered,"To enable logging for target database DMS replication tasks, see Viewing and managing AWS DMS task logs in the AWS Database Migration Service User Guide."
DMS.8,DMS replication tasks for the source database should have logging enabled,The control checks whether logging is enabled with the minimum severity level of LOGGER_SEVERITY_DEFAULT for DMS replication task events SOURCE_CAPTURE and SOURCE_UNLOAD. The control fails if logging isn't enabled for these events of the source database or if the minimum severity level is less than LOGGER_SEVERITY_DEFAULT.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/DMS.8/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/dms-controls.html#dms-8,Identify > Logging,AWS::DMS::ReplicationTask,dms-replication-task-sourcedb-logging,Change triggered,"To enable logging for source database DMS replication tasks, see Viewing and managing AWS DMS task logs in the AWS Database Migration Service User Guide."
DMS.9,DMS endpoints should use SSL,This control checks whether an AWS DMS endpoint uses an SSL connection. The control fails if the endpoint doesn't use SSL.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/DMS.9/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/dms-controls.html#dms-9,Protect > Data Protection > Encryption of data-in-transit,AWS::DMS::Endpoint,dms-endpoint-ssl-configured,Change triggered,"To add an SSL connection to a new or existing DMS endpoint, see Using SSL with AWS Database Migration Service in the AWS Database Migration Service User Guide."
DMS.10,DMS endpoints for Neptune databases should have IAM authorization enabled,This control checks whether an AWS DMS endpoint for an Amazon Neptune database is configured with IAM authorization. The control fails if the DMS endpoint doesn't have IAM authorization enabled.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/DMS.10/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/dms-controls.html#dms-10,Protect > Secure access management > Passwordless authentication,AWS::DMS::Endpoint,dms-neptune-iam-authorization-enabled,Change triggered,"To enable IAM authorization on DMS endpoints for Neptune databases, see Using Amazon Neptune as a target for AWS Database Migration Service in the AWS Database Migration Service User Guide."
DMS.11,DMS endpoints for MongoDB should have an authentication mechanism enabled,This control checks whether an AWS DMS endpoint for MongoDB is configured with an authentication mechanism. The control fails if an authentication type isn't set for the endpoint.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/DMS.11/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/dms-controls.html#dms-11,Protect > Secure access management > Passwordless authentication,AWS::DMS::Endpoint,dms-mongo-db-authentication-enabled,Change triggered,"To enable an authentication mechanism on DMS endpoints for MongoDB, see Using MongoDB as a source for AWS DMS in the AWS Database Migration Service User Guide."
DMS.12,DMS endpoints for Redis OSS should have TLS enabled,This control checks whether an AWS DMS endpoint for Redis OSS is configured with a TLS connection. The control fails if the endpoint doesn't have TLS enabled.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/DMS.12/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/dms-controls.html#dms-12,Protect > Data Protection > Encryption of data-in-transit,AWS::DMS::Endpoint,dms-redis-tls-enabled,Change triggered,"To enable a TLS connection on DMS endpoints for Redis, see Using Redis as a target for AWS Database Migration Service in the AWS Database Migration Service User Guide."
DataFirehose.1,Firehose delivery streams should be encrypted at rest,This control checks whether an Amazon Data Firehose delivery stream is encrypted at rest with server-side encryption. This control fails if the delivery stream is not encrypted at rest with server-side encryption.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/DataFirehose.1/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/datafirehose-controls.html#datafirehose-1,Protect > Data Protection > Encryption of data-at-rest,AWS::KinesisFirehose::DeliveryStream,kinesis-firehose-delivery-stream-encrypted,Periodic,"To enable server-side encryption on Firehose delivery streams,, see Data Protection in Amazon Data Firehose in the Amazon Data Firehose Developer Guide."
DataSync.1,DataSync tasks should have logging enabled,This control checks whether an AWS DataSync task has logging enabled. The control fails if the task doesn't have logging enabled.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/DataSync.1/remediation,,1,AWS Foundational Security Best Practices v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/datasync-controls.html#datasync-1,Identify > Logging,AWS::DataSync::Task,datasync-task-logging-enabled,Change triggered,"To configure logging for DataSync tasks, see Configuring logging for your DataSync transfer task in the AWS DataSync User Guide"
Detective.1,Detective behavior graphs should be tagged,"This control checks whether an Amazon Detective behavior graph has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the behavior graph doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the behavior graph isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Detective.1/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/detective-controls.html#detective-1,Identify > Inventory > Tagging,AWS::Detective::Graph,tagged-detective-graph (custom Security Hub rule),Change triggered,"To add tags to a Detective behavior graph, see Adding tags to a behavior graph in the Amazon Detective Administration Guide."
DocumentDB.1,Amazon DocumentDB clusters should be encrypted at rest,This control checks whether an Amazon DocumentDB cluster is encrypted at rest. The control fails if an Amazon DocumentDB cluster isn't encrypted at rest.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/DocumentDB.1/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/documentdb-controls.html#documentdb-1,Protect > Data Protection > Encryption of data-at-rest,AWS::RDS::DBCluster,docdb-cluster-encrypted,Change triggered,"You can enable encryption at rest when you create an Amazon DocumentDB cluster. You can't change encryption settings after creating a cluster. For more information, see Enabling encryption at rest for an Amazon DocumentDB cluster in the Amazon DocumentDB Developer Guide."
DocumentDB.2,Amazon DocumentDB clusters should have an adequate backup retention period,"This control checks whether an Amazon DocumentDB cluster has a backup retention period greater than or equal to the specified time frame. The control fails if the backup retention period is less than the specified time frame. Unless you provide a custom parameter value for the backup retention period, Security Hub uses a default value of 7 days.",MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/DocumentDB.2/remediation,"Parameter: minimumBackupRetentionPeriod
Description: Minimum backup retention period in days
Type: Integer
Default Value: 7
Min: 7
Max: 35
---
",3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/documentdb-controls.html#documentdb-2,"Recover > Resilience > Backups
            enabled",AWS::RDS::DBCluster,docdb-cluster-backup-retention-check,Change triggered,"To change the backup retention period for your Amazon DocumentDB clusters, see Modifying an Amazon DocumentDB cluster in the Amazon DocumentDB Developer Guide. For Backup, choose the backup retention period."
DocumentDB.3,Amazon DocumentDB manual cluster snapshots should not be public,This control checks whether an Amazon DocumentDB manual snapshot is public. The control fails if the manual snapshot is public.,CRITICAL,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/DocumentDB.3/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/documentdb-controls.html#documentdb-3,Protect > Secure network configuration,AWS::RDS::DBClusterSnapshot,docdb-cluster-snapshot-public-prohibited,Change triggered,"To remove public access for Amazon DocumentDB manual cluster snapshots, see Sharing a snapshot in the Amazon DocumentDB Developer Guide. Programmatically, you can use the Amazon DocumentDB operation modify-db-snapshot-attribute. Set attribute-name as restore and values-to-remove as all."
DocumentDB.4,Amazon DocumentDB clusters should publish audit logs to CloudWatch Logs,This control checks whether a DocumentDB cluster publishes audit logs to Amazon CloudWatch Logs. The control fails if a DocumentDB cluster doesn't publish audit logs to CloudWatch Logs.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/DocumentDB.4/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/documentdb-controls.html#documentdb-4,Identify > Logging,AWS::RDS::DBCluster,docdb-cluster-audit-logging-enabled,Change triggered,"To publish Amazon DocumentDB audit logs to CloudWatch Logs, see Enabling auditing in the Amazon DocumentDB Developer Guide."
DocumentDB.5,Amazon DocumentDB clusters should have deletion protection enabled,This control checks if an Amazon Document DB cluster has deletion protection enabled. This control fails if the cluster doesn't have deletion protection enabled.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/DocumentDB.5/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/documentdb-controls.html#documentdb-5,Protect > Data protection > Data deletion protection,AWS::RDS::DBCluster,docdb-cluster-deletion-protection-enabled,Change triggered,"To enable deletion protection for an existing Amazon DocumentDB cluster, see Modifying an Amazon DocumentDB cluster in the Amazon DocumentDB Developer Guide. In the Modify Cluster section, choose Enable for Deletion protection."
DynamoDB.1,DynamoDB tables should automatically scale capacity with demand,"This control checks whether an Amazon DynamoDB table can scale its read and write capacity as needed. The control fails if the table doesn't use on-demand capacity mode or provisioned mode with auto scaling configured. By default, this control only requires that one of these modes be configured, without regard to specific levels of read or write capacity. Optionally, you can provide custom parameter values to require specific levels of read and write capacity.",MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/DynamoDB.1/remediation,"Parameter: targetReadUtilization
Description: Target utilization percentage for read capacity
Type: Integer
Default Value: N/A
Min: 20
Max: 90
---
Parameter: minProvisionedReadCapacity
Description: Minimum number of provisioned read capacity units for DynamoDB auto scaling
Type: Integer
Default Value: N/A
Min: 1
Max: 40000
---
Parameter: targetWriteUtilization
Description: Target utilization percentage for write capacity
Type: Integer
Default Value: N/A
Min: 20
Max: 90
---
Parameter: minProvisionedWriteCapacity
Description: Minimum number of provisioned write capacity units for DynamoDB auto scaling
Type: Integer
Default Value: N/A
Min: 1
Max: 40000
---
",2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/dynamodb-controls.html#dynamodb-1,Recover > Resilience > High availability,AWS::DynamoDB::Table,dynamodb-autoscaling-enabled,Periodic,"To enable DynamoDB automatic scaling on existing tables in capacity mode, see Enabling DynamoDB auto scaling on existing tables in the Amazon DynamoDB Developer Guide."
DynamoDB.2,DynamoDB tables should have point-in-time recovery enabled,This control checks whether point-in-time recovery (PITR) is enabled for a DynamoDB table.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/DynamoDB.2/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/dynamodb-controls.html#dynamodb-2,Recover > Resilience > Backups enabled,AWS::DynamoDB::Table,dynamodb-pitr-enabled,Change triggered,"To restore a DynamoDB table to a point in time, see Restoring a DynamoDB table to a point in time in the Amazon DynamoDB Developer Guide."
DynamoDB.3,DynamoDB Accelerator (DAX) clusters should be encrypted at rest,This control checks whether a DAX cluster is encrypted at rest.,MEDIUM,UNAVAILABLE,https://docs.aws.amazon.com/console/securityhub/DynamoDB.3/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/dynamodb-controls.html#dynamodb-3,Protect > Data Protection > Encryption of data-at-rest,AWS::DAX::Cluster,dax-encryption-enabled,Periodic,"You cannot enable or disable encryption at rest after a cluster is created. You must recreate the cluster in order to enable encryption at rest. For detailed instructions on how to create a DAX cluster with encryption at rest enabled, see Enabling encryption at rest using the AWS Management Console in the Amazon DynamoDB Developer Guide."
DynamoDB.4,DynamoDB tables should be present in a backup plan,"This control evaluates whether an Amazon DynamoDB table in 'ACTIVE' state is covered by a backup plan. The control fails if the DynamoDB table isn’t covered by a backup plan. If you set the backupVaultLockCheck parameter equal to true, the control passes only if the DynamoDB table is backed up in an AWS Backup locked vault.",MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/DynamoDB.4/remediation,"Parameter: backupVaultLockCheck
Description: The control produces a 'PASSED' finding if the parameter is set to 'true' and the resource uses AWS Backup Vault Lock
Type: Boolean
Default Value: N/A
Min: N/A
Max: N/A
---
",1,NIST Special Publication 800-53 Revision 5,https://docs.aws.amazon.com/securityhub/latest/userguide/dynamodb-controls.html#dynamodb-4,Recover > Resilience > Backups enabled,AWS::DynamoDB::Table,dynamodb-resources-protected-by-backup-plan,Periodic,"To add a DynamoDB table to an AWS Backup backup plan, see Assigning resources to a backup plan in the AWS Backup Developer Guide."
DynamoDB.5,DynamoDB tables should be tagged,"This control checks whether an Amazon DynamoDB table has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the table doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the table isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/DynamoDB.5/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/dynamodb-controls.html#dynamodb-5,Identify > Inventory > Tagging,AWS::DynamoDB::Table,tagged-dynamodb-table (custom Security Hub rule),Change triggered,"To add tags to a DynamoDB table, see Tagging resources in DynamoDB in the Amazon DynamoDB Developer Guide."
DynamoDB.6,DynamoDB tables should have deletion protection enabled,This control checks whether an Amazon DynamoDB table has deletion protection enabled. The control fails if a DynamoDB table doesn't have deletion protection enabled.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/DynamoDB.6/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/dynamodb-controls.html#dynamodb-6,Protect > Data protection > Data deletion protection,AWS::DynamoDB::Table,dynamodb-table-deletion-protection-enabled,Change triggered,"To enable deletion protection for a DynamoDB table, see Using deletion protection in the Amazon DynamoDB Developer Guide."
DynamoDB.7,DynamoDB Accelerator clusters should be encrypted in transit,"This control checks whether an Amazon DynamoDB Accelerator (DAX) cluster is encrypted in transit, with the endpoint encryption type set to TLS. The control fails if the DAX cluster isn't encrypted in transit.",MEDIUM,UNAVAILABLE,https://docs.aws.amazon.com/console/securityhub/DynamoDB.7/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/dynamodb-controls.html#dynamodb-7,Protect > Data Protection > Encryption of data-in-transit,AWS::DynamoDB::Table,dax-tls-endpoint-encryption,Periodic,"You can't change the TLS encryption setting after creating a DAX cluster. To encrypt an existing DAX cluster, create a new cluster with encryption in transit enabled, shift your application's traffic to it, and then delete the old cluster. For more information, see Using deletion protection in the Amazon DynamoDB Developer Guide."
EC2.1,EBS snapshots should not be publicly restorable,This AWS control checks whether Amazon Elastic Block Store snapshots are not publicly restorable.,CRITICAL,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EC2.1/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v3.2.1",https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-1,Protect > Secure network configuration,AWS::::Account,ebs-snapshot-public-restorable-check,Periodic,"To make a public EBS snapshot private, see Share a snapshot in the Amazon EC2 User Guide. For Actions, Modify permissions, choose Private."
EC2.2,VPC default security groups should not allow inbound or outbound traffic,This AWS control checks that the default security group of a VPC does not allow inbound or outbound traffic.,HIGH,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EC2.2/remediation,,6,"AWS Foundational Security Best Practices v1.0.0, CIS AWS Foundations Benchmark v1.2.0, CIS AWS Foundations Benchmark v1.4.0, CIS AWS Foundations Benchmark v3.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v3.2.1",https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-2,Protect > Secure network configuration,AWS::EC2::SecurityGroup,vpc-default-security-group-closed,Change triggered,"To remediate this issue, start by creating new least-privilege security groups. For instructions, see Create a security group in the Amazon VPC User Guide. Then, assign the new security groups to your EC2 instances. For instructions, see Change an instance's security group in the Amazon EC2 User Guide. After you assign the new security groups to your resources, remove all inbound and outbound rules from the default security groups. For instructions, see Configure security group rules in the Amazon VPC User Guide."
EC2.3,Attached EBS volumes should be encrypted at-rest,This AWS control checks whether the EBS volumes that are in an attached state are encrypted.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EC2.3/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-3,Protect > Data Protection > Encryption of data-at-rest,AWS::EC2::Volume,encrypted-volumes,Change triggered,"There's no direct way to encrypt an existing unencrypted volume or snapshot. You can only encrypt a new volume or snapshot when you create it. If you enabled encryption by default, Amazon EBS encrypts the resulting new volume or snapshot using your default key for Amazon EBS encryption. Even if you have not enabled encryption by default, you can enable encryption when you create an individual volume or snapshot. In both cases, you can override the default key for Amazon EBS encryption and choose a symmetric customer managed key. For more information, see Creating an Amazon EBS volume and Copying an Amazon EBS snapshot in the Amazon EC2 User Guide."
EC2.4,Stopped EC2 instances should be removed after a specified time period,"This control checks whether an Amazon EC2 instance has been stopped for longer than the allowed number of days. The control fails if an EC2 instance is stopped for longer than the maximum allowed time period. Unless you provide a custom parameter value for the maximum allowed time period, Security Hub uses a default value of 30 days.",MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EC2.4/remediation,"Parameter: AllowedDays
Description: Number of days the EC2 instance is allowed to be in a stopped state before generating a failed finding.
Type: Integer
Default Value: 30
Min: 1
Max: 365
---
",2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-4,Identify > Inventory,AWS::EC2::Instance,ec2-stopped-instance,Periodic,"To terminate an inactive EC2 instance, see Terminate an instance in the Amazon EC2 User Guide."
EC2.6,VPC flow logging should be enabled in all VPCs,This control checks whether Amazon Virtual Private Cloud flow logs are found and enabled for Amazon VPCs. The traffic type is set to 'Reject'.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EC2.6/remediation,,6,"AWS Foundational Security Best Practices v1.0.0, CIS AWS Foundations Benchmark v1.2.0, CIS AWS Foundations Benchmark v1.4.0, CIS AWS Foundations Benchmark v3.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v3.2.1",https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-6,Identify > Logging,AWS::EC2::VPC,vpc-flow-logs-enabled,Periodic,"To create a VPC Flow Log, see Create a Flow Log in the Amazon VPC User Guide. After you open the Amazon VPC console, choose Your VPCs. For Filter, choose Reject or All."
EC2.7,EBS default encryption should be enabled,This control checks whether Amazon Elastic Block Store (EBS) encryption is enabled by default. The control fails if EBS default encryption is not enabled.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EC2.7/remediation,,4,"AWS Foundational Security Best Practices v1.0.0, CIS AWS Foundations Benchmark v1.4.0, CIS AWS Foundations Benchmark v3.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-7,Protect > Data Protection > Encryption of data-at-rest,AWS::::Account,ec2-ebs-encryption-by-default,Periodic,"To configure default encryption for Amazon EBS volumes, see Encryption by default in the Amazon EC2 User Guide."
EC2.8,EC2 instances should use Instance Metadata Service Version 2 (IMDSv2),This control checks whether your Amazon Elastic Compute Cloud (Amazon EC2) instance metadata version is configured with Instance Metadata Service Version 2 (IMDSv2). The control passes if HttpTokens is set to required for IMDSv2. The control fails if HttpTokens is set to optional.,HIGH,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EC2.8/remediation,,4,"AWS Foundational Security Best Practices v1.0.0, CIS AWS Foundations Benchmark v3.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-8,Protect > Network Security,AWS::EC2::Instance,ec2-imdsv2-check,Change triggered,"To configure EC2 instances with IMDSv2, see Recommended path to requiring IMDSv2 in the Amazon EC2 User Guide."
EC2.9,EC2 instances should not have a public IPv4 address,This control checks whether EC2 instances have a public IP address. The control fails if the publicIp field is present in the EC2 instance configuration item. This control applies to IPv4 addresses only.,HIGH,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EC2.9/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-9,Protect > Secure network configuration > Resources not publicly accessible,AWS::EC2::Instance,ec2-instance-no-public-ip,Change triggered,"Use a non-default VPC so that your instance isn't assigned a public IP address by default. When you launch an EC2 instance into a default VPC, it is assigned a public IP address. When you launch an EC2 instance into a non-default VPC, the subnet configuration determines whether it receives a public IP address. The subnet has an attribute to determine if new EC2 instances in the subnet receive a public IP address from the public IPv4 address pool. You can disassociate an automatically-assigned public IP address from your EC2 instance. For more information, see Public IPv4 addresses and external DNS hostnames in the Amazon EC2 User Guide."
EC2.10,Amazon EC2 should be configured to use VPC endpoints that are created for the Amazon EC2 service,This control checks whether a service endpoint for Amazon EC2 is created for each VPC. The control fails if a VPC does not have a VPC endpoint created for the Amazon EC2 service.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EC2.10/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-10,"Protect > Secure network configuration > API
    private access",AWS::EC2::VPC,service-vpc-endpoint-enabled,Periodic,"To create an interface endpoint to Amazon EC2 from the Amazon VPC console, see Create a VPC endpoint in the AWS PrivateLink Guide. For Service name, choose com.amazonaws.region.ec2. You can also create and attach an endpoint policy to your VPC endpoint to control access to the Amazon EC2 API. For instructions on creating a VPC endpoint policy, see Create an endpoint policy in the Amazon EC2 User Guide."
EC2.12,Unused EC2 EIPs should be removed,This AWS control will assist you maintain an accurate asset inventory of EIPs by checking wheather Elastic IP addresses that are allocated to a VPC are attached to EC2 instances or in-use elastic network interfaces (ENIs).,LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EC2.12/remediation,,2,"NIST Special Publication 800-53 Revision 5, PCI DSS v3.2.1",https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-12,Protect > Secure network configuration,AWS::EC2::EIP,eip-attached,Change triggered,"To release an unused EIP, see Release an Elastic IP address in the Amazon EC2 User Guide."
EC2.13,Security groups should not allow ingress from 0.0.0.0/0 or ::/0 to port 22,This control checks whether an Amazon EC2 security group allows ingress from ‘0.0.0.0/0’ or ‘::/0’ to port 22. The control fails if the security group allows ingress from ‘0.0.0.0/0’ or ‘::/0’ to port 22.,HIGH,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EC2.13/remediation,,4,"CIS AWS Foundations Benchmark v1.2.0, NIST Special Publication 800-53 Revision 5, PCI DSS v3.2.1, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-13,"Protect > Secure network
            configuration",AWS::EC2::SecurityGroup,restricted-ssh,Change triggered and periodic,"To prohibit ingress to port 22, remove the rule that allows such access for each security group associated with a VPC. For instructions, see Update security group rules in the Amazon EC2 User Guide. After selecting a security group in the Amazon EC2 console, choose Actions, Edit inbound rules. Remove the rule that allows access to port 22."
EC2.14,Security groups should not allow ingress from 0.0.0.0/0 or ::/0 to port 3389,This control checks whether an Amazon EC2 security group allows ingress from ‘0.0.0.0/0’ or ‘::/0’ to port 3389. The control fails if the security group allows ingress from ‘0.0.0.0/0’ or ‘::/0’ to port 3389.,HIGH,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EC2.14/remediation,,2,"CIS AWS Foundations Benchmark v1.2.0, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-14,"Protect > Secure network
            configuration",AWS::EC2::SecurityGroup,restricted-common-ports,Change triggered and periodic,"To prohibit ingress to port 3389, remove the rule that allows such access for each security group associated with a VPC. For instructions, see Update security group rules in the Amazon VPC User Guide. After selecting a security group in the Amazon VPC Console, choose Actions, Edit inbound rules. Remove the rule that allows access to port 3389."
EC2.15,EC2 subnets should not automatically assign public IP addresses,This control checks if the assignment of public IPs in Amazon Virtual Private Cloud (VPC) subnets have the MapPublicIpOnLaunch set to FALSE. The control will pass if the flag is set to FALSE.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EC2.15/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-15,Protect > Network Security,AWS::EC2::Subnet,subnet-auto-assign-public-ip-disabled,Change triggered,"To configure a subnet to not assign public IP addresses, see Modify the public IPv4 addressing attribute for your subnet in the Amazon VPC User Guide. Clear the check box for Enable auto-assign public IPv4 address."
EC2.16,Unused Network Access Control Lists should be removed,This control checks to see if there are any NACLs (Network Access Control List) that are unused. The control will check the item configuration of the resource AWS::EC2::NetworkAcl and determine the relationships of the NACL.,LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EC2.16/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-16,Protect > Network Security,AWS::EC2::NetworkAcl,vpc-network-acl-unused-check,Change triggered,"For instructions on deleting an unused network ACL, see Deleting a network ACL in the Amazon VPC User Guide. You can't delete the default network ACL or an ACL that is associated with subnets."
EC2.17,EC2 instances should not use multiple ENIs,This control checks to see if Amazon EC2 instance uses multiple ENI/EFA. This control will pass if single network adapters is used.,LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EC2.17/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-17,Protect > Network Security,AWS::EC2::Instance,ec2-instance-multiple-eni-check,Change triggered,"To detach a network interface from an EC2 instance, see Detach a network interface from an instance in the Amazon EC2 User Guide."
EC2.18,Security groups should only allow unrestricted incoming traffic for authorized ports,"This control checks whether an Amazon EC2 security group permits unrestricted incoming traffic from unauthorized ports. The control status is determined as follows: If you use the default value for 'authorizedTcpPorts', the control fails if the security group permits unrestricted incoming traffic from any port other than ports 80 and 443; If you provide custom values for 'authorizedTcpPorts' or 'authorizedUdpPorts', the control fails if the security group permits unrestricted incoming traffic from any unlisted port; If no parameter is used, the control fails for any security group that has an unrestricted inbound traffic rule.",HIGH,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EC2.18/remediation,"Parameter: authorizedUdpPorts
Description: List of authorized UDP ports
Type: IntegerList
Default Value: N/A
Min: 1
Max: 65535
---
Parameter: authorizedTcpPorts
Description: List of authorized TCP ports
Type: IntegerList
Default Value: [80, 443]
Min: 1
Max: 65535
---
",2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-18,"Protect > Secure network configuration >
            Security group configuration",AWS::EC2::SecurityGroup,vpc-sg-open-only-to-authorized-ports,Change triggered,"To modify a security group, see Work with security groups in the Amazon VPC User Guide."
EC2.19,Security groups should not allow unrestricted access to ports with high risk,"This control checks whether unrestricted incoming traffic for an Amazon EC2 security group is accessible to the specified ports [3389, 20, 23, 110, 143, 3306, 8080, 1433, 9200, 9300, 25, 445, 135, 21, 1434, 4333, 5432, 5500, 5601, 22, 3000, 5000, 8088, 8888] that are considered to be high risk. This control fails if any of the rules in a security group allow ingress traffic from '0.0.0.0/0' or '::/0' to those ports.",CRITICAL,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EC2.19/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-19,Protect > Restricted network access,AWS::EC2::SecurityGroup,restricted-common-ports,Change triggered and periodic,"To delete rules from a security group, see Delete rules from a security group in the Amazon EC2 User Guide."
EC2.20,Both VPN tunnels for an AWS Site-to-Site VPN connection should be up,This control checks that both VPN tunnels provided by AWS Site-to-Site VPN are in UP status. The control fails if one or both tunnels are in DOWN status.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EC2.20/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-20,Recover > Resilience > High availability,AWS::EC2::Volume,vpc-vpn-2-tunnels-up,Change triggered,"To modify VPN tunnel options, see Modifying Site-to-Site VPN tunnel options in the AWS Site-to-Site VPN User Guide."
EC2.21,Network ACLs should not allow ingress from 0.0.0.0/0 to port 22 or port 3389,This control checks whether a network access control list (NACL) allows unrestricted access to the default ports for SSH/RDP ingress traffic. The rule fails if a NACL inbound entry allows a source CIDR block of '0.0.0.0/0' or '::/0' for ports 22 or 3389,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EC2.21/remediation,,5,"AWS Foundational Security Best Practices v1.0.0, CIS AWS Foundations Benchmark v1.4.0, CIS AWS Foundations Benchmark v3.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-21,"Protect > Secure Network
            Configuration",AWS::EC2::Volume,nacl-no-unrestricted-ssh-rdp,Change triggered,"To edit network ACL traffic rules, see Work with network ACLs in the Amazon VPC User Guide."
EC2.22,Unused EC2 security groups should be removed,This AWS control checks that security groups are attached to Amazon EC2 instances or to an elastic network interface. The control will fail the security group is not associated with an Amazon EC2 instance or an elastic network interface.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EC2.22/remediation,,0,N/A,https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-22,Identify > Inventory,AWS::EC2::Volume,ec2-security-group-attached-to-eni-periodic,Periodic,"To create, assign and delete security groups, see Security groups in Amazon EC2 user guide."
EC2.23,EC2 Transit Gateways should not automatically accept VPC attachment requests,This control checks if EC2 Transit Gateways are automatically accepting shared VPC attachments requests. This control will fail for a Transit Gateway that automatically accept shared VPC attachment requests.,HIGH,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EC2.23/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-23,"Protect > Secure network
            configuration",AWS::EC2::Volume,ec2-transit-gateway-auto-vpc-attach-disabled,Change triggered,"To modify a transit gateway, see Modify a transit gateway in the Amazon VPC Developer Guide."
EC2.24,EC2 paravirtual instance types should not be used,This control checks whether the virtualization type of an EC2 instance is paravirtual. The control fails for an EC2 instance if ‘virtualizationType’ is set to ‘paravirtual’.,MEDIUM,UNAVAILABLE,https://docs.aws.amazon.com/console/securityhub/EC2.24/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-24,"Identify > Vulnerability, patch, and version management",AWS::EC2::Volume,ec2-paravirtual-instance-check,Change triggered,"To update an EC2 instance to a new instance type, see Change the instance type in the Amazon EC2 User Guide."
EC2.25,EC2 launch templates should not assign public IPs to network interfaces,This control checks if Amazon EC2 launch templates are configured to assign public IP addresses to network interfaces upon launch. The control fails if an EC2 launch template is configured to assign a public IP address to network interfaces or if there is at least one network interface that has a public IP address.,HIGH,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EC2.25/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-25,Protect > Secure network configuration > Resources not publicly accessible,AWS::EC2::Volume,ec2-launch-template-public-ip-disabled,Change triggered,"To update an EC2 launch template, see Change the default network interface settings in the Amazon EC2 Auto Scaling User Guide."
EC2.28,EBS volumes should be in a backup plan,"This control evaluates if an Amazon EBS volume in 'in-use' state is covered by a backup plan. The control fails if an EBS volume isn’t covered by a backup plan. If you set the 'backupVaultLockCheck' parameter equal to 'true', the control passes only if the EBS volume is backed up in an AWS Backup locked vault.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EC2.28/remediation,"Parameter: backupVaultLockCheck
Description: The control produces a 'PASSED' finding if the parameter is set to 'true' and the resource uses AWS Backup Vault Lock
Type: Boolean
Default Value: N/A
Min: N/A
Max: N/A
---
",1,NIST Special Publication 800-53 Revision 5,https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-28,"Recover > Resilience > Backups
            enabled",AWS::EC2::Volume,ebs-resources-protected-by-backup-plan,Periodic,"To add an Amazon EBS volume to an AWS Backup backup plan, see Assigning resources to a backup plan in the AWS Backup Developer Guide."
EC2.33,EC2 transit gateway attachments should be tagged,"This control checks whether an Amazon EC2 transit gateway attachment has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the transit gateway attachment doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the transit gateway attachment isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EC2.33/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-33,Identify > Inventory > Tagging,AWS::EC2::TransitGatewayAttachment,tagged-ec2-transitgatewayattachment (custom Security Hub rule),Change triggered,"To add tags to an EC2 transit gateway attachment, see Tag your Amazon EC2 resources in the Amazon EC2 User Guide."
EC2.34,EC2 transit gateway route tables should be tagged,"This control checks whether an Amazon EC2 transit gateway route table has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the transit gateway route table doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the transit gateway route table isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EC2.34/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-34,Identify > Inventory > Tagging,AWS::EC2::TransitGatewayRouteTable,tagged-ec2-transitgatewayroutetable (custom Security Hub rule),Change triggered,"To add tags to an EC2 transit gateway route table, see Tag your Amazon EC2 resources in the Amazon EC2 User Guide."
EC2.35,EC2 network interfaces should be tagged,"This control checks whether an Amazon EC2 network interface has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the network interface doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the network interface isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EC2.35/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-35,Identify > Inventory > Tagging,AWS::EC2::NetworkInterface,tagged-ec2-networkinterface (custom Security Hub rule),Change triggered,"To add tags to an EC2 network interface, see Tag your Amazon EC2 resources in the Amazon EC2 User Guide."
EC2.36,EC2 customer gateways should be tagged,"This control checks whether an Amazon EC2 customer gateway has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if a customer gateway doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the customer gateway isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EC2.36/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-36,Identify > Inventory > Tagging,AWS::EC2::CustomerGateway,tagged-ec2-customergateway (custom Security Hub rule),Change triggered,"To add tags to an EC2 customer gateway, see Tag your Amazon EC2 resources in the Amazon EC2 User Guide."
EC2.37,EC2 Elastic IP addresses should be tagged,"This control checks whether an Amazon EC2 Elastic IP address has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the Elastic IP address doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the Elastic IP address isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EC2.37/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-37,Identify > Inventory > Tagging,AWS::EC2::EIP,tagged-ec2-eip (custom Security Hub rule),Change triggered,"To add tags to an EC2 Elastic IP address, see Tag your Amazon EC2 resources in the Amazon EC2 User Guide."
EC2.38,EC2 instances should be tagged,"This control checks whether an Amazon EC2 instance has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if an instance doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the instance isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EC2.38/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-38,Identify > Inventory > Tagging,AWS::EC2::Instance,tagged-ec2-instance (custom Security Hub rule),Change triggered,"To add tags to an EC2 instance, see Tag your Amazon EC2 resources in the Amazon EC2 User Guide."
EC2.39,EC2 internet gateways should be tagged,"This control checks whether an Amazon EC2 internet gateway has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the internet gateway doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the internet gateway isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EC2.39/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-39,Identify > Inventory > Tagging,AWS::EC2::InternetGateway,tagged-ec2-internetgateway (custom Security Hub rule),Change triggered,"To add tags to an EC2 internet gateway, see Tag your Amazon EC2 resources in the Amazon EC2 User Guide."
EC2.40,EC2 NAT gateways should be tagged,"This control checks whether an Amazon EC2 network address translation (NAT) gateway has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the NAT gateway doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the NAT gateway isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EC2.40/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-40,Identify > Inventory > Tagging,AWS::EC2::NatGateway,tagged-ec2-natgateway (custom Security Hub rule),Change triggered,"To add tags to an EC2 NAT gateway, see Tag your Amazon EC2 resources in the Amazon EC2 User Guide."
EC2.41,EC2 network ACLs should be tagged,"This control checks whether an Amazon EC2 network access control list (network ACL) has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the network ACL doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the network ACL isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EC2.41/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-41,Identify > Inventory > Tagging,AWS::EC2::NetworkAcl,tagged-ec2-networkacl (custom Security Hub rule),Change triggered,"To add tags to an EC2 network ACL, see Tag your Amazon EC2 resources in the Amazon EC2 User Guide."
EC2.42,EC2 route tables should be tagged,"This control checks whether an Amazon EC2 route table has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the route table doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the route table isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EC2.42/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-42,Identify > Inventory > Tagging,AWS::EC2::RouteTable,tagged-ec2-routetable (custom Security Hub rule),Change triggered,"To add tags to an EC2 route table, see Tag your Amazon EC2 resources in the Amazon EC2 User Guide."
EC2.43,EC2 security groups should be tagged,"This control checks whether an Amazon EC2 security group has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the security group doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the security group isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EC2.43/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-43,Identify > Inventory > Tagging,AWS::EC2::SecurityGroup,tagged-ec2-securitygroup (custom Security Hub rule),Change triggered,"To add tags to an EC2 security group, see Tag your Amazon EC2 resources in the Amazon EC2 User Guide."
EC2.44,EC2 subnets should be tagged,"This control checks whether an Amazon EC2 subnet has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the subnet doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the subnet isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EC2.44/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-44,Identify > Inventory > Tagging,AWS::EC2::Subnet,tagged-ec2-subnet (custom Security Hub rule),Change triggered,"To add tags to an EC2 subnet, see Tag your Amazon EC2 resources in the Amazon EC2 User Guide."
EC2.45,EC2 volumes should be tagged,"This control checks whether an Amazon EC2 volume has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the volume doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the volume isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EC2.45/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-45,Identify > Inventory > Tagging,AWS::EC2::Volume,tagged-ec2-volume (custom Security Hub rule),Change triggered,"To add tags to an EC2 volume, see Tag your Amazon EC2 resources in the Amazon EC2 User Guide."
EC2.46,Amazon VPCs should be tagged,"This control checks whether an Amazon Virtual Private Cloud (Amazon VPC) has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the Amazon VPC doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the Amazon VPC isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EC2.46/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-46,Identify > Inventory > Tagging,AWS::EC2::VPC,tagged-ec2-vpc (custom Security Hub rule),Change triggered,"To add tags to a VPC, see Tag your Amazon EC2 resources in the Amazon EC2 User Guide."
EC2.47,Amazon VPC endpoint services should be tagged,"This control checks whether an Amazon VPC endpoint service has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the endpoint service doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the endpoint service isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EC2.47/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-47,Identify > Inventory > Tagging,AWS::EC2::VPCEndpointService,tagged-ec2-vpcendpointservice (custom Security Hub rule),Change triggered,"To add tags to an Amazon VPC endpoint service, see Manage Tags in the Configure an endpoint service section of the AWS PrivateLink Guide."
EC2.48,Amazon VPC flow logs should be tagged,"This control checks whether an Amazon VPC flow log has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the flow log doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the flow log isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EC2.48/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-48,Identify > Inventory > Tagging,AWS::EC2::FlowLog,tagged-ec2-flowlog (custom Security Hub rule),Change triggered,"To add tags to an Amazon VPC flow log, see Tag a flow log in the Amazon VPC User Guide."
EC2.49,Amazon VPC peering connections should be tagged,"This control checks whether an Amazon VPC peering connection has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the peering connection doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the peering connection isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EC2.49/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-49,Identify > Inventory > Tagging,AWS::EC2::VPCPeeringConnection,tagged-ec2-vpcpeeringconnection (custom Security Hub rule),Change triggered,"To add tags to an Amazon VPC peering connection, see Tag your Amazon EC2 resources in the Amazon EC2 User Guide."
EC2.50,EC2 VPN gateways should be tagged,"This control checks whether an Amazon EC2 VPN gateway has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the VPN gateway doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the VPN gateway isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EC2.50/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-50,Identify > Inventory > Tagging,AWS::EC2::VPNGateway,tagged-ec2-vpngateway (custom Security Hub rule),Change triggered,"To add tags to an EC2 VPN gateway, see Tag your Amazon EC2 resources in the Amazon EC2 User Guide."
EC2.51,EC2 Client VPN endpoints should have client connection logging enabled,This control checks if an AWS Client VPN endpoint has client connection logging enabled. The control fails if the endpoint doesn't have client connection logging enabled.,LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EC2.51/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-51,Identify > Logging,AWS::EC2::ClientVpnEndpoint,ec2-client-vpn-connection-log-enabled,Change triggered,"To enable connection logging, see Enable connection logging for an existing Client VPN endpoint in the AWS Client VPN Administrator Guide."
EC2.52,EC2 transit gateways should be tagged,"This control checks if an Amazon EC2 transit gateway has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the EC2 transit gateway doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the transit gateway isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EC2.52/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-52,Identify > Inventory > Tagging,AWS::EC2::TransitGateway,tagged-ec2-transitgateway (custom Security Hub rule),Change triggered,"To add tags to an EC2 transit gateway, see Tag your Amazon EC2 resources in the Amazon EC2 User Guide."
EC2.53,EC2 security groups should not allow ingress from 0.0.0.0/0 to remote server administration ports,This control checks whether an Amazon EC2 security group allows ingress from 0.0.0.0/0 to remote server administration ports (ports 22 and 3389). The control fails if the security group allows ingress from 0.0.0.0/0 to port 22 or 3389.,HIGH,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EC2.53/remediation,,2,"CIS AWS Foundations Benchmark v3.0.0, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-53,"Protect > Secure network
            configuration > Security group configuration",AWS::EC2::SecurityGroup,vpc-sg-port-restriction-check,Periodic,"To update an EC2 security group rule to prohibit ingress traffic to the specified ports, see Update security group rules in the Amazon EC2 User Guide. After selecting a security group in the Amazon EC2 console, choose Actions, Edit inbound rules. Remove the rule that allows access to port 22 or port 3389."
EC2.54,EC2 security groups should not allow ingress from ::/0 to remote server administration ports,This control checks whether an Amazon EC2 security group allows ingress traffic from ::/0 to remote server administration ports (ports 22 and 3389). The control fails if the security group allows ingress traffic from ::/0 to port 22 or 3389.,HIGH,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EC2.54/remediation,,2,"CIS AWS Foundations Benchmark v3.0.0, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-54,"Protect > Secure network
            configuration > Security group configuration",AWS::EC2::SecurityGroup,vpc-sg-port-restriction-check,Periodic,"To update an EC2 security group rule to prohibit ingress traffic to the specified ports, see Update security group rules in the Amazon EC2 User Guide. After selecting a security group in the Amazon EC2 console, choose Actions, Edit inbound rules. Remove the rule that allows access to port 22 or port 3389."
EC2.55,VPCs should be configured with an interface endpoint for ECR API,This control checks whether a virtual private cloud (VPC) that you manage has an interface VPC endpoint for ECR API. The control fails if the VPC doesn't have an interface VPC endpoint for ECR API. This control evaluates resources in a single account.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EC2.55/remediation,"Parameter: vpcIds
Description: Comma-separated list of Amazon VPC IDs for VPC endpoints. If provided, the control fails if the services specified in the serviceName parameter don't have one of these VPC endpoints.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-55,Protect > Secure access management > Access control,AWS::EC2::VPC,vpc-endpoint-enabled,Periodic,"To configure a VPC endpoint, see Access an AWS service using an interface VPC endpoint in the AWS PrivateLink Guide."
EC2.56,VPCs should be configured with an interface endpoint for Docker Registry,This control checks whether a virtual private cloud (VPC) that you manage has an interface VPC endpoint for Docker Registry. The control fails if the VPC doesn't have an interface VPC endpoint for Docker Registry. This control evaluates resources in a single account.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EC2.56/remediation,"Parameter: vpcIds
Description: Comma-separated list of Amazon VPC IDs for VPC endpoints. If provided, the control fails if the services specified in the serviceName parameter don't have one of these VPC endpoints.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-56,Protect > Secure access management > Access control,AWS::EC2::VPC,vpc-endpoint-enabled,Periodic,"To configure a VPC endpoint, see Access an AWS service using an interface VPC endpoint in the AWS PrivateLink Guide."
EC2.57,VPCs should be configured with an interface endpoint for Systems Manager,This control checks whether a virtual private cloud (VPC) that you manage has an interface VPC endpoint for Systems Manager. The control fails if the VPC doesn't have an interface VPC endpoint for Systems Manager. This control evaluates resources in a single account.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EC2.57/remediation,"Parameter: vpcIds
Description: Comma-separated list of Amazon VPC IDs for VPC endpoints. If provided, the control fails if the services specified in the serviceName parameter don't have one of these VPC endpoints.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-57,Protect > Secure access management > Access control,AWS::EC2::VPC,vpc-endpoint-enabled,Periodic,"To configure a VPC endpoint, see Access an AWS service using an interface VPC endpoint in the AWS PrivateLink Guide."
EC2.58,VPCs should be configured with an interface endpoint for Systems Manager Incident Manager Contacts,This control checks whether a virtual private cloud (VPC) that you manage has an interface VPC endpoint for Systems Manager Incident Manager Contacts. The control fails if the VPC doesn't have an interface VPC endpoint for Systems Manager Incident Manager Contacts. This control evaluates resources in a single account.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EC2.58/remediation,"Parameter: vpcIds
Description: Comma-separated list of Amazon VPC IDs for VPC endpoints. If provided, the control fails if the services specified in the serviceName parameter don't have one of these VPC endpoints.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-58,Protect > Secure access management > Access control,AWS::EC2::VPC,vpc-endpoint-enabled,Periodic,"To configure a VPC endpoint, see Access an AWS service using an interface VPC endpoint in the AWS PrivateLink Guide."
EC2.60,VPCs should be configured with an interface endpoint for Systems Manager Incident Manager,This control checks whether a virtual private cloud (VPC) that you manage has an interface VPC endpoint for Systems Manager Incident Manager. The control fails if the VPC doesn't have an interface VPC endpoint for Systems Manager Incident Manager. This control evaluates resources in a single account.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EC2.60/remediation,"Parameter: vpcIds
Description: Comma-separated list of Amazon VPC IDs for VPC endpoints. If provided, the control fails if the services specified in the serviceName parameter don't have one of these VPC endpoints.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-60,Protect > Secure access management > Access control,AWS::EC2::VPC,vpc-endpoint-enabled,Periodic,"To configure a VPC endpoint, see Access an AWS service using an interface VPC endpoint in the AWS PrivateLink Guide."
EC2.170,EC2 launch templates should use Instance Metadata Service Version 2 (IMDSv2),This control checks whether an Amazon EC2 launch template is configured with Instance Metadata Service Version 2 (IMDSv2). The control fails if HttpTokens is set to optional.,LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EC2.170/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-170,Protect > Network Security,AWS::EC2::LaunchTemplate,ec2-launch-template-imdsv2-check,Change triggered,"To require IMDSv2 on an EC2 launch template, see Configure the Instance Metadata Service options in the Amazon EC2 User Guide."
EC2.171,EC2 VPN connections should have logging enabled,This control checks whether an AWS Site-to-Site VPN connection has Amazon CloudWatch Logs enabled for both tunnels. The control fails if a Site-to-Site VPN connection doesn't have CloudWatch Logs enabled for both tunnels.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EC2.171/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-171,Identify > Logging,AWS::EC2::VPNConnection,ec2-vpn-connection-logging-enabled,Change triggered,"To enable tunnel logging on an EC2 VPN connection, see AWS Site-to-Site VPN logs in the AWS Site-to-Site VPN User Guide."
EC2.172,EC2 VPC Block Public Access settings should block internet gateway traffic,"This control checks whether Amazon EC2 VPC Block Public Access (BPA) settings are configured to block internet gateway traffic for all Amazon VPCs in the AWS account. The control fails if EC2 VPC BPA settings aren't configured to block internet gateway traffic. If the parameter `vpcBpaInternetGatewayBlockMode` is provided, the control passes only if the EC2 VPC BPA value for InternetGatewayBlockMode matches the parameter.",MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EC2.172/remediation,"Parameter: vpcBpaInternetGatewayBlockMode
Description: String value of the EC2 VPC BPA options mode for the rule to check. Valid values include: `block-bidirectional` and `block-ingress`.
Type: Enum
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Foundational Security Best Practices v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-172,Protect > Secure network configuration > Resources not publicly accessible,AWS::EC2::VPCBlockPublicAccessOptions,ec2-vpc-bpa-internet-gateway-blocked (custom Security Hub rule),Change triggered,"To enable bi-directional BPA at the account level, see Enable BPA bidirectional mode for your account in the Amazon VPC User Guide. To enable ingress-only BPA, see Change VPC BPA mode to ingress-only. To enable VPC BPA at the Organization level, see Enable VPC BPA at the Organization level."
ECR.1,ECR private repositories should have image scanning configured,This control checks whether a private ECR repository has image scanning configured. This control fails if a private ECR repository doesn’t have image scanning configured.,HIGH,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/ECR.1/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/ecr-controls.html#ecr-1,"Identify > Vulnerability, patch, and version management",AWS::ECR::Repository,ecr-private-image-scanning-enabled,Periodic,"To configure image scanning for an ECR repository, see Image scanning in the Amazon Elastic Container Registry User Guide."
ECR.2,ECR private repositories should have tag immutability configured,This control checks whether a private ECR repository has tag immutability configured. This control fails if a private ECR repository has tag immutability disabled. This rule passes if tag immutability is configured and has the value IMMUTABLE,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/ECR.2/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/ecr-controls.html#ecr-2,Identify > Inventory > Tagging,AWS::ECR::Repository,ecr-private-tag-immutability-enabled,Change triggered,"To create a repository with immutable tags configured or to update the image tag mutability settings for an existing repository, see Image tag mutability in the Amazon Elastic Container Registry User Guide."
ECR.3,ECR repositories should have at least one lifecycle policy configured,This control checks whether an ECR repository has at least one lifecycle policy configured. This control fails if an ECR repository does not have any lifecycle policies configured.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/ECR.3/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/ecr-controls.html#ecr-3,Identify > Resource configuration,AWS::ECR::Repository,ecr-private-lifecycle-policy-configured,Change triggered,"To configure a lifecycle policy, see Creating a lifecycle policy preview in the Amazon Elastic Container Registry User Guide."
ECR.4,ECR public repositories should be tagged,"This control checks whether an Amazon ECR public repository has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the public repository doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the public repository isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,UNAVAILABLE,https://docs.aws.amazon.com/console/securityhub/ECR.4/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/ecr-controls.html#ecr-4,Identify > Inventory > Tagging,AWS::ECR::PublicRepository,tagged-ecr-publicrepository (custom Security Hub rule),Change triggered,"To add tags to an ECR public repository, see Tagging an Amazon ECR public repository in the Amazon Elastic Container Registry User Guide."
ECR.5,ECR repositories should be encrypted with customer managed AWS KMS keys,This control checks whether an Amazon ECR repository is encrypted at rest with a customer managed AWS KMS key. The control fails if the ECR repository isn't encrypted with a customer managed KMS key. You can optionally specify a list of KMS keys for the control to include in the evaluation.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/ECR.5/remediation,"Parameter: kmsKeyArns
Description: A list of Amazon Resource Names (ARNs) of AWS KMS keys to include in the evaluation. The control generates a FAILED finding if an ECR repository isn't encrypted with a KMS key in the list.


Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,NIST Special Publication 800-53 Revision 5,https://docs.aws.amazon.com/securityhub/latest/userguide/ecr-controls.html#ecr-5,Protect > Data Protection > Encryption of data-at-rest,AWS::ECR::Repository,ecr-repository-cmk-encryption-enabled,Change triggered,"You can't change the encryption settings for an existing ECR repository. However, you can specify different encryption settings for ECR repositories that you subsequently create. Amazon ECR supports the use of different encryption settings for individual repositories. For more information about encryption options for ECR repositories, see Encryption at rest in the Amazon ECR User Guide. For more information about customer managed AWS KMS keys, see AWS KMS keys in the AWS Key Management Service Developer Guide."
ECS.1,Amazon ECS task definitions should have secure networking modes and user definitions.,"This control checks if an Amazon ECS Task Definition with host networking mode has ""privileged"" or ""user"" container definitions. The control fails with host network mode and container definitions are privileged=false or empty and user=root or empty.",HIGH,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/ECS.1/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/ecs-controls.html#ecs-1,Protect > Secure access management,AWS::ECS::TaskDefinition,ecs-task-definition-user-for-host-mode-check,Change triggered,"For information about how to update a task definition, see Updating a task definition in the Amazon Elastic Container Service Developer Guide. When you update a task definition, it doesn't update running tasks that were launched from the previous task definition. To update a running task, you must redeploy the task with the new task definition."
ECS.2,ECS services should not have public IP addresses assigned to them automatically,This control checks whether ECS services are configured to automatically assign public IP addresses. This control fails if AssignPublicIP is ENABLED.,HIGH,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/ECS.2/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/ecs-controls.html#ecs-2,Protect > Secure network configuration > Resources not publicly accessible,AWS::ECS::Service,ecs-service-assign-public-ip-disabled (custom Security Hub rule),Change triggered,"First, you must create a task definition for your cluster that uses the awsvpc network mode and specifies FARGATE for requiresCompatibilities. Then, for Compute configuration, choose Launch type and FARGATE. Finally, for the Networking field, turn off Public IP to disable automatic public IP assignment for your service."
ECS.3,ECS task definitions should not share the host's process namespace,This control checks if Amazon ECS task definitions are configured to share a host's process namespace with its containers. This control fails if the task definition shares the host's process namespace with the containers running on it,HIGH,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/ECS.3/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/ecs-controls.html#ecs-3,Identify > Resource configuration,AWS::ECS::TaskDefinition,ecs-task-definition-pid-mode-check,Change triggered,"To configure the pidMode on a task definition, see Task definition parameters in the Amazon Elastic Container Service Developer Guide."
ECS.4,ECS containers should run as non-privileged,This control checks if the privileged parameter in the container definition of Amazon ECS task definitions is set to 'true'. This control fails if this parameter is equal to 'true'.,HIGH,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/ECS.4/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/ecs-controls.html#ecs-4,Protect > Secure access management > Root user access restrictions,AWS::ECS::TaskDefinition,ecs-containers-nonprivileged,Change triggered,"To configure the privileged parameter on a task definition, see Advanced container definition parameters in the Amazon Elastic Container Service Developer Guide."
ECS.5,ECS containers should be limited to read-only access to root filesystems,This control checks if ECS containers are limited to read-only access to mounted root filesystems. This control fails if the ReadonlyRootFilesystem parameter in the container definition of ECS task definitions is set to ‘false’.,HIGH,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/ECS.5/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/ecs-controls.html#ecs-5,Protect > Secure access management,AWS::ECS::TaskDefinition,ecs-containers-readonly-access,Change triggered,"Limiting container definitions to read-only access to root filesystemsOpen the Amazon ECS classic console at https://console.aws.amazon.com/ecs/. In the left navigation pane, choose Task definitions. Select a task definition that has container definitions that need to be updated. For each, complete the following steps: From the drop down, choose Create new revision with JSON. Add the readonlyRootFilesystem parameter, and set it to true in the container definition within the task definition. Choose Create."
ECS.8,Secrets should not be passed as container environment variables,"This control checks if the key value of any variables in the ‘environment’ parameter of container definitions includes - AWS_ACCESS_KEY_ID, AWS_SECRET_ACCESS_KEY,  or ECS_ENGINE_AUTH_DATA.",HIGH,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/ECS.8/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/ecs-controls.html#ecs-8,Protect > Secure development > Credentials not hard-coded,AWS::ECS::TaskDefinition,ecs-no-environment-secrets,Change triggered,"To create parameters using SSM, see Creating Systems Manager parameters in the AWS Systems Manager User Guide. For more information about creating a task definition that specifies a secret, see Specifying sensitive data using Secrets Manager in the Amazon Elastic Container Service Developer Guide."
ECS.9,ECS task definitions should have a logging configuration,This control checks if the latest active Amazon ECS task definition has a logging configuration specified. The control fails if the task definition doesn't have the logConfiguration property defined or if the value for logDriver is null in at least one container definition.,HIGH,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/ECS.9/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/ecs-controls.html#ecs-9,Identify > Logging,AWS::ECS::TaskDefinition,ecs-task-definition-log-configuration,Change triggered,"To define a log configuration for your Amazon ECS task definitions, see Specifying a log configuration in your task definition in the Amazon Elastic Container Service Developer Guide."
ECS.10,ECS Fargate services should run on the latest Fargate platform version,This control checks if ECS Fargate services is running the latest Fargate platform version. This control fails if the platform version is not latest.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/ECS.10/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/ecs-controls.html#ecs-10,"Identify > Vulnerability, patch, and version management",AWS::ECS::Service,ecs-fargate-latest-platform-version,Change triggered,"To update an existing service, including its platform version, see Updating a service in the Amazon Elastic Container Service Developer Guide."
ECS.12,ECS clusters should use Container Insights,This control checks if ECS clusters use Container Insights. This control fails if Container Insights are not set up for a cluster.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/ECS.12/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/ecs-controls.html#ecs-12,Identify > Logging,AWS::ECS::Cluster,ecs-container-insights-enabled,Change triggered,"To use Container Insights, see Updating a service in the Amazon CloudWatch User Guide."
ECS.13,ECS services should be tagged,"This control checks whether an Amazon ECS service has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the service doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the service isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/ECS.13/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/ecs-controls.html#ecs-13,Identify > Inventory > Tagging,AWS::ECS::Service,tagged-ecs-service (custom Security Hub rule),Change triggered,"To add tags to an ECS service, see Tagging your Amazon ECS resources in the Amazon Elastic Container Service Developer Guide."
ECS.14,ECS clusters should be tagged,"This control checks whether an Amazon ECS cluster has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the cluster doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the cluster isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/ECS.14/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/ecs-controls.html#ecs-14,Identify > Inventory > Tagging,AWS::ECS::Cluster,tagged-ecs-cluster (custom Security Hub rule),Change triggered,"To add tags to an ECS cluster, see Tagging your Amazon ECS resources in the Amazon Elastic Container Service Developer Guide."
ECS.15,ECS task definitions should be tagged,"This control checks whether an Amazon ECS task definition has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the task definition doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the task definition isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/ECS.15/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/ecs-controls.html#ecs-15,Identify > Inventory > Tagging,AWS::ECS::TaskDefinition,tagged-ecs-taskdefinition (custom Security Hub rule),Change triggered,"To add tags to an ECS task definition, see Tagging your Amazon ECS resources in the Amazon Elastic Container Service Developer Guide."
ECS.16,ECS task sets should not automatically assign public IP addresses,This control checks whether an Amazon ECS task set is configured to automatically assign public IP addresses. The control fails if 'AssignPublicIP' is set to 'ENABLED'.,HIGH,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/ECS.16/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/ecs-controls.html#ecs-16,Protect > Secure network configuration > Resources not publicly accessible,AWS::ECS::TaskSet,ecs-taskset-assign-public-ip-disabled (custom Security Hub rule),Change triggered,"To update an ECS task set so that it doesn't use a public IP address, see Updating an Amazon ECS task definition using the console in the Amazon Elastic Container Service Developer Guide."
EFS.1,Elastic File System should be configured to encrypt file data at-rest using AWS KMS,This AWS control checks whether Amazon Elastic File System (Amazon EFS) is configured to encrypt the file data using AWS Key Management Service (AWS KMS). The check will fail if the encrypted key is set to false on DescribeFileSystems or if the KmsKeyId key on DescribeFileSystems does not match the KmsKeyId parameter.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EFS.1/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, CIS AWS Foundations Benchmark v3.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/efs-controls.html#efs-1,Protect > Data Protection > Encryption of data-at-rest,AWS::EFS::FileSystem,efs-encrypted-check,Periodic,"For details on how to encrypt a new Amazon EFS file system, see Encrypting data at rest in the Amazon Elastic File System User Guide."
EFS.2,Amazon EFS volumes should be in backup plans,This control checks whether Amazon Elastic File System (Amazon EFS) file systems are added to the backup plans in AWS Backup. The control fails if EFS file systems are not included in the backup plans.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EFS.2/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/efs-controls.html#efs-2,Recover > Resilience > Backup,AWS::EFS::FileSystem,efs-in-backup-plan,Periodic,"To enable automatic backups for an existing Amazon EFS file system, see Getting started 4: Create Amazon EFS automatic backups in the AWS Backup Developer Guide."
EFS.3,EFS access points should enforce a root directory,This control checks if Amazon Elastic File System (Amazon EFS) access points are configured to enforce a root directory. This control fails if the value of 'Path' is set to '/' (default root directory of the file system).,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EFS.3/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/efs-controls.html#efs-3,Protect > Secure access management,AWS::EFS::AccessPoint,efs-access-point-enforce-root-directory,Change triggered,"For instructions on how to enforce a root directory for an Amazon EFS access point, see Enforcing a root directory with an access point in the Amazon Elastic File System User Guide."
EFS.4,EFS access points should enforce a user identity,This control checks whether Amazon Elastic File System (Amazon EFS) access points are configured to enforce a user identity. This control fails if ‘PosixUser’ is not defined under ‘configuration’ or if parameters are provided and there is no match in the corresponding parameter.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EFS.4/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/efs-controls.html#efs-4,Protect > Secure access management,AWS::EFS::AccessPoint,efs-access-point-enforce-user-identity,Change triggered,"To enforce a user identity for an Amazon EFS access point, see Enforcing a user identity using an access point in the Amazon Elastic File System User Guide."
EFS.5,EFS access points should be tagged,"This control checks whether an Amazon EFS access point has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the access point doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the access point isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EFS.5/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/efs-controls.html#efs-5,Identify > Inventory > Tagging,AWS::EFS::AccessPoint,tagged-efs-accesspoint (custom Security Hub rule),Change triggered,"To add tags to an EFS access point, see Tagging Amazon EFS resources in the Amazon Elastic File System User Guide."
EFS.6,EFS mount targets should not be associated with a public subnet,This control checks whether an Amazon EFS mount target is associated with a private subnet. The control fails if the mount target is associated with a public subnet.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EFS.6/remediation,,1,AWS Foundational Security Best Practices v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/efs-controls.html#efs-6,Protect > Secure network configuration > Resources not publicly accessible,AWS::EFS::FileSystem,efs-mount-target-public-accessible,Periodic,"You can't change the association between an EFS mount target and a subnet after creating the mount target. To associate an existing mount target with a different subnet, you must create a new mount target in a private subnet and then remove the old mount target. For information about managing mount targets, see Creating and managing mount targets and security groups in the Amazon Elastic File System User Guide."
EFS.7,EFS file systems should have automatic backups enabled,This control checks whether an Amazon EFS file system has automatic backups enabled. This control fails if the EFS file system doesn't have automatic backups enabled.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EFS.7/remediation,,1,AWS Foundational Security Best Practices v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/efs-controls.html#efs-7,Recover > Resilience > Backups enabled,AWS::EFS::FileSystem,efs-automatic-backups-enabled,Change triggered,"For information about using AWS Backup for EFS file systems, see Backing up EFS file systems in the Amazon Elastic File System User Guide"
EFS.8,EFS file systems should be encrypted at rest,"This control checks whether an Amazon EFS file system encrypts data with AWS Key Management Service (AWS KMS). The control fails if a file system isn't encrypted. Optionally, you can include the kmsKeyArns parameter to check if a file system is encrypted with specified KMS keys.",MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EFS.8/remediation,,1,AWS Foundational Security Best Practices v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/efs-controls.html#efs-8,Protect > Data Protection > Encryption of data-at-rest,AWS::EFS::FileSystem,efs-filesystem-ct-encrypted,Change triggered,"To enable encryption at rest for a new EFS file system, see Encrypting data at rest in the Amazon Elastic File System User Guide."
EKS.1,EKS cluster endpoints should not be publicly accessible,This control checks whether an Amazon EKS cluster endpoint is publicly accessible. The control fails if an EKS cluster has an endpoint that is publicly accessible.,HIGH,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EKS.1/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/eks-controls.html#eks-1,Protect > Secure network configuration > Resources not publicly accessible,AWS::EKS::Cluster,eks-endpoint-no-public-access,Periodic,"To modify endpoint access for an existing EKS cluster, see Modifying cluster endpoint access in the Amazon EKS User Guide. You can set up endpoint access for a new EKS cluster when creating it. For instructions on creating a new Amazon EKS cluster, see Creating an Amazon EKS cluster in the Amazon EKS User Guide."
EKS.2,EKS clusters should run on a supported Kubernetes version,This control checks whether an EKS cluster is running on a supported Kubernetes version. The control fails if the EKS cluster is running on an unsupported version.,HIGH,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EKS.2/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/eks-controls.html#eks-2,"Identify > Vulnerability, patch, and version management",AWS::EKS::Cluster,eks-cluster-supported-version,Change triggered,"To update an EKS cluster, Updating an Amazon EKS cluster Kubernetes version in the Amazon EKS User Guide."
EKS.3,EKS clusters should use encrypted Kubernetes secrets,This control checks whether an Amazon EKS cluster uses encrypted Kubernetes secrets. The control fails if the cluster's Kubernetes secrets aren't encrypted.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EKS.3/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/eks-controls.html#eks-3,Protect > Data Protection > Encryption of data-at-rest,AWS::EKS::Cluster,eks-cluster-secrets-encrypted,Periodic,"To enable secrets encryption on an EKS cluster, see Enabling secret encryption on an existing cluster in the Amazon EKS User Guide."
EKS.6,EKS clusters should be tagged,"This control checks whether an Amazon EKS cluster has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the cluster doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the cluster isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EKS.6/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/eks-controls.html#eks-6,Identify > Inventory > Tagging,AWS::EKS::Cluster,tagged-eks-cluster (custom Security Hub rule),Change triggered,"To add tags to an EKS cluster, see Tagging your Amazon EKS resources in the Amazon EKS User Guide."
EKS.7,EKS identity provider configurations should be tagged,"This control checks whether an Amazon EKS identity provider configuration has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the identity provider configuration doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the identity provider configuration isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EKS.7/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/eks-controls.html#eks-7,Identify > Inventory > Tagging,AWS::EKS::IdentityProviderConfig,tagged-eks-identityproviderconfig (custom Security Hub rule),Change triggered,"To add tags to an EKS identity provider configurations, see Tagging your Amazon EKS resources in the Amazon EKS User Guide."
EKS.8,EKS clusters should have audit logging enabled,This control checks whether an Amazon EKS cluster has audit logging enabled. The control fails if audit logging isn't enabled for the cluster.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EKS.8/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/eks-controls.html#eks-8,Identify > Logging,AWS::EKS::Cluster,eks-cluster-log-enabled,Change triggered,"To enable audit logs for your EKS cluster, see Enabling and disabling control plane logs in the Amazon EKS User Guide."
ELB.1,Application Load Balancer should be configured to redirect all HTTP requests to HTTPS,This AWS control checks whether HTTP to HTTPS redirection is configured on all HTTP listeners of Application Load Balancers. The control will fail if one or more HTTP listeners of Application Load Balancers do not have HTTP to HTTPS redirection configured.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/ELB.1/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v3.2.1",https://docs.aws.amazon.com/securityhub/latest/userguide/elb-controls.html#elb-1,Detect > Detection services,AWS::ElasticLoadBalancingV2::LoadBalancer,alb-http-to-https-redirection-check,Periodic,"To redirect HTTP requests to HTTPS, you must add an Application Load Balancer listener rule or edit an existing rule. For instructions on adding a new rule, see Add a rule in the User Guide for Application Load Balancers. For Protocol : Port, choose HTTP, and then enter 80. For Add action, Redirect to, choose HTTPS, and then enter 443. For instructions on editing an existing rule, see Edit a rule in the User Guide for Application Load Balancers. For Protocol : Port, choose HTTP, and then enter 80. For Add action, Redirect to, choose HTTPS, and then enter 443."
ELB.2,Classic Load Balancers with SSL/HTTPS listeners should use a certificate provided by AWS Certificate Manager,This control checks whether a Classic Load Balancer uses HTTPS/SSL certificates provided by AWS Certificate Manager. The control fails if a Classic Load Balancer that is configured with an HTTPS/SSL listener does not use a certificate provided by AWS Certificate Manager.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/ELB.2/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/elb-controls.html#elb-2,Protect > Data Protection > Encryption of data-in-transit,AWS::ElasticLoadBalancing::LoadBalancer,elb-acm-certificate-required,Change triggered,"For information about how to associate an ACM SSL/TLS certificate with a Classic Load Balancer, see the AWS Knowledge Center article How can I associate an ACM SSL/TLS certificate with a Classic, Application, or Network Load Balancer?"
ELB.3,Classic Load Balancer listeners should be configured with HTTPS or TLS termination,"This control checks whether your Classic Load Balancer listeners are configured with HTTPS or TLS protocol for front-end (client to load balancer) connections. The control is applicable if a Classic Load Balancer has listeners. If your Classic Load Balancer does not have a listener configured, then the control does not report any findings.",MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/ELB.3/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/elb-controls.html#elb-3,Protect > Data Protection > Encryption of data-in-transit,AWS::ElasticLoadBalancing::LoadBalancer,elb-tls-https-listeners-only,Change triggered,"To remediate this issue, update your listeners to use the TLS or HTTPS protocol. To change all noncompliant listeners to TLS/HTTPS listenersOpen the Amazon EC2 console at https://console.aws.amazon.com/ec2/. In the navigation pane, under Load Balancing, choose Load Balancers.Select your Classic Load Balancer. On the Listeners tab, choose Edit. For all listeners where Load Balancer Protocol is not set to HTTPS or SSL, change the setting to HTTPS or SSL. For all modified listeners, on the Certificates tab, choose Change default. For ACM and IAM certificates, select a certificate. Choose Save as default. After you update all of the listeners, choose Save."
ELB.4,Application load balancer should be configured to drop invalid http headers,"This control evaluates AWS Application Load Balancers (ALB) to ensure they are configured to drop invalid http headers. By default, ALBs are not configured to drop invalid http header values. This control evaluates all ALBs fails if the attribute value of routing.http.drop_invalid_header_fields.enabled is set to false.",MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/ELB.4/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/elb-controls.html#elb-4,Protect > Network Security,AWS::ElasticLoadBalancingV2::LoadBalancer,alb-http-drop-invalid-header-enabled,Change triggered,"To remediate this issue, configure your load balancer to drop invalid header fields. To configure the load balancer to drop invalid header fieldsOpen the Amazon EC2 console at https://console.aws.amazon.com/ec2/. In the navigation pane, choose Load balancers. Choose an Application Load Balancer. From Actions, choose Edit attributes. Under Drop Invalid Header Fields, choose Enable. Choose Save."
ELB.5,Application and Classic Load Balancers logging should be enabled,This control checks whether the Application Load Balancer and the Classic Load Balancer have logging enabled. The control fails if the access_logs.s3.enabled is false.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/ELB.5/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/elb-controls.html#elb-5,Identify > Logging,AWS::ElasticLoadBalancing::LoadBalancer,elb-logging-enabled,Change triggered,"To enable access logs, see Step 3: Configure access logs in the User Guide for Application Load Balancers."
ELB.6,"Application, Gateway, and Network Load Balancers should have deletion protection enabled","This control checks whether Application, Gateway, and Network Load Balancers have deletion protection enabled. The control fails if deletion protection is disabled.",MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/ELB.6/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/elb-controls.html#elb-6,Recover > Resilience > High availability,AWS::ElasticLoadBalancingV2::LoadBalancer,elb-deletion-protection-enabled,Change triggered,"To prevent your load balancer from being deleted accidentally, you can enable deletion protection. By default, deletion protection is disabled for your load balancer. If you enable deletion protection for your load balancer, you must disable delete protection before you can delete the load balancer. To enable deletion protection for an Application Load Balancer, see Deletion protection in the User Guide for Application Load Balancers. To enable deletion protection for a Gateway Load Balancer, see Deletion protection in the User Guide for Gateway Load Balancers. To enable deletion protection for a Network Load Balancer, see Deletion protection in the User Guide for Network Load Balancers."
ELB.7,Classic Load Balancers should have connection draining enabled,This control checks whether AWS Classic Load Balancers have connection draining enabled.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/ELB.7/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/elb-controls.html#elb-7,Recover > Resilience,AWS::ElasticLoadBalancing::LoadBalancer,elb-connection-draining-enabled (custom Security Hub rule),Change triggered,"To enable connection draining on Classic Load Balancers, see Configure connection draining for your Classic Load Balancer in User Guide for Classic Load Balancers."
ELB.8,Classic Load Balancers with SSL listeners should use a predefined security policy that has strong configuration,This control checks whether your Classic Load Balancer SSL listeners use the predefined policy ELBSecurityPolicy-TLS-1-2-2017-01. The control fails if the Classic Load Balancer SSL listeners do not use the predefined policy ELBSecurityPolicy-TLS-1-2-2017-01.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/ELB.8/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/elb-controls.html#elb-8,Protect > Data Protection > Encryption of data-in-transit,AWS::ElasticLoadBalancing::LoadBalancer,elb-predefined-security-policy-ssl-check,Change triggered,"For information on how to use the predefined security policy ELBSecurityPolicy-TLS-1-2-2017-01 with a Classic Load Balancer, see Configure security settings in User Guide for Classic Load Balancers."
ELB.9,Classic Load Balancers should have cross-zone load balancing enabled,This control checks whether cross-zone load balancing is enabled for Classic Load Balancers. This control fails if cross-zone load balancing is not enabled for a Classic Load Balancer.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/ELB.9/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/elb-controls.html#elb-9,Recover > Resilience > High availability,AWS::ElasticLoadBalancing::LoadBalancer,elb-cross-zone-load-balancing-enabled,Change triggered,"To enable cross-zone load balancing in a Classic Load Balancer, see Enable cross-zone load balancing in the User Guide for Classic Load Balancers."
ELB.10,Classic Load Balancer should span multiple Availability Zones,"This control checks whether a Classic Load Balancer has been configured to span at least the specified number of Availability Zones (AZs). The control fails if the Classic Load Balancer does not span at least the specified number of AZs. Unless you provide a custom parameter value for the minimum number of AZs, Security Hub uses a default value of two AZs.",MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/ELB.10/remediation,"Parameter: minAvailabilityZones
Description: Minimum number of Availability Zones
Type: Enum
Default Value: 2
Min: N/A
Max: N/A
---
",2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/elb-controls.html#elb-10,Recover > Resilience > High availability,AWS::ElasticLoadBalancing::LoadBalancer,clb-multiple-az,Change triggered,"To add Availability Zones to a Classic Load Balancer, see Add or remove subnets for your Classic Load Balancer in the User Guide for Classic Load Balancers."
ELB.12,Application Load Balancer should be configured with defensive or strictest desync mitigation mode,This control checks whether the Application Load Balancer is configured with defensive or strictest de-sync mitigation mode. This control fails if the Application Load Balancer is not configured with defensive or strictest desync mitigation mode.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/ELB.12/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/elb-controls.html#elb-12,Protect > Data Protection > Data integrity,AWS::ElasticLoadBalancingV2::LoadBalancer,alb-desync-mode-check,Change triggered,"To update desync mitigation mode of an Application Load Balancer, see Desync mitigation mode in the User Guide for Application Load Balancers."
ELB.13,"Application, Network and Gateway Load Balancers should span multiple Availability Zones","This control checks whether an Elastic Load Balancer V2 (Application, Network, or Gateway Load Balancer) has registered instances from at least the specified number of Availability Zones (AZs). The control fails if an Elastic Load Balancer V2 doesn't have instances registered in at least the specified number of AZs. Unless you provide a custom parameter value for the minimum number of AZs, Security Hub uses a default value of two AZs.",MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/ELB.13/remediation,"Parameter: minAvailabilityZones
Description: Minimum number of Availability Zones
Type: Enum
Default Value: 2
Min: N/A
Max: N/A
---
",2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/elb-controls.html#elb-13,Recover > Resilience > High availability,AWS::ElasticLoadBalancingV2::LoadBalancer,elbv2-multiple-az,Change triggered,"To add an Availability Zone to an Application Load Balancer, see Availability Zones for your Application Load Balancer in the User Guide for Application Load Balancers. To add an Availability Zone to an Network Load Balancer, see Network Load Balancers in the User Guide for Network Load Balancers. To add an Availability Zone to a Gateway Load Balancer, see Create a Gateway Load Balancer in the User Guide for Gateway Load Balancers."
ELB.14,Classic Load Balancer should be configured with defensive or strictest desync mitigation mode,This control checks whether the Classic Load Balancer is configured with defensive or strictest desync mitigation mode. This control will fail if the Classic Load Balancer is not configured with defensive or strictest desync mitigation mode.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/ELB.14/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/elb-controls.html#elb-14,Protect > Data Protection > Data integrity,AWS::ElasticLoadBalancing::LoadBalancer,clb-desync-mode-check,Change triggered,"To update desync mitigation mode on a Classic Load Balancer, see Modify desync mitigation mode in the User Guide for Classic Load Balancers."
ELB.16,Application Load Balancers should be associated with an AWS WAF web ACL,This control checks whether Application Load Balancers are associated with an AWS WAF web ACL. The control fails if the Enabled field for the WAF configuration is set to false.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/ELB.16/remediation,,1,NIST Special Publication 800-53 Revision 5,https://docs.aws.amazon.com/securityhub/latest/userguide/elb-controls.html#elb-16,Protect > Protective services,AWS::ElasticLoadBalancingV2::LoadBalancer,alb-waf-enabled,Change triggered,"To associate an Application Load Balancer with a web ACL, see Associating or disassociating a web ACL with an AWS resource in the AWS WAF Developer Guide."
ELB.17,Application and Network Load Balancers with listeners should use recommended security policies,This control checks whether the HTTPS listener for an Application Load Balancer or the TLS listener for a Network Load Balancer is configured to encrypt data in transit by using a recommended security policy. The control fails if the HTTPS or TLS listener for a load balancer isn't configured to use a recommended security policy.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/ELB.17/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/elb-controls.html#elb-17,Protect > Data Protection > Encryption of data-in-transit,AWS::ElasticLoadBalancingV2::Listener,elbv2-predefined-security-policy-ssl-check,Change triggered,"For information about recommended security policies and how to update listeners, see the following sections of the Elastic Load Balancing User Guides: Security policies for Application Load Balancers, Security policies for Network Load Balancers, Update an HTTPS listener for your Application Load Balancer, and Update a listener for your Network Load Balancer."
EMR.1,Amazon EMR cluster primary nodes should not have public IP addresses,This control checks whether primary nodes on EMR clusters have public IP addresses.,HIGH,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EMR.1/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/emr-controls.html#emr-1,Protect > Secure network configuration,AWS::EMR::Cluster,emr-master-no-public-ip,Periodic,"During launch, you can control whether your instance in a default or nondefault subnet is assigned a public IPv4 address. By default, default subnets have this attribute set to true. Nondefault subnets have the IPv4 public addressing attribute set to false, unless it was created by the Amazon EC2 launch instance wizard. In that case, the attribute is set to true. After launch, you can't manually disassociate a public IPv4 address from your instance. To remediate a failed finding, you must launch a new cluster in a VPC with a private subnet that has the IPv4 public addressing attribute set to false. For instructions, see Launch clusters into a VPC in the Amazon EMR Management Guide."
EMR.2,Amazon EMR block public access setting should be enabled,This control checks whether your account is configured with Amazon EMR block public access. The control fails if the block public access setting is not enabled or if any port other than 22 is allowed.,CRITICAL,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EMR.2/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/emr-controls.html#emr-2,Protect > Secure access management > Resource not publicly accessible,AWS::::Account,emr-block-public-access,Periodic,"To configure block public access for Amazon EMR, see Using Amazon EMR block public access in the Amazon EMR Management Guide."
EMR.3,Amazon EMR security configurations should have encryption at rest enabled,This control checks whether an Amazon EMR security configuration has encryption at rest enabled. The control fails if the security configuration doesn't enable encryption at rest.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EMR.3/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/emr-controls.html#emr-3,Protect > Data Protection > Encryption of data-at-rest,AWS::EMR::SecurityConfiguration,emr-security-configuration-encryption-rest,Change triggered,"To enable encryption at rest in an Amazon EMR security configuration, see Configure data encryption in the Amazon EMR Management Guide."
EMR.4,Amazon EMR security configurations should have encryption in transit enabled,This control checks whether an Amazon EMR security configuration has encryption in transit enabled. The control fails if the security configuration doesn't enable encryption in transit.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EMR.4/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/emr-controls.html#emr-4,Protect > Data Protection > Encryption of data-in-transit,AWS::EMR::SecurityConfiguration,emr-security-configuration-encryption-transit,Change triggered,"To enable encryption in transit in an Amazon EMR security configuration, see Configure data encryption in the Amazon EMR Management Guide."
ES.1,Elasticsearch domains should have encryption at-rest enabled,This AWS control checks whether Elasticsearch domains have encryption at rest configuration enabled. This check fails if the EncryptionAtRestOptions field is not enabled.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/ES.1/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v3.2.1",https://docs.aws.amazon.com/securityhub/latest/userguide/es-controls.html#es-1,Protect > Data Protection > Encryption of data-at-rest,AWS::Elasticsearch::Domain,elasticsearch-encrypted-at-rest,Periodic,"To enable encryption at rest for new and existing Elasticsearch domains, see Enabling encryption of data at rest in the Amazon OpenSearch Service Developer Guide."
ES.2,Elasticsearch domains should not be publicly accessible,This control checks whether an Elasticsearch domain is publicly accessible. The control fails if an Elasticsearch domain is publicly accessible. It does not evaluate the VPC subnet routing configuration to determine public access.,CRITICAL,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/ES.2/remediation,,4,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v3.2.1, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/es-controls.html#es-2,"Protect > Secure network configuration >
    Resources within VPC",AWS::Elasticsearch::Domain,elasticsearch-in-vpc-only,Periodic,"If you create a domain with a public endpoint, you cannot later place it within a VPC. Instead, you must create a new domain and migrate your data. The reverse is also true. If you create a domain within a VPC, it cannot have a public endpoint. Instead, you must either create another domain or disable this control. See Launching your Amazon OpenSearch Service domains within a VPC in the Amazon OpenSearch Service Developer Guide."
ES.3,Elasticsearch domains should encrypt data sent between nodes,This control checks whether Elasticsearch domains have node-to-node encryption enabled.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/ES.3/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/es-controls.html#es-3,Protect > Data Protection > Encryption of data-in-transit,AWS::Elasticsearch::Domain,elasticsearch-node-to-node-encryption-check,Change triggered,"For information about enabling node-to-node encryption on new and existing domains, see Enabling node-to-node encryption in the Amazon OpenSearch Service Developer Guide."
ES.4,Elasticsearch domain error logging to CloudWatch Logs should be enabled,This control checks whether Elasticsearch domains are configured to send error logs to CloudWatch Logs.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/ES.4/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/es-controls.html#es-4,Identify - Logging,AWS::Elasticsearch::Domain,elasticsearch-logs-to-cloudwatch,Change triggered,"For information on how to enable log publishing, see Enabling log publishing (console) in the Amazon OpenSearch Service Developer Guide."
ES.5,Elasticsearch domains should have audit logging enabled,This control checks whether Elasticsearch domains have audit logging enabled. This control fails if an Elasticsearch domain does not have audit logging enabled.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/ES.5/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/es-controls.html#es-5,Identify > Logging,AWS::Elasticsearch::Domain,elasticsearch-audit-logging-enabled (custom Security Hub rule),Change triggered,"For detailed instructions on enabling audit logs, see Enabling audit logs in the Amazon OpenSearch Service Developer Guide."
ES.6,Elasticsearch domains should have at least three data nodes,This control checks whether Elasticsearch domains are configured with at least three data nodes and zoneAwarenessEnabled is true.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/ES.6/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/es-controls.html#es-6,Recover > Resilience > High availability,AWS::Elasticsearch::Domain,elasticsearch-data-node-fault-tolerance (custom Security Hub rule),Change triggered,"To modify the number of data nodes in an Elasticsearch domainOpen the Amazon OpenSearch Service console at https://console.aws.amazon.com/aos/. Under Domains, choose the name of the domain you want to edit. Choose Edit domain. Under Data nodes, set Number of nodes to a number greater than or equal to 3. For three Availability Zone deployments, set to a multiple of three to ensure equal distribution across Availability Zones. Choose Submit."
ES.7,Elasticsearch domains should be configured with at least three dedicated master nodes,This control checks whether Elasticsearch domains are configured with at least three dedicated master nodes. This control fails if dedicatedMasterEnabled is not true.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/ES.7/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/es-controls.html#es-7,Recover > Resilience > High availability,AWS::Elasticsearch::Domain,elasticsearch-primary-node-fault-tolerance (custom Security Hub rule),Change triggered,"To modify the number of dedicated primary nodes in an OpenSearch domainOpen the Amazon OpenSearch Service console at https://console.aws.amazon.com/aos/. Under Domains, choose the name of the domain you want to edit. Choose Edit domain. Under Dedicated master nodes, set Instance type to the desired instance type. Set Number of master nodes equal to three or greater. Choose Submit."
ES.8,Connections to Elasticsearch domains should be encrypted using the latest TLS security policy,This controls checks whether connections to an Elasticsearch domain are using the latest TLS security policy. The control fails if the Elasticsearch domain isn't using the latest supported policy or if HTTPs isn't enabled.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/ES.8/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/es-controls.html#es-8,Protect > Data Protection > Encryption of data-in-transit,AWS::Elasticsearch::Domain,elasticsearch-https-required (custom Security Hub rule),Change triggered,"To enable TLS encryption, use the UpdateDomainConfig API operation to configure the DomainEndpointOptions object. This sets the TLSSecurityPolicy."
ES.9,Elasticsearch domains should be tagged,"This control checks whether an Elasticsearch domain has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the topic doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the topic isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.
",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/ES.9/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/es-controls.html#es-9,Identify > Inventory > Tagging,AWS::Elasticsearch::Domain,tagged-elasticsearch-domain (custom Security Hub rule),Change triggered,"To add tags to an Elasticsearch domain, see Working with tags in the Amazon OpenSearch Service Developer Guide."
ElastiCache.1,ElastiCache (Redis OSS) clusters should have automatic backups enabled,"This control evaluates whether an Amazon ElastiCache (Redis OSS) cluster has automatic backups enabled. The control fails if the 'SnapshotRetentionLimit' for the Redis OSS cluster is less than the specified time period. Unless you provide a custom parameter value for the snapshot retention period, Security Hub uses a default value of 1 day.",HIGH,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/ElastiCache.1/remediation,"Parameter: snapshotRetentionPeriod
Description: Minimum snapshot retention period in days
Type: Integer
Default Value: 1
Min: 1
Max: 35
---
",2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/elasticache-controls.html#elasticache-1,Recover > Resilience > Backups enabled,AWS::ElastiCache::CacheCluster,elasticache-redis-cluster-automatic-backup-check,Periodic,"To schedule automatic backups on an ElastiCache (Redis OSS) cluster, see Scheduling automatic backups in the Amazon ElastiCache User Guide."
ElastiCache.2,ElastiCache clusters should have automatic minor version upgrades enabled,This control evaluates whether ElastiCache automatically applies minor version upgrades to a cache cluster. The control fails if the cache cluster doesn't have minor version upgrades automatically applied.,HIGH,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/ElastiCache.2/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/elasticache-controls.html#elasticache-2,"Identify > Vulnerability, patch, and version management",AWS::ElastiCache::CacheCluster,elasticache-auto-minor-version-upgrade-check,Periodic,"To automatically apply minor version upgrades to an existing ElastiCache cache cluster, see Version management for ElastiCache in the Amazon ElastiCache User Guide."
ElastiCache.3,ElastiCache replication groups should have automatic failover enabled,This control checks whether an ElastiCache replication group has automatic failover enabled. The control fails if automatic failover isn't enabled for an ElastiCache replication group.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/ElastiCache.3/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/elasticache-controls.html#elasticache-3,Recover > Resilience > High availability,AWS::ElastiCache::ReplicationGroup,elasticache-repl-grp-auto-failover-enabled,Periodic,"To enable automatic failover for an existing ElastiCache replication group,, see Modifying an ElastiCache cluster in the Amazon ElastiCache User Guide. If you use the ElastiCache console, set Auto failover to enabled."
ElastiCache.4,ElastiCache replication groups should be encrypted at rest,This control checks whether an ElastiCache replication group is encrypted at rest. The control fails if an ElastiCache replication group isn't encrypted at rest.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/ElastiCache.4/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/elasticache-controls.html#elasticache-4,Protect > Data Protection > Encryption of data-at-rest,AWS::ElastiCache::ReplicationGroup,elasticache-repl-grp-encrypted-at-rest,Periodic,"To configure at-rest encryption on an ElastiCache replication group, see Enabling at-rest encryption in the Amazon ElastiCache User Guide."
ElastiCache.5,ElastiCache replication groups should be encrypted in transit,This control checks whether an ElastiCache replication group is encrypted in transit. The control fails if an ElastiCache replication group isn't encrypted in transit.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/ElastiCache.5/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/elasticache-controls.html#elasticache-5,Protect > Data Protection > Encryption of data-in-transit,AWS::ElastiCache::ReplicationGroup,elasticache-repl-grp-encrypted-in-transit,Periodic,"To configure in-transit encryption on an ElastiCache replication group, see Enabling in-transit encryption in the Amazon ElastiCache User Guide."
ElastiCache.6,ElastiCache (Redis OSS) replication groups of earlier versions should have Redis OSS AUTH enabled,This control checks whether an ElastiCache (Redis OSS) replication group has Redis OSS AUTH enabled. The control fails if the Redis OSS version of the replication group nodes is below 6.0 and 'AuthToken' isn't in use.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/ElastiCache.6/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/elasticache-controls.html#elasticache-6,Protect > Secure access management,AWS::ElastiCache::ReplicationGroup,elasticache-repl-grp-redis-auth-enabled,Periodic,"To use Redis AUTH on an ElastiCache (Redis OSS) replication group, see Modifying the AUTH token on an existing ElastiCache (Redis OSS) cluster in the Amazon ElastiCache User Guide."
ElastiCache.7,ElastiCache clusters should not use the default subnet group,This control checks whether an ElastiCache cluster is configured with a custom subnet group. The control fails if an ElastiCache cluster is using a default subnet group.,HIGH,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/ElastiCache.7/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/elasticache-controls.html#elasticache-7,Protect > Secure network configuration,AWS::ElastiCache::CacheCluster,elasticache-subnet-group-check,Periodic,"To create a new subnet group for an ElastiCache cluster, see Creating a subnet group in the Amazon ElastiCache User Guide."
ElasticBeanstalk.1,Elastic Beanstalk environments should have enhanced health reporting enabled,This control checks whether enhanced health reporting is enabled for your AWS Elastic Beanstalk environments.,LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/ElasticBeanstalk.1/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/elasticbeanstalk-controls.html#elasticbeanstalk-1,"Detect > Detection services > Application
            monitoring",AWS::ElasticBeanstalk::Environment,beanstalk-enhanced-health-reporting-enabled,Change triggered,"For instructions on how to enable enhanced health reporting, see Enabling enhanced health reporting using the Elastic Beanstalk console in the AWS Elastic Beanstalk Developer Guide."
ElasticBeanstalk.2,Elastic Beanstalk managed platform updates should be enabled,"This control checks whether managed platform updates are enabled for an Elastic Beanstalk environment. The control fails if no managed platform updates are enabled. By default, the control passes if any type of platform update is enabled. Optionally, you can provide a custom parameter value to require a specific update level.",HIGH,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/ElasticBeanstalk.2/remediation,"Parameter: UpdateLevel
Description: Version update level
Type: Enum
Default Value: N/A
Min: N/A
Max: N/A
---
",3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/elasticbeanstalk-controls.html#elasticbeanstalk-2,"Identify > Vulnerability, patch, and version management",AWS::ElasticBeanstalk::Environment,elastic-beanstalk-managed-updates-enabled,Change triggered,"To enable managed platform updates, see To configure managed platform updates under Managed platform updates in the AWS Elastic Beanstalk Developer Guide."
ElasticBeanstalk.3,Elastic Beanstalk should stream logs to CloudWatch,"This control checks whether an Elastic Beanstalk environment is configured to send logs to CloudWatch Logs. The control fails if an Elastic Beanstalk environment isn't configured to send logs to CloudWatch Logs. Optionally, you can provide a custom value for the 'RetentionInDays' parameter if you want the control to pass only if logs are retained for the specified number of days before expiration.",HIGH,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/ElasticBeanstalk.3/remediation,"Parameter: RetentionInDays
Description: Number of days to keep log events before expiration
Type: Enum
Default Value: N/A
Min: N/A
Max: N/A
---
",2,"AWS Foundational Security Best Practices v1.0.0, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/elasticbeanstalk-controls.html#elasticbeanstalk-3,Identify > Logging,AWS::ElasticBeanstalk::Environment,elastic-beanstalk-logs-to-cloudwatch,Change triggered,"To integrate Elastic Beanstalk with CloudWatch Logs, see Streaming instance logs to CloudWatch Logs in the AWS Elastic Beanstalk Developer Guide."
EventBridge.2,EventBridge event buses should be tagged,"This control checks whether an Amazon EventBridge event bus has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the event bus doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the event bus isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EventBridge.2/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/eventbridge-controls.html#eventbridge-2,Identify > Inventory > Tagging,AWS::Events::EventBus,tagged-events-eventbus (custom Security Hub rule),Change triggered,"To add tags to an EventBridge event bus, see Amazon EventBridge tags in the Amazon EventBridge User Guide."
EventBridge.3,EventBridge custom event buses should have a resource-based policy attached,This control checks if an Amazon EventBridge custom event bus has a resource policy attached. This control fails if the custom event bus doesn't have a resource policy.,LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EventBridge.3/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/eventbridge-controls.html#eventbridge-3,Protect > Secure access management > Resource not publicly accessible,AWS::Events::EventBus,custom-eventbus-policy-attached,Change triggered,"To attach a resource-based policy to an EventBridge custom event bus, see Using resource-based policies for Amazon EventBridge in the Amazon EventBridge User Guide."
EventBridge.4,EventBridge global endpoints should have event replication enabled,This control checks if event replication is enabled for an Amazon EventBridge global endpoint. The control fails if event replication isn't enabled for a global endpoint.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/EventBridge.4/remediation,,1,NIST Special Publication 800-53 Revision 5,https://docs.aws.amazon.com/securityhub/latest/userguide/eventbridge-controls.html#eventbridge-4,Recover > Resilience > High availability,AWS::Events::Endpoint,global-endpoint-event-replication-enabled,Change triggered,"To enable event replication for EventBridge global endpoints, see Create a global endpoint in the Amazon EventBridge User Guide. For Event replication, select Event replication enabled."
FSx.1,FSx for OpenZFS file systems should be configured to copy tags to backups and volumes,This control checks if an Amazon FSx for OpenZFS file system is configured to copy tags to backups and volumes. The control fails if the OpenZFS file system isn't configured to copy tags to backups and volumes.,LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/FSx.1/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/fsx-controls.html#fsx-1,Identify > Inventory > Tagging,AWS::FSx::FileSystem,fsx-openzfs-copy-tags-enabled,Periodic,"For information about configuring an FSx for OpenZFS file system to copy tags to backups and volumes, see Updating a file system in the Amazon FSx for OpenZFS User Guide."
FSx.2,FSx for Lustre file systems should be configured to copy tags to backups,This control checks whether an Amazon FSx for Lustre file system is configured to copy tags to backups. This control fails if the Lustre file system isn't configured to copy tags to backups.,LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/FSx.2/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/fsx-controls.html#fsx-2,Identify > Inventory > Tagging,AWS::FSx::FileSystem,fsx-lustre-copy-tags-to-backups,Periodic,"For information about configuring an FSx for Lustre file system to copy tags to backups, see Copying backups within the same AWS account in the Amazon FSx for Lustre User Guide."
FraudDetector.1,Amazon Fraud Detector entity types should be tagged,"This control checks whether an Amazon Fraud Detector entity type has tags with the specific keys defined in the parameter requiredKeyTags. The control fails if the entity type doesn't have any tag keys or if it doesn't have all the keys specified in the parameter requiredKeyTags. If the parameter requiredKeyTags isn't provided, the control only checks for the existence of a tag key and fails if the entity type isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,UNAVAILABLE,https://docs.aws.amazon.com/console/securityhub/FraudDetector.1/remediation,"Parameter: requiredKeyTags
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/frauddetector-controls.html#frauddetector-1,Identify > Inventory > Tagging,AWS::FraudDetector::EntityType,frauddetector-entity-type-tagged,Change triggered,"To add tags to an Amazon Fraud Detector entity type (console)Open the Amazon Fraud Detector console at https://console.aws.amazon.com/frauddetector.In the navigation pane, choose Entities.Select an entity type from the list.In the entity type tags section, choose Manage tags.Choose Add new tag. Enter the key and value for the tag. Repeat for additional key-value pairs.When you are finished adding tags, choose Save."
FraudDetector.2,Amazon Fraud Detector labels should be tagged,"This control checks whether an Amazon Fraud Detector label has tags with the specific keys defined in the parameter requiredKeyTags. The control fails if the label doesn't have any tag keys or if it doesn't have all the keys specified in the parameter requiredKeyTags. If the parameter requiredKeyTags isn't provided, the control only checks for the existence of a tag key and fails if the label isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,UNAVAILABLE,https://docs.aws.amazon.com/console/securityhub/FraudDetector.2/remediation,"Parameter: requiredKeyTags
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/frauddetector-controls.html#frauddetector-2,Identify > Inventory > Tagging,AWS::FraudDetector::Label,frauddetector-label-tagged,Change triggered,"To add tags to an Amazon Fraud Detector label (console)Open the Amazon Fraud Detector console at https://console.aws.amazon.com/frauddetector.In the navigation pane, choose Labels.Select a label from the list.In the labels tags section, choose Manage tags.Choose Add new tag. Enter the key and value for the tag. Repeat for additional key-value pairs.When you are finished adding tags, choose Save."
FraudDetector.3,Amazon Fraud Detector outcomes should be tagged,"This control checks whether an Amazon Fraud Detector outcome has tags with the specific keys defined in the parameter requiredKeyTags. The control fails if the outcome doesn't have any tag keys or if it doesn't have all the keys specified in the parameter requiredKeyTags. If the parameter requiredKeyTags isn't provided, the control only checks for the existence of a tag key and fails if the outcome isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,UNAVAILABLE,https://docs.aws.amazon.com/console/securityhub/FraudDetector.3/remediation,"Parameter: requiredKeyTags
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/frauddetector-controls.html#frauddetector-3,Identify > Inventory > Tagging,AWS::FraudDetector::Outcome,frauddetector-outcome-tagged,Change triggered,"To add tags to an Amazon Fraud Detector outcome (console)Open the Amazon Fraud Detector console at https://console.aws.amazon.com/frauddetector.In the navigation pane, choose Outcomes.Select an outcome from the list.In the outcomes tags section, choose Manage tags.Choose Add new tag. Enter the key and value for the tag. Repeat for additional key-value pairs.When you are finished adding tags, choose Save."
FraudDetector.4,Amazon Fraud Detector variables should be tagged,"This control checks whether an Amazon Fraud Detector variable has tags with the specific keys defined in the parameter requiredKeyTags. The control fails if the variable doesn't have any tag keys or if it doesn't have all the keys specified in the parameter requiredKeyTags. If the parameter requiredKeyTags isn't provided, the control only checks for the existence of a tag key and fails if the variable isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,UNAVAILABLE,https://docs.aws.amazon.com/console/securityhub/FraudDetector.4/remediation,"Parameter: requiredKeyTags
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/frauddetector-controls.html#frauddetector-4,Identify > Inventory > Tagging,AWS::FraudDetector::Variable,frauddetector-variable-tagged,Change triggered,"To add tags to an Amazon Fraud Detector variable (console)Open the Amazon Fraud Detector console at https://console.aws.amazon.com/frauddetector.In the navigation pane, choose Variables.Select a variable from the list.In the variables tags section, choose Manage tags.Choose Add new tag. Enter the key and value for the tag. Repeat for additional key-value pairs.When you are finished adding tags, choose Save."
GlobalAccelerator.1,Global Accelerator accelerators should be tagged,"This control checks whether an AWS Global Accelerator accelerator has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the accelerator doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the accelerator isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,UNAVAILABLE,https://docs.aws.amazon.com/console/securityhub/GlobalAccelerator.1/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/globalaccelerator-controls.html#globalaccelerator-1,Identify > Inventory > Tagging,AWS::GlobalAccelerator::Accelerator,tagged-globalaccelerator-accelerator (custom Security Hub rule),Change triggered,"To add tags to an Global Accelerator global accelerator, see see Tagging in AWS Global Accelerator in the AWS Global Accelerator Developer Guide."
Glue.1,AWS Glue jobs should be tagged,"This control checks whether an AWS Glue job has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the job doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the job isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Glue.1/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/glue-controls.html#glue-1,Identify > Inventory > Tagging,AWS::Glue::Job,tagged-glue-job (custom Security Hub rule),Change triggered,"To add tags to a AWS Glue job, see AWS tags in AWS Glue in the AWS Glue User Guide."
Glue.3,AWS Glue machine learning transforms should be encrypted at rest,This control checks whether an AWS Glue machine learning transform is encrypted at rest. The control fails if the machine learning transform isn't encrypted at rest.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Glue.3/remediation,,1,AWS Foundational Security Best Practices v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/glue-controls.html#glue-3,Protect > Data Protection > Encryption of data-at-rest,AWS::Glue::MLTransform,glue-ml-transform-encrypted-at-rest,Change triggered,"To configure encryption for AWS Glue machine learning transforms, see Working with machine learning transforms in the AWS Glue User Guide."
Glue.4,AWS Glue Spark jobs should run on supported versions of AWS Glue,This control checks whether an AWS Glue for Spark job is configured to run on a supported version of AWS Glue. The control fails if the Spark job is configured to run on a version of AWS Glue that's earlier than the minimum supported version.,MEDIUM,UNAVAILABLE,https://docs.aws.amazon.com/console/securityhub/Glue.4/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/glue-controls.html#glue-4,"Identify > Vulnerability, patch, and version management",AWS::Glue::Job,glue-spark-job-supported-version,Change triggered,"For information about migrating a Spark job to a supported version of AWS Glue, see Migrating AWS Glue for Spark jobs in the AWS Glue User Guide."
GuardDuty.1,GuardDuty should be enabled,This AWS control checks whether Amazon GuardDuty is enabled in your AWS account and region.,HIGH,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/GuardDuty.1/remediation,,4,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v3.2.1, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/guardduty-controls.html#guardduty-1,Detect > Detection services,AWS::::Account,guardduty-enabled-centralized,Periodic,"To enable GuardDuty, see Getting started with GuardDuty in the Amazon GuardDuty User Guide."
GuardDuty.2,GuardDuty filters should be tagged,"This control checks whether an Amazon GuardDuty filter has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the filter doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the filter isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/GuardDuty.2/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/guardduty-controls.html#guardduty-2,Identify > Inventory > Tagging,AWS::GuardDuty::Filter,tagged-guardduty-filter (custom Security Hub rule),Change triggered,"To add tags to a GuardDuty filter, see TagResource in the Amazon GuardDuty API Reference."
GuardDuty.3,GuardDuty IPSets should be tagged,"This control checks whether an Amazon GuardDuty IPSet has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the IPSet doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the IPSet isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/GuardDuty.3/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/guardduty-controls.html#guardduty-3,Identify > Inventory > Tagging,AWS::GuardDuty::IPSet,tagged-guardduty-ipset (custom Security Hub rule),Change triggered,"To add tags to a GuardDuty IPSet, see TagResource in the Amazon GuardDuty API Reference."
GuardDuty.4,GuardDuty detectors should be tagged,"This control checks whether an Amazon GuardDuty detector has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the detector doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the detector isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/GuardDuty.4/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/guardduty-controls.html#guardduty-4,Identify > Inventory > Tagging,AWS::GuardDuty::Detector,tagged-guardduty-detector (custom Security Hub rule),Change triggered,"To add tags to a GuardDuty detector, see TagResource in the Amazon GuardDuty API Reference."
GuardDuty.5,GuardDuty EKS Audit Log Monitoring should be enabled,"This control checks whether GuardDuty EKS Audit Log Monitoring is enabled. For a standalone account, the control fails if GuardDuty EKS Audit Log Monitoring is disabled in the account. In a multi-account environment, the control fails if the delegated GuardDuty administrator account and all member accounts don't have EKS Audit Log Monitoring enabled.",HIGH,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/GuardDuty.5/remediation,,1,AWS Foundational Security Best Practices v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/guardduty-controls.html#guardduty-5,Detect > Detection services,AWS::GuardDuty::Detector,guardduty-eks-protection-audit-enabled,Periodic,"To enable GuardDuty EKS Audit Log Monitoring, see EKS Audit Log Monitoring in the Amazon GuardDuty User Guide."
GuardDuty.6,GuardDuty Lambda Protection should be enabled,"This control checks whether GuardDuty Lambda Protection is enabled. For a standalone account, the control fails if GuardDuty Lambda Protection is disabled in the account. In a multi-account environment, the control fails if the delegated GuardDuty administrator account and all member accounts don't have Lambda Protection enabled.",HIGH,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/GuardDuty.6/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/guardduty-controls.html#guardduty-6,Detect > Detection services,AWS::GuardDuty::Detector,guardduty-lambda-protection-enabled,Periodic,"To enable GuardDuty Lambda Protection, see Configuring Lambda Protection in the Amazon GuardDuty User Guide."
GuardDuty.7,GuardDuty EKS Runtime Monitoring should be enabled,"This control checks whether GuardDuty EKS Runtime Monitoring with automated agent management is enabled. For a standalone account, the control fails if GuardDuty EKS Runtime Monitoring with automated agent management is disabled in the account. In a multi-account environment, the control fails if the delegated GuardDuty administrator account and all member accounts don't have EKS Runtime Monitoring with automated agent management enabled.",MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/GuardDuty.7/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/guardduty-controls.html#guardduty-7,Detect > Detection Services,AWS::GuardDuty::Detector,guardduty-eks-protection-runtime-enabled,Periodic,"To enable EKS Runtime Monitoring with automated agent management, see Enabling GuardDuty Runtime Monitoring in the Amazon GuardDuty User Guide."
GuardDuty.8,GuardDuty Malware Protection for EC2 should be enabled,"This control checks whether GuardDuty Malware Protection for EC2 is enabled. For a standalone account, the control fails if GuardDuty Malware Protection for EC2 is disabled in the account. In a multi-account environment, the control fails if the delegated GuardDuty administrator account and all member accounts don't have Malware Protection for EC2 enabled.",HIGH,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/GuardDuty.8/remediation,,1,AWS Foundational Security Best Practices v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/guardduty-controls.html#guardduty-8,Detect > Detection services,AWS::GuardDuty::Detector,guardduty-malware-protection-enabled,Periodic,"To enable GuardDuty Malware Protection for EC2, see Configuring GuardDuty-initiated malware scan in the Amazon GuardDuty User Guide."
GuardDuty.9,GuardDuty RDS Protection should be enabled,"This control checks whether GuardDuty RDS Protection is enabled. For a standalone account, the control fails if GuardDuty RDS Protection is disabled in the account. In a multi-account environment, the control fails if the delegated GuardDuty administrator account and all member accounts don't have RDS Protection enabled.",HIGH,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/GuardDuty.9/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/guardduty-controls.html#guardduty-9,Detect > Detection services,AWS::GuardDuty::Detector,guardduty-rds-protection-enabled,Periodic,"To enable GuardDuty RDS Protection, see GuardDuty RDS Protection in the Amazon GuardDuty User Guide."
GuardDuty.10,GuardDuty S3 Protection should be enabled,"This control checks whether GuardDuty S3 Protection is enabled. For a standalone account, the control fails if GuardDuty S3 Protection is disabled in the account. In a multi-account environment, the control fails if the delegated GuardDuty administrator account and all member accounts don't have S3 Protection enabled.",HIGH,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/GuardDuty.10/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/guardduty-controls.html#guardduty-10,Detect > Detection services,AWS::GuardDuty::Detector,guardduty-s3-protection-enabled,Periodic,"To enable GuardDuty S3 Protection, see Amazon S3 Protection in Amazon GuardDuty in the Amazon GuardDuty User Guide."
GuardDuty.11,GuardDuty Runtime Monitoring should be enabled,"This control checks whether Runtime Monitoring is enabled in Amazon GuardDuty. For a standalone account, the control fails if GuardDuty Runtime Monitoring is disabled for the account. In a multi-account environment, the control fails if GuardDuty Runtime Monitoring is disabled for the delegated GuardDuty administrator account and all member accounts.",HIGH,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/GuardDuty.11/remediation,,1,AWS Foundational Security Best Practices v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/guardduty-controls.html#guardduty-11,Detect > Detection Services,AWS::GuardDuty::Detector,guardduty-runtime-monitoring-enabled,Periodic,"For information about configuring and enabling GuardDuty Runtime Monitoring, see GuardDuty Runtime Monitoring and Enabling GuardDuty Runtime Monitoring in the Amazon GuardDuty User Guide."
GuardDuty.12,GuardDuty ECS Runtime Monitoring should be enabled,"This control checks whether the Amazon GuardDuty automated security agent is enabled for runtime monitoring of Amazon ECS clusters on AWS Fargate. For a standalone account, the control fails if the security agent is disabled for the account. In a multi-account environment, the control fails if the security agent is disabled for the delegated GuardDuty administrator account and all member accounts.",MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/GuardDuty.12/remediation,,1,AWS Foundational Security Best Practices v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/guardduty-controls.html#guardduty-12,Detect > Detection Services,AWS::GuardDuty::Detector,guardduty-ecs-protection-runtime-enabled,Periodic,"To enable and manage the security agent for GuardDuty Runtime Monitoring of ECS-Fargate resources, you must use GuardDuty directly. You can't enable or manage it manually for ECS-Fargate resources. For information about enabling and managing the security agent, see Prerequisites for AWS Fargate (Amazon ECS only) support and Managing the automated security agent for AWS Fargate (Amazon ECS only) in the Amazon GuardDuty User Guide."
GuardDuty.13,GuardDuty EC2 Runtime Monitoring should be enabled,"This control checks whether the Amazon GuardDuty automated security agent is enabled for runtime monitoring of Amazon EC2 instances. For a standalone account, the control fails if the security agent is disabled for the account. In a multi-account environment, the control fails if the security agent is disabled for the delegated GuardDuty administrator account and all member accounts.",MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/GuardDuty.13/remediation,,1,AWS Foundational Security Best Practices v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/guardduty-controls.html#guardduty-13,Detect > Detection Services,AWS::GuardDuty::Detector,guardduty-ec2-protection-runtime-enabled,Periodic,"For information about configuring and managing the automated security agent for GuardDuty Runtime Monitoring of EC2 instances, see Prerequisites for Amazon EC2 instance support and Enabling the automated security agent for Amazon EC2 instances in the Amazon GuardDuty User Guide."
IAM.1,"IAM policies should not allow full ""*"" administrative privileges","This AWS control checks whether the default version of AWS Identity and Access Management (IAM) policies (also known as customer managed policies) do not have administrator access with a statement that has ""Effect"": ""Allow"" with ""Action"": ""*"" over ""Resource"": ""*"". It only checks for the Customer Managed Policies that you created, but not inline and AWS Managed Policies.",HIGH,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/IAM.1/remediation,,5,"AWS Foundational Security Best Practices v1.0.0, CIS AWS Foundations Benchmark v1.2.0, CIS AWS Foundations Benchmark v1.4.0, NIST Special Publication 800-53 Revision 5, PCI DSS v3.2.1",https://docs.aws.amazon.com/securityhub/latest/userguide/iam-controls.html#iam-1,Protect > Secure access management,AWS::IAM::Policy,iam-policy-no-statements-with-admin-access,Change triggered,"To modify your IAM policies so that they do not allow full ""*"" administrative privileges, see Editing IAM policies in the IAM User Guide."
IAM.2,IAM users should not have IAM policies attached,"This AWS control checks that none of your IAM users have policies attached. Instead, IAM users must inherit permissions from IAM groups or roles.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/IAM.2/remediation,,5,"AWS Foundational Security Best Practices v1.0.0, CIS AWS Foundations Benchmark v1.2.0, CIS AWS Foundations Benchmark v3.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v3.2.1",https://docs.aws.amazon.com/securityhub/latest/userguide/iam-controls.html#iam-2,Protect > Secure access management,AWS::IAM::User,iam-user-no-policies-check,Change triggered,"To resolve this issue, create an IAM group, and attach the policy to the group. Then, add the users to the group. The policy is applied to each user in the group. To remove a policy attached directly to a user, see Adding and removing IAM identity permissions in the IAM User Guide."
IAM.3,IAM users' access keys should be rotated every 90 days or less,This AWS control checks whether the active access keys are rotated within 90 days.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/IAM.3/remediation,,6,"AWS Foundational Security Best Practices v1.0.0, CIS AWS Foundations Benchmark v1.2.0, CIS AWS Foundations Benchmark v1.4.0, CIS AWS Foundations Benchmark v3.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/iam-controls.html#iam-3,Protect > Secure access management,AWS::IAM::User,access-keys-rotated,Periodic,"To rotate access keys that are older than 90 days, see Rotating access keys in the IAM User Guide. Follow the instructions for any user with an Access key age greater than 90 days."
IAM.4,IAM root user access key should not exist,This AWS control checks whether the root user access key is available.,CRITICAL,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/IAM.4/remediation,,6,"AWS Foundational Security Best Practices v1.0.0, CIS AWS Foundations Benchmark v1.2.0, CIS AWS Foundations Benchmark v1.4.0, CIS AWS Foundations Benchmark v3.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v3.2.1",https://docs.aws.amazon.com/securityhub/latest/userguide/iam-controls.html#iam-4,Protect > Secure access management,AWS::::Account,iam-root-access-key-check,Periodic,"To delete the root user access key, see Deleting access keys for the root user in the IAM User Guide. To delete the root user access keys from an AWS account in AWS GovCloud (US), see Deleting my AWS GovCloud (US) account root user access keys in the AWS GovCloud (US) User Guide."
IAM.5,MFA should be enabled for all IAM users that have a console password,This AWS control checks whether AWS Multi-Factor Authentication (MFA) is enabled for all AWS Identity and Access Management (IAM) users that use a console password.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/IAM.5/remediation,,6,"AWS Foundational Security Best Practices v1.0.0, CIS AWS Foundations Benchmark v1.2.0, CIS AWS Foundations Benchmark v1.4.0, CIS AWS Foundations Benchmark v3.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/iam-controls.html#iam-5,Protect > Secure access management,AWS::IAM::User,mfa-enabled-for-iam-console-access,Periodic,"To add MFA for IAM users, see Using multi-factor authentication (MFA) in AWS in the IAM User Guide. We are offering a free MFA security key to eligible customers. See if you qualify, and order your free key."
IAM.6,Hardware MFA should be enabled for the root user,This AWS control checks whether your AWS account is enabled to use a hardware multi-factor authentication (MFA) device to sign in with root user credentials.,CRITICAL,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/IAM.6/remediation,,7,"AWS Foundational Security Best Practices v1.0.0, CIS AWS Foundations Benchmark v1.2.0, CIS AWS Foundations Benchmark v1.4.0, CIS AWS Foundations Benchmark v3.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v3.2.1, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/iam-controls.html#iam-6,Protect > Secure access management,AWS::::Account,root-account-hardware-mfa-enabled,Periodic,"To add a hardware MFA device for the root user, see Enable a hardware MFA device for the AWS account root user (console) in the IAM User Guide. We are offering a free MFA security key to eligible customers. See if you qualify, and order your free key."
IAM.7,Password policies for IAM users should have strong configurations,"This control checks whether the account password policy for IAM users uses strong configurations. The control fails if the password policy doesn't use strong configurations. Unless you provide custom parameter values, Security Hub uses the default values mentioned in the preceding table. The 'PasswordReusePrevention' and 'MaxPasswordAge' parameters have no default value, so if you exclude these parameters, Security Hub ignores number of password rotations and password age when evaluating this control.",MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/IAM.7/remediation,"Parameter: RequireUppercaseCharacters
Description: Require at least one uppercase character in password
Type: Boolean
Default Value: True
Min: N/A
Max: N/A
---
Parameter: RequireLowercaseCharacters
Description: Require at least one lowercase character in password
Type: Boolean
Default Value: True
Min: N/A
Max: N/A
---
Parameter: RequireSymbols
Description: Require at least one symbol in password
Type: Boolean
Default Value: True
Min: N/A
Max: N/A
---
Parameter: RequireNumbers
Description: Require at least one number in password
Type: Boolean
Default Value: True
Min: N/A
Max: N/A
---
Parameter: PasswordReusePrevention
Description: Number of password rotations before an old password can be reused
Type: Integer
Default Value: N/A
Min: 12
Max: 24
---
Parameter: MinimumPasswordLength
Description: Minimum number of characters in the password
Type: Integer
Default Value: 8
Min: 8
Max: 128
---
Parameter: MaxPasswordAge
Description: Number of days before password expiration
Type: Integer
Default Value: N/A
Min: 1
Max: 90
---
",3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/iam-controls.html#iam-7,Protect > Secure access management,AWS::::Account,iam-password-policy,Periodic,"To update your password policy, see Setting an account password policy for IAM users in the IAM User Guide."
IAM.8,Unused IAM user credentials should be removed,This control checks whether your IAM users have passwords or active access keys that were not used within the previous 90 days.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/IAM.8/remediation,,5,"AWS Foundational Security Best Practices v1.0.0, CIS AWS Foundations Benchmark v1.2.0, NIST Special Publication 800-53 Revision 5, PCI DSS v3.2.1, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/iam-controls.html#iam-8,Protect > Secure access management,AWS::IAM::User,iam-user-unused-credentials-check,Periodic,"When you view user information in the IAM console, there are columns for Access key age, Password age, and Last activity. If the value in any of these columns is greater than 90 days, make the credentials for those users inactive. You can also use credential reports to monitor users and identify those with no activity for 90 or more days. You can download credential reports in .csv format from the IAM console. After you identify the inactive accounts or unused credentials, deactivate them. For instructions, see Creating, changing, or deleting an IAM user password (console) in the IAM User Guide."
IAM.9,MFA should be enabled for the root user,This AWS control checks whether users of your AWS account require a multi-factor authentication (MFA) device to sign in with root user credentials.,CRITICAL,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/IAM.9/remediation,,6,"CIS AWS Foundations Benchmark v1.2.0, CIS AWS Foundations Benchmark v1.4.0, CIS AWS Foundations Benchmark v3.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v3.2.1, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/iam-controls.html#iam-9,Protect > Secure access management,AWS::::Account,root-account-mfa-enabled,Periodic,"For information about enabling MFA for the root user of an AWS account, see Multi-factor authentication for the AWS account root user in the AWS Identity and Access Management User Guide."
IAM.10,Password policies for IAM users should have strong configurations,"This AWS control checks whether the account password policy for IAM users uses the following minimum PCI DSS configurations:

RequireUppercaseCharacters: Require at least one uppercase character in password. (Default = true)
RequireLowercaseCharacters: Require at least one lowercase character in password. (Default = true)
RequireNumbers: Require at least one number in password. (Default = true)
MinimumPasswordLength: Password minimum length. (Default = 7 or longer)
PasswordReusePrevention: Number of passwords before allowing reuse. (Default = 4)
MaxPasswordAge: Number of days before password expiration. (Default = 90)",MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/IAM.10/remediation,,2,"PCI DSS v3.2.1, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/iam-controls.html#iam-10,Protect > Secure access management,AWS::::Account,iam-password-policy,Periodic,"To update your password policy to use the recommended configuration, see Setting an account password policy for IAM users in the IAM User Guide."
IAM.11,Ensure IAM password policy requires at least one uppercase letter,"Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure passwords are comprised of different character sets. It is recommended that the password policy require at least one uppercase letter.",MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/IAM.11/remediation,,2,"CIS AWS Foundations Benchmark v1.2.0, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/iam-controls.html#iam-11,Protect > Secure access management,AWS::::Account,iam-password-policy,Periodic,"To change your password policy, see Setting an account password policy for IAM users in the IAM User Guide. For Password strength, select Require at least one uppercase letter from the Latin alphabet (A–Z)."
IAM.12,Ensure IAM password policy requires at least one lowercase letter,"Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure passwords are comprised of different character sets. It is recommended that the password policy require at least one lowercase letter.",MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/IAM.12/remediation,,2,"CIS AWS Foundations Benchmark v1.2.0, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/iam-controls.html#iam-12,Protect > Secure access management,AWS::::Account,iam-password-policy,Periodic,"To change your password policy, see Setting an account password policy for IAM users in the IAM User Guide. For Password strength, select Require at least one lowercase letter from the Latin alphabet (A–Z)."
IAM.13,Ensure IAM password policy requires at least one symbol,"Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure passwords are comprised of different character sets. It is recommended that the password policy require at least one symbol.",MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/IAM.13/remediation,,2,"CIS AWS Foundations Benchmark v1.2.0, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/iam-controls.html#iam-13,Protect > Secure access management,AWS::::Account,iam-password-policy,Periodic,"To change your password policy, see Setting an account password policy for IAM users in the IAM User Guide. For Password strength, select Require at least one nonalphanumeric character."
IAM.14,Ensure IAM password policy requires at least one number,"Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure passwords are comprised of different character sets. It is recommended that the password policy require at least one number.",MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/IAM.14/remediation,,2,"CIS AWS Foundations Benchmark v1.2.0, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/iam-controls.html#iam-14,Protect > Secure access management,AWS::::Account,iam-password-policy,Periodic,"To change your password policy, see Setting an account password policy for IAM users in the IAM User Guide. For Password strength, select Require at least one number."
IAM.15,Ensure IAM password policy requires minimum password length of 14 or greater,"Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure passwords are at least a given length. It is recommended that the password policy require a minimum password length 14.",MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/IAM.15/remediation,,3,"CIS AWS Foundations Benchmark v1.2.0, CIS AWS Foundations Benchmark v1.4.0, CIS AWS Foundations Benchmark v3.0.0",https://docs.aws.amazon.com/securityhub/latest/userguide/iam-controls.html#iam-15,Protect > Secure access management,AWS::::Account,iam-password-policy,Periodic,"To change your password policy, see Setting an account password policy for IAM users in the IAM User Guide. For Password minimum length, enter 14 or a larger number."
IAM.16,Ensure IAM password policy prevents password reuse,IAM password policies can prevent the reuse of a given password by the same user. It is recommended that the password policy prevent the reuse of passwords.,LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/IAM.16/remediation,,4,"CIS AWS Foundations Benchmark v1.2.0, CIS AWS Foundations Benchmark v1.4.0, CIS AWS Foundations Benchmark v3.0.0, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/iam-controls.html#iam-16,Protect > Secure access management,AWS::::Account,iam-password-policy,Periodic,"To change your password policy, see Setting an account password policy for IAM users in the IAM User Guide. For Prevent password reuse, enter 24."
IAM.17,Ensure IAM password policy expires passwords within 90 days or less,IAM password policies can require passwords to be rotated or expired after a given number of days. It is recommended that the password policy expire passwords after 90 days or less.,LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/IAM.17/remediation,,2,"CIS AWS Foundations Benchmark v1.2.0, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/iam-controls.html#iam-17,Protect > Secure access management,AWS::::Account,iam-password-policy,Periodic,"To change your password policy, see Setting an account password policy for IAM users in the IAM User Guide. For Turn on password expiration, enter 90 or a smaller number."
IAM.18,Ensure a support role has been created to manage incidents with AWS Support,"AWS provides a support center that can be used for incident notification and response, as well as technical support and customer services. Create an IAM Role to allow authorized users to manage incidents with AWS Support.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/IAM.18/remediation,,4,"CIS AWS Foundations Benchmark v1.2.0, CIS AWS Foundations Benchmark v1.4.0, CIS AWS Foundations Benchmark v3.0.0, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/iam-controls.html#iam-18,Protect > Secure access management,AWS::::Account,iam-policy-in-use,Periodic,"To remediate this issue, create a role to allow authorized users to manage Support incidents. To create the role to use for Support accessOpen the IAM console at https://console.aws.amazon.com/iam/. In the IAM navigation pane, choose Roles, then choose Create role. For Role type, choose the Another AWS account. For Account ID, enter the AWS account ID of the AWS account to which you want to grant access to your resources. If the users or groups that will assume this role are in the same account, then enter the local account number. NoteThe administrator of the specified account can grant permission to assume this role to any user in that account. To do this, the administrator attaches a policy to the user or a group that grants permission for the sts:AssumeRole action. In that policy, the resource must be the role ARN. Choose Next: Permissions. Search for the managed policy AWSSupportAccess. Select the check box for the AWSSupportAccess managed policy. Choose Next: Tags. (Optional) To add metadata to the role, attach tags as key-value pairs. For more information about using tags in IAM, see Tagging IAM users and roles in the IAM User Guide. Choose Next: Review. For Role name, enter a name for your role. Role names must be unique within your AWS account. They are not case sensitive. (Optional) For Role description, enter a description for the new role. Review the role, then choose Create role. Show moreShow less"
IAM.19,MFA should be enabled for all IAM users,This AWS control checks whether the AWS Identity and Access Management users have multi-factor authentication (MFA) enabled.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/IAM.19/remediation,,3,"NIST Special Publication 800-53 Revision 5, PCI DSS v3.2.1, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/iam-controls.html#iam-19,Protect > Secure access management,AWS::IAM::User,iam-user-mfa-enabled,Periodic,"To add MFA for IAM users, see Enabling MFA devices for users in AWS in the IAM User Guide."
IAM.21,IAM customer managed policies that you create should not allow wildcard actions for services,"This control checks whether the IAM identity-based custom policies have Allow statements that grant permissions for all actions on a service. The control fails if any policy statement includes ""Effect"": ""Allow"" with ""Action"": ""Service:*"".",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/IAM.21/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/iam-controls.html#iam-21,Detect > Secure access management,AWS::IAM::Policy,iam-policy-no-statements-with-full-access,Change triggered,"To remediate this issue, update your IAM policies so that they do not allow full ""*"" administrative privileges. For details about how to edit an IAM policy, see Editing IAM policies in the IAM User Guide."
IAM.22,IAM user credentials unused for 45 days should be removed,This control checks whether your IAM users have passwords or active access keys that were not used within the previous 45 days.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/IAM.22/remediation,,2,"CIS AWS Foundations Benchmark v1.4.0, CIS AWS Foundations Benchmark v3.0.0",https://docs.aws.amazon.com/securityhub/latest/userguide/iam-controls.html#iam-22,Protect > Secure access management,AWS::IAM::User,iam-user-unused-credentials-check,Periodic,"When you view user information in the IAM console, there are columns for Access key age, Password age, and Last activity. If the value in any of these columns is greater than 45 days, make the credentials for those users inactive. You can also use credential reports to monitor users and identify those with no activity for 45 or more days. You can download credential reports in .csv format from the IAM console. After you identify the inactive accounts or unused credentials, deactivate them. For instructions, see Creating, changing, or deleting an IAM user password (console) in the IAM User Guide."
IAM.23,IAM Access Analyzer analyzers should be tagged,"This control checks whether an analyzer managed by AWS Identity and Access Management Access Analyzer (IAM Access Analyzer) has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the analyzer doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the analyzer isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/IAM.23/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/iam-controls.html#iam-23,Identify > Inventory > Tagging,AWS::AccessAnalyzer::Analyzer,tagged-accessanalyzer-analyzer (custom Security Hub rule),Change triggered,"To add tags to an analyzer, see TagResource in the AWS IAM Access Analyzer API Reference."
IAM.24,IAM roles should be tagged,"This control checks whether an AWS IAM role has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the role doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the role isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/IAM.24/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/iam-controls.html#iam-24,Identify > Inventory > Tagging,AWS::IAM::Role,tagged-iam-role (custom Security Hub rule),Change triggered,"To add tags to an IAM role, see Tagging IAM resources in the IAM User Guide."
IAM.25,IAM users should be tagged,"This control checks whether an AWS Identity and Access Management (IAM) user has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the user doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the user isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/IAM.25/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/iam-controls.html#iam-25,Identify > Inventory > Tagging,AWS::IAM::User,tagged-iam-user (custom Security Hub rule),Change triggered,"To add tags to an IAM user, see Tagging IAM resources in the IAM User Guide."
IAM.26,Expired SSL/TLS certificates managed in IAM should be removed,This controls checks whether an active SSL/TLS server certificate that is managed in IAM has expired. The control fails if the expired SSL/TLS server certificate isn't removed.,MEDIUM,UNAVAILABLE,https://docs.aws.amazon.com/console/securityhub/IAM.26/remediation,,1,CIS AWS Foundations Benchmark v3.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/iam-controls.html#iam-26,Identify > Compliance,AWS::IAM::ServerCertificate,iam-server-certificate-expiration-check,Periodic,"To remove a server certificate from IAM, see Managing server certificates in IAM in the IAM User Guide."
IAM.27,IAM identities should not have the AWSCloudShellFullAccess policy attached,"This control checks whether an IAM identity (user, role, or group) has the AWS managed policy AWSCloudShellFullAccess attached. The control fails if an IAM identity has the AWSCloudShellFullAccess policy attached.",MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/IAM.27/remediation,,1,CIS AWS Foundations Benchmark v3.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/iam-controls.html#iam-27,Protect > Secure access management > Secure IAM policies,AWS::IAM::Role,iam-policy-blacklisted-check,Change triggered,"To detach the AWSCloudShellFullAccess policy from an IAM identity, see Adding and removing IAM identity permissions in the IAM User Guide."
IAM.28,IAM Access Analyzer external access analyzer should be enabled,This control checks whether an AWS account has an IAM Access Analyzer external access analyzer enabled. The control fails if the account doesn't have an external access analyzer enabled in your currently selected AWS Region.,HIGH,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/IAM.28/remediation,,1,CIS AWS Foundations Benchmark v3.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/iam-controls.html#iam-28,"Detect > Detection services > Privileged
            usage monitoring",AWS::AccessAnalyzer::Analyzer,iam-external-access-analyzer-enabled,Periodic,"For information about enabling an external access analyzer in a specific Region, see Getting started with IAM Access Analyzer in the IAM User Guide. You must enable an analyzer in each Region in which you want to monitor access to your resources."
IVS.1,IVS playback key pairs should be tagged,"This control checks whether an Amazon IVS playback key pair has tags with the specific keys defined in the parameter requiredKeyTags. The control fails if the playback key pair doesn't have any tag keys or if it doesn't have all the keys specified in the parameter requiredKeyTags. If the parameter requiredKeyTags isn't provided, the control only checks for the existence of a tag key and fails if the playback key pair isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/IVS.1/remediation,"Parameter: requiredKeyTags
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/ivs-controls.html#ivs-1,Identify > Inventory > Tagging,AWS::IVS::PlaybackKeyPair,ivs-playback-key-pair-tagged,Change triggered,"To add tags to an IVS playback key pair, see TagResource in the Amazon IVS Real-Time Streaming API Reference."
IVS.2,IVS recording configurations should be tagged,"This control checks whether an Amazon IVS recording configuration has tags with the specific keys defined in the parameter requiredKeyTags. The control fails if the recording configuration doesn't have any tag keys or if it doesn't have all the keys specified in the parameter requiredKeyTags. If the parameter requiredKeyTags isn't provided, the control only checks for the existence of a tag key and fails if the recording configuration isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/IVS.2/remediation,"Parameter: requiredKeyTags
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/ivs-controls.html#ivs-2,Identify > Inventory > Tagging,AWS::IVS::RecordingConfiguration,ivs-recording configuration-tagged,Change triggered,"To add tags to an IVS recording configuration, see TagResource in the Amazon IVS Real-Time Streaming API Reference."
IVS.3,IVS channels should be tagged,"This control checks whether an Amazon IVS channel has tags with the specific keys defined in the parameter requiredKeyTags. The control fails if the channel doesn't have any tag keys or if it doesn't have all the keys specified in the parameter requiredKeyTags. If the parameter requiredKeyTags isn't provided, the control only checks for the existence of a tag key and fails if the channel isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/IVS.3/remediation,"Parameter: requiredKeyTags
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/ivs-controls.html#ivs-3,Identify > Inventory > Tagging,AWS::IVS::Channel,ivs-channel-tagged,Change triggered,"To add tags to an IVS channel, see TagResource in the Amazon IVS Real-Time Streaming API Reference."
Inspector.1,Amazon Inspector EC2 scanning should be enabled,"This control checks whether Amazon Inspector EC2 scanning is enabled. For a standalone account, the control fails if Amazon Inspector EC2 scanning is disabled in the account. In a multi-account environment, the control fails if the delegated Inspector administrator account and all member accounts don't have EC2 scanning enabled.",HIGH,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Inspector.1/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/inspector-controls.html#inspector-1,Detect > Detection services,AWS::::Account,inspector-ec2-scan-enabled,Periodic,"To enable Amazon Inspector EC2 scanning, see Activating scans in the Amazon Inspector User Guide."
Inspector.2,Amazon Inspector ECR scanning should be enabled,"This control checks whether Amazon Inspector ECR scanning is enabled. For a standalone account, the control fails if Amazon Inspector ECR scanning is disabled in the account. In a multi-account environment, the control fails if the delegated Inspector administrator account and all member accounts don't have ECR scanning enabled.",HIGH,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Inspector.2/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/inspector-controls.html#inspector-2,Detect > Detection services,AWS::::Account,inspector-ecr-scan-enabled,Periodic,"To enable Amazon Inspector ECR scanning, see Activating scans in the Amazon Inspector User Guide."
Inspector.3,Amazon Inspector Lambda code scanning should be enabled,"This control checks whether Amazon Inspector Lambda code scanning is enabled. For a standalone account, the control fails if Amazon Inspector Lambda code scanning is disabled in the account. In a multi-account environment, the control fails if the delegated Inspector administrator account and all member accounts don't have Lambda code scanning enabled.",HIGH,UNAVAILABLE,https://docs.aws.amazon.com/console/securityhub/Inspector.3/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/inspector-controls.html#inspector-3,Detect > Detection services,AWS::::Account,inspector-lambda-code-scan-enabled,Periodic,"To enable Amazon Inspector Lambda code scanning, see Activating scans in the Amazon Inspector User Guide."
Inspector.4,Amazon Inspector Lambda standard scanning should be enabled,"This control checks whether Amazon Inspector Lambda standard scanning is enabled. For a standalone account, the control fails if Amazon Inspector Lambda standard scanning is disabled in the account. In a multi-account environment, the control fails if the delegated Inspector administrator account and all member accounts don't have Lambda standard scanning enabled.",HIGH,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Inspector.4/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/inspector-controls.html#inspector-4,Detect > Detection services,AWS::::Account,inspector-lambda-standard-scan-enabled,Periodic,"To enable Amazon Inspector Lambda standard scanning, see Activating scans in the Amazon Inspector User Guide."
IoT.1,AWS IoT Device Defender security profiles should be tagged,"This control checks whether an AWS IoT Device Defender security profile has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the security profile doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the security profile isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/IoT.1/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/iot-controls.html#iot-1,Identify > Inventory > Tagging,AWS::IoT::SecurityProfile,tagged-iot-securityprofile (custom Security Hub rule),Change triggered,"To add tags to an AWS IoT Device Defender security profile, see Tagging your AWS IoT resources in the AWS IoT Developer Guide."
IoT.2,AWS IoT Core mitigation actions should be tagged,"This control checks whether an AWS IoT Core mitigation action has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the mitigation action doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the mitigation action isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/IoT.2/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/iot-controls.html#iot-2,Identify > Inventory > Tagging,AWS::IoT::MitigationAction,tagged-iot-mitigationaction (custom Security Hub rule),Change triggered,"To add tags to an AWS IoT Core mitigation action, see Tagging your AWS IoT resources in the AWS IoT Developer Guide."
IoT.3,AWS IoT Core dimensions should be tagged,"This control checks whether an AWS IoT Core dimension has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the dimension doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the dimension isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/IoT.3/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/iot-controls.html#iot-3,Identify > Inventory > Tagging,AWS::IoT::Dimension,tagged-iot-dimension (custom Security Hub rule),Change triggered,"To add tags to an AWS IoT Core dimension, see Tagging your AWS IoT resources in the AWS IoT Developer Guide."
IoT.4,AWS IoT Core authorizers should be tagged,"This control checks whether an AWS IoT Core authorizer has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the authorizer doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the authorizer isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/IoT.4/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/iot-controls.html#iot-4,Identify > Inventory > Tagging,AWS::IoT::Authorizer,tagged-iot-authorizer (custom Security Hub rule),Change triggered,"To add tags to an AWS IoT Core authorizer, see Tagging your AWS IoT resources in the AWS IoT Developer Guide."
IoT.5,AWS IoT Core role aliases should be tagged,"This control checks whether an AWS IoT Core role alias has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the role alias doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the role alias isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/IoT.5/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/iot-controls.html#iot-5,Identify > Inventory > Tagging,AWS::IoT::RoleAlias,tagged-iot-rolealias (custom Security Hub rule),Change triggered,"To add tags to an AWS IoT Core role alias, see Tagging your AWS IoT resources in the AWS IoT Developer Guide."
IoT.6,AWS IoT Core policies should be tagged,"This control checks whether an AWS IoT Core policy has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the policy doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the policy isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/IoT.6/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/iot-controls.html#iot-6,Identify > Inventory > Tagging,AWS::IoT::Policy,tagged-iot-policy (custom Security Hub rule),Change triggered,"To add tags to an AWS IoT Core policy, see Tagging your AWS IoT resources in the AWS IoT Developer Guide."
IoTEvents.1,AWS IoT Events inputs should be tagged,"This control checks whether an AWS IoT Events input has tags with the specific keys defined in the parameter requiredKeyTags. The control fails if the input doesn't have any tag keys or if it doesn't have all the keys specified in the parameter requiredKeyTags. If the parameter requiredKeyTags isn't provided, the control only checks for the existence of a tag key and fails if the input isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/IoTEvents.1/remediation,"Parameter: requiredKeyTags
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/iotevents-controls.html#iotevents-1,Identify > Inventory > Tagging,AWS::IoTEvents::Input,iotevents-input-tagged,Change triggered,"To add tags to an AWS IoT Events input, see Tagging your AWS IoT Events resources in the AWS IoT Events Developer Guide."
IoTEvents.2,AWS IoT Events detector models should be tagged,"This control checks whether an AWS IoT Events detector model has tags with the specific keys defined in the parameter requiredKeyTags. The control fails if the detector model doesn't have any tag keys or if it doesn't have all the keys specified in the parameter requiredKeyTags. If the parameter requiredKeyTags isn't provided, the control only checks for the existence of a tag key and fails if the detector model isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/IoTEvents.2/remediation,"Parameter: requiredKeyTags
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/iotevents-controls.html#iotevents-2,Identify > Inventory > Tagging,AWS::IoTEvents::DetectorModel,iotevents-detector-model-tagged,Change triggered,"To add tags to an AWS IoT Events detector model, see Tagging your AWS IoT Events resources in the AWS IoT Events Developer Guide."
IoTEvents.3,AWS IoT Events alarm models should be tagged,"This control checks whether an AWS IoT Events alarm model has tags with the specific keys defined in the parameter requiredKeyTags. The control fails if the alarm model doesn't have any tag keys or if it doesn't have all the keys specified in the parameter requiredKeyTags. If the parameter requiredKeyTags isn't provided, the control only checks for the existence of a tag key and fails if the alarm model isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/IoTEvents.3/remediation,"Parameter: requiredKeyTags
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/iotevents-controls.html#iotevents-3,Identify > Inventory > Tagging,AWS::IoTEvents::AlarmModel,iotevents-alarm-model-tagged,Change triggered,"To add tags to an AWS IoT Events alarm model, see Tagging your AWS IoT Events resources in the AWS IoT Events Developer Guide."
IoTSiteWise.1,AWS IoT SiteWise asset models should be tagged,"This control checks whether an AWS IoT SiteWise asset models has tags with the specific keys defined in the parameter requiredKeyTags. The control fails if the asset model doesn't have any tag keys or if it doesn't have all the keys specified in the parameter requiredKeyTags. If the parameter requiredKeyTags isn't provided, the control only checks for the existence of a tag key and fails if the asset model isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/IoTSiteWise.1/remediation,"Parameter: requiredKeyTags
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/iotsitewise-controls.html#iotsitewise-1,Identify > Inventory > Tagging,AWS::IoTSiteWise::AssetModel,iotsitewise-asset-model-tagged,Change triggered,"To add tags to an AWS IoT SiteWise asset model, see Tag your AWS IoT SiteWise resources in the AWS IoT SiteWise User Guide."
IoTSiteWise.2,AWS IoT SiteWise dashboards should be tagged,"This control checks whether an AWS IoT SiteWise dashboard has tags with the specific keys defined in the parameter requiredKeyTags. The control fails if the dashboard doesn't have any tag keys or if it doesn't have all the keys specified in the parameter requiredKeyTags. If the parameter requiredKeyTags isn't provided, the control only checks for the existence of a tag key and fails if the dashboard isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/IoTSiteWise.2/remediation,"Parameter: requiredKeyTags
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/iotsitewise-controls.html#iotsitewise-2,Identify > Inventory > Tagging,AWS::IoTSiteWise::Dashboard,iotsitewise-dashboard-tagged,Change triggered,"To add tags to an AWS IoT SiteWise dashboard, see Tag your AWS IoT SiteWise resources in the AWS IoT SiteWise User Guide."
IoTSiteWise.3,AWS IoT SiteWise gateways should be tagged,"This control checks whether an AWS IoT SiteWise gateway has tags with the specific keys defined in the parameter requiredKeyTags. The control fails if the gateway doesn't have any tag keys or if it doesn't have all the keys specified in the parameter requiredKeyTags. If the parameter requiredKeyTags isn't provided, the control only checks for the existence of a tag key and fails if the gateway isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/IoTSiteWise.3/remediation,"Parameter: requiredKeyTags
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/iotsitewise-controls.html#iotsitewise-3,Identify > Inventory > Tagging,AWS::IoTSiteWise::Gateway,iotsitewise-gateway-tagged,Change triggered,"To add tags to an AWS IoT SiteWise gateway, see Tag your AWS IoT SiteWise resources in the AWS IoT SiteWise User Guide."
IoTSiteWise.4,AWS IoT SiteWise portals should be tagged,"This control checks whether an AWS IoT SiteWise portal has tags with the specific keys defined in the parameter requiredKeyTags. The control fails if the portal doesn't have any tag keys or if it doesn't have all the keys specified in the parameter requiredKeyTags. If the parameter requiredKeyTags isn't provided, the control only checks for the existence of a tag key and fails if the portal isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/IoTSiteWise.4/remediation,"Parameter: requiredKeyTags
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/iotsitewise-controls.html#iotsitewise-4,Identify > Inventory > Tagging,AWS::IoTSiteWise::Portal,iotsitewise-portal-tagged,Change triggered,"To add tags to an AWS IoT SiteWise portal, see Tag your AWS IoT SiteWise resources in the AWS IoT SiteWise User Guide."
IoTSiteWise.5,AWS IoT SiteWise projects should be tagged,"This control checks whether an AWS IoT SiteWise project has tags with the specific keys defined in the parameter requiredKeyTags. The control fails if the project doesn't have any tag keys or if it doesn't have all the keys specified in the parameter requiredKeyTags. If the parameter requiredKeyTags isn't provided, the control only checks for the existence of a tag key and fails if the project isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/IoTSiteWise.5/remediation,"Parameter: requiredKeyTags
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/iotsitewise-controls.html#iotsitewise-5,Identify > Inventory > Tagging,AWS::IoTSiteWise::Project,iotsitewise-project-tagged,Change triggered,"To add tags to an AWS IoT SiteWise project, see Tag your AWS IoT SiteWise resources in the AWS IoT SiteWise User Guide."
IoTTwinMaker.1,AWS IoT TwinMaker sync jobs should be tagged,"This control checks whether an AWS IoT TwinMaker sync job has tags with the specific keys defined in the parameter requiredKeyTags. The control fails if the TwinMaker sync job doesn't have any tag keys or if it doesn't have all the keys specified in the parameter requiredKeyTags. If the parameter requiredKeyTags isn't provided, the control only checks for the existence of a tag key and fails if the TwinMaker sync job isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/IoTTwinMaker.1/remediation,"Parameter: requiredKeyTags
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/iottwinmaker-controls.html#iottwinmaker-1,Identify > Inventory > Tagging,AWS::IoTTwinMaker::SyncJob,iottwinmaker-sync-job-tagged,Change triggered,"To add tags to an AWS IoT TwinMaker sync job, see TagResource in the AWS IoT TwinMaker User Guide."
IoTTwinMaker.2,AWS IoT TwinMaker workspaces should be tagged,"This control checks whether an AWS IoT TwinMaker workspace has tags with the specific keys defined in the parameter requiredKeyTags. The control fails if the TwinMaker workspace doesn't have any tag keys or if it doesn't have all the keys specified in the parameter requiredKeyTags. If the parameter requiredKeyTags isn't provided, the control only checks for the existence of a tag key and fails if the TwinMaker workspace isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/IoTTwinMaker.2/remediation,"Parameter: requiredKeyTags
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/iottwinmaker-controls.html#iottwinmaker-2,Identify > Inventory > Tagging,AWS::IoTTwinMaker::Workspace,iottwinmaker-workspace-tagged,Change triggered,"To add tags to an AWS IoT TwinMaker workspace, see TagResource in the AWS IoT TwinMaker User Guide."
IoTTwinMaker.3,AWS IoT TwinMaker scenes should be tagged,"This control checks whether an AWS IoT TwinMaker scene has tags with the specific keys defined in the parameter requiredKeyTags. The control fails if the TwinMaker scene doesn't have any tag keys or if it doesn't have all the keys specified in the parameter requiredKeyTags. If the parameter requiredKeyTags isn't provided, the control only checks for the existence of a tag key and fails if the TwinMaker scene isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/IoTTwinMaker.3/remediation,"Parameter: requiredKeyTags
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/iottwinmaker-controls.html#iottwinmaker-3,Identify > Inventory > Tagging,AWS::IoTTwinMaker::Scene,iottwinmaker-scene-tagged,Change triggered,"To add tags to an AWS IoT TwinMaker scene, see TagResource in the AWS IoT TwinMaker User Guide."
IoTTwinMaker.4,AWS IoT TwinMaker entities should be tagged,"This control checks whether an AWS IoT TwinMaker entity has tags with the specific keys defined in the parameter requiredKeyTags. The control fails if the entity doesn't have any tag keys or if it doesn't have all the keys specified in the parameter requiredKeyTags. If the parameter requiredKeyTags isn't provided, the control only checks for the existence of a tag key and fails if the entity isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,UNAVAILABLE,https://docs.aws.amazon.com/console/securityhub/IoTTwinMaker.4/remediation,"Parameter: requiredKeyTags
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/iottwinmaker-controls.html#iottwinmaker-4,Identify > Inventory > Tagging,AWS::IoTTwinMaker::Entity,iottwinmaker-entity-tagged,Change triggered,"To add tags to an AWS IoT TwinMaker entity, see TagResource in the AWS IoT TwinMaker User Guide."
IoTWireless.1,AWS IoT Wireless multicast groups should be tagged,"This control checks whether an AWS IoT Wireless multicast group has tags with the specific keys defined in the parameter requiredKeyTags. The control fails if the multicast group doesn't have any tag keys or if it doesn't have all the keys specified in the parameter requiredKeyTags. If the parameter requiredKeyTags isn't provided, the control only checks for the existence of a tag key and fails if the multicast group isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,UNAVAILABLE,https://docs.aws.amazon.com/console/securityhub/IoTWireless.1/remediation,"Parameter: requiredKeyTags
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/iotwireless-controls.html#iotwireless-1,Identify > Inventory > Tagging,AWS::IoTWireless::MulticastGroup,iotwireless-multicast-group-tagged,Change triggered,"To add tags to an AWS IoT Wireless multicast group, see Tagging your AWS IoT Wireless resources in the AWS IoT Wireless Developer Guide."
IoTWireless.2,AWS IoT Wireless service profiles should be tagged,"This control checks whether an AWS IoT Wireless service profiles has tags with the specific keys defined in the parameter requiredKeyTags. The control fails if the service profile doesn't have any tag keys or if it doesn't have all the keys specified in the parameter requiredKeyTags. If the parameter requiredKeyTags isn't provided, the control only checks for the existence of a tag key and fails if the service profile isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,UNAVAILABLE,https://docs.aws.amazon.com/console/securityhub/IoTWireless.2/remediation,"Parameter: requiredKeyTags
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/iotwireless-controls.html#iotwireless-2,Identify > Inventory > Tagging,AWS::IoTWireless::ServiceProfile,iotwireless-service-profile-tagged,Change triggered,"To add tags to an AWS IoT Wireless service profile, see Tagging your AWS IoT Wireless resources in the AWS IoT Wireless Developer Guide."
IoTWireless.3,AWS IoT Wireless FUOTA tasks should be tagged,"This control checks whether an AWS IoT Wireless firmware update over-the-air (FUOTA) task has tags with the specific keys defined in the parameter requiredKeyTags. The control fails if the FUOTA task doesn't have any tag keys or if it doesn't have all the keys specified in the parameter requiredKeyTags. If the parameter requiredKeyTags isn't provided, the control only checks for the existence of a tag key and fails if the FUOTA task isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,UNAVAILABLE,https://docs.aws.amazon.com/console/securityhub/IoTWireless.3/remediation,"Parameter: requiredKeyTags
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/iotwireless-controls.html#iotwireless-3,Identify > Inventory > Tagging,AWS::IoTWireless::FuotaTask,iotwireless-fuota-task-tagged,Change triggered,"To add tags to an AWS IoT Wireless FUOTA task, see Tagging your AWS IoT Wireless resources in the AWS IoT Wireless Developer Guide."
KMS.1,IAM customer managed policies should not allow decryption actions on all KMS keys,Checks whether the default version of IAM customer managed policies allow principals to use the AWS Key Management Service (KMS) decryption actions on all resources. This control fails if kms:Decrypt or kms:ReEncryptFrom actions are allowed on all KMS keys. The control evaluates both attached and unattached customer managed policies. It does not check inline policies or AWS managed policies.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/KMS.1/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/kms-controls.html#kms-1,Protect > Secure access management,AWS::IAM::Policy,iam-customer-policy-blocked-kms-actions,Change triggered,"To modify an IAM customer managed policy, see Editing customer managed policies in the IAM User Guide. When editing your policy, for the Resource field, provide the Amazon Resource Name (ARN) of the specific key or keys that you want to allow decryption actions on."
KMS.2,IAM principals should not have IAM inline policies that allow decryption actions on all KMS keys,Checks whether the inline policies embedded in your IAM principals (Role/User/Group) allow the AWS Key Management Service (KMS) decryption actions on all KMS keys. This control fails if kms:Decrypt or kms:ReEncryptFrom actions are allowed on all KMS keys in an inline policy.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/KMS.2/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/kms-controls.html#kms-2,Protect > Secure access management,AWS::IAM::Group,iam-inline-policy-blocked-kms-actions,Change triggered,"To modify an IAM inline policy, see Editing inline policies in the IAM User Guide. When editing your policy, for the Resource field, provide the Amazon Resource Name (ARN) of the specific key or keys that you want to allow decryption actions on."
KMS.3,AWS KMS keys should not be deleted unintentionally,This control checks whether AWS Key Management Service (KMS) customer managed keys (CMK) are scheduled for deletion. The control fails if a KMS CMK is scheduled for deletion.,CRITICAL,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/KMS.3/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/kms-controls.html#kms-3,"Protect > Data protection > Data deletion
            protection",AWS::KMS::Key,kms-cmk-not-scheduled-for-deletion-2 (custom Security Hub rule),Change triggered,"To cancel a scheduled KMS key deletion, see To cancel key deletion under Scheduling and canceling key deletion (console) in the AWS Key Management Service Developer Guide."
KMS.4,AWS KMS key rotation should be enabled,This AWS control checks that key rotation is enabled for each AWS KMS key. It does not check KMS keys that have imported key material.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/KMS.4/remediation,,6,"CIS AWS Foundations Benchmark v1.2.0, CIS AWS Foundations Benchmark v1.4.0, CIS AWS Foundations Benchmark v3.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v3.2.1, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/kms-controls.html#kms-4,Protect > Data Protection > Encryption of data-at-rest,AWS::KMS::Key,cmk-backing-key-rotation-enabled,Periodic,"To enable KMS key rotation, see How to enable and disable automatic key rotation in the AWS Key Management Service Developer Guide."
KMS.5,KMS keys should not be publicly accessible,This controls checks whether an AWS KMS key is publicly accessible. The control fails if the KMS key is publicly accessible.,CRITICAL,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/KMS.5/remediation,,1,AWS Foundational Security Best Practices v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/kms-controls.html#kms-5,Protect > Secure network configuration > Resources not publicly accessible,AWS::KMS::Key,kms-key-policy-no-public-access,Change triggered,"For information about updating the key policy for an AWS KMS key, see Key policies in AWS KMS in the AWS Key Management Service Developer Guide."
Keyspaces.1,Amazon Keyspaces keyspaces should be tagged,"This control checks whether an Amazon Keyspaces keyspace has tags with the specific keys defined in the parameter requiredKeyTags. The control fails if the keyspace doesn't have any tag keys or if it doesn't have all the keys specified in the parameter requiredKeyTags. If the parameter requiredKeyTags isn't provided, the control only checks for the existence of a tag key and fails if the Keyspace isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Keyspaces.1/remediation,"Parameter: requiredKeyTags
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/keyspaces-controls.html#keyspaces-1,Identify > Inventory > Tagging,AWS::Cassandra::Keyspace,cassandra-keyspace-tagged,Change triggered,"To add tags to an Amazon Keyspaces keyspace, see Add tags to a keyspace in the Amazon Keyspaces Developer Guide."
Kinesis.1,Kinesis streams should be encrypted at rest,This control checks if Kinesis streams are encrypted at rest with server-side encryption. This control fails if a Kinesis stream is not encrypted at rest with server-side encryption.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Kinesis.1/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/kinesis-controls.html#kinesis-1,Protect > Data Protection > Encryption of data-at-rest,AWS::Kinesis::Stream,kinesis-stream-encrypted,Change triggered,"For information about enabling server-side encryption for Kinesis streams, see How do I get started with server-side encryption? in the Amazon Kinesis Developer Guide."
Kinesis.2,Kinesis streams should be tagged,"This control checks whether an Amazon Kinesis data stream has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the data stream doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the data stream isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Kinesis.2/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/kinesis-controls.html#kinesis-2,Identify > Inventory > Tagging,AWS::Kinesis::Stream,tagged-kinesis-stream (custom Security Hub rule),Change triggered,"To add tags to a Kinesis data stream, see Tagging your streams in Amazon Kinesis Data Streams in the Amazon Kinesis Developer Guide."
Kinesis.3,Kinesis streams should have an adequate data retention period,"This control checks whether an Amazon Kinesis data stream has a data retention period greater than or equal to the specified time frame. The control fails if the data retention period is less than the specified time frame. Unless you provide a custom parameter value for the data retention period, Security Hub uses a default value of 168 hours.",MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Kinesis.3/remediation,"Parameter: minimumBackupRetentionPeriod
Description: Minimum number of hours that the data should be retained
Type: Integer
Default Value: 168
Min: 24
Max: 8760
---
",1,AWS Foundational Security Best Practices v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/kinesis-controls.html#kinesis-3,Recover > Resilience > Backups enabled,AWS::Kinesis::Stream,kinesis-stream-backup-retention-check,Change triggered,"To change the backup retention period for your Kinesis Data Streams, see Change the data retention period in the Amazon Kinesis Data Streams Developer Guide."
Lambda.1,Lambda function policies should prohibit public access,"This control checks whether the AWS Lambda function policy attached to the Lambda resource prohibits public access. If the Lambda function policy allows public access, the control fails.",CRITICAL,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Lambda.1/remediation,,4,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v3.2.1, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/lambda-controls.html#lambda-1,Protect > Secure network configuration,AWS::Lambda::Function,lambda-function-public-access-prohibited,Change triggered,"To remediate this issue, you must update your function's resource-based policy to remove permissions or to add the AWS:SourceAccount condition. You can only update the resource-based policy from the Lambda API or AWS CLI. To start, review the resource-based policy on the Lambda console. Identify the policy statement that has Principal field values that make the policy public, such as ""*"" or { ""AWS"": ""*"" }. You cannot edit the policy from the console. To remove permissions from the function, run the remove-permission command from the AWS CLI. Replace <function-name> with the name of the Lambda function, and <statement-id> with the statement ID (Sid) of the statement that you want to remove."
Lambda.2,Lambda functions should use supported runtimes,This control checks whether Lambda function runtime settings match the expected values set for the supported runtimes in each language. The control fails if a Lambda function doesn't use a supported runtime.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Lambda.2/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/lambda-controls.html#lambda-2,Protect > Secure development,AWS::Lambda::Function,lambda-function-settings-check,Change triggered,"For more information about supported runtimes and deprecation schedules, see Runtime deprecation policy in the AWS Lambda Developer Guide. When you migrate your runtimes to the latest version, follow the syntax and guidance from the publishers of the language. We also recommend applying runtime updates to help reduce the risk of impact to your workloads in the rare event of a runtime version incompatibility."
Lambda.3,Lambda functions should be in a VPC,This AWS control checks whether a Lambda function is in a VPC.,LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Lambda.3/remediation,,2,"NIST Special Publication 800-53 Revision 5, PCI DSS v3.2.1",https://docs.aws.amazon.com/securityhub/latest/userguide/lambda-controls.html#lambda-3,Protect > Secure network configuration,AWS::Lambda::Function,lambda-inside-vpc,Change triggered,"To configure an existing function to connect to private subnets in your VPC, see Configuring VPC access in the AWS Lambda Developer Guide. We recommend choosing at least two private subnets for high availability and at least one security group that meets the connectivity requirements of the function."
Lambda.5,VPC Lambda functions should operate in multiple Availability Zones,"This control checks if an AWS Lambda function that connects to a virtual private cloud (VPC) operates in at least the specified number of Availability Zone (AZs). The control fails if the function doesn't operate in at least the specified number of AZs. Unless you provide a custom parameter value for the minimum number of AZs, Security Hub uses a default value of two AZs.",MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Lambda.5/remediation,"Parameter: availabilityZones
Description: Minimum number of Availability Zones
Type: Enum
Default Value: 2
Min: N/A
Max: N/A
---
",2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/lambda-controls.html#lambda-5,Recover > Resilience > High availability,AWS::Lambda::Function,lambda-vpc-multi-az-check,Change triggered,"If you configure your function to connect to a VPC in your account, specify subnets in multiple AZs to ensure high availability. For instructions, see Configuring VPC access in the AWS Lambda Developer Guide. Lambda automatically runs other functions in multiple AZs to ensure that it is available to process events in case of a service interruption in a single zone."
Lambda.6,Lambda functions should be tagged,"This control checks if an AWS Lambda function has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the function doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the function isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Lambda.6/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/lambda-controls.html#lambda-6,Identify > Inventory > Tagging,AWS::Lambda::Function,tagged-lambda-function (custom Security Hub rule),Change triggered,"To add tags to a Lambda function, see Using tags on Lambda functions in the AWS Lambda Developer Guide."
MQ.2,ActiveMQ brokers should stream audit logs to CloudWatch,This control checks whether an Amazon MQ ActiveMQ broker streams audit logs to Amazon CloudWatch Logs. The control fails if the broker doesn't stream audit logs to CloudWatch Logs.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/MQ.2/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/mq-controls.html#mq-2,Identify > Logging,AWS::AmazonMQ::Broker,mq-cloudwatch-audit-log-enabled,Change triggered,"To stream ActiveMQ broker logs to CloudWatch Logs, see Configuring Amazon MQ for ActiveMQ logs in the Amazon MQ Developer Guide."
MQ.3,Amazon MQ brokers should have automatic minor version upgrade enabled,This control checks whether an Amazon MQ broker has automatic minor version upgrade enabled. The control fails if the broker doesn't have automatic minor version upgrade enabled.,LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/MQ.3/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/mq-controls.html#mq-3,"Identify > Vulnerability, patch, and version management",AWS::AmazonMQ::Broker,mq-auto-minor-version-upgrade-enabled,Change triggered,"To enable automatic minor version upgrade for an MQ broker, see Automatically upgrading the minor engine version in the Amazon MQ Developer Guide."
MQ.4,Amazon MQ brokers should be tagged,"This control checks whether an Amazon MQ broker has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the broker doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the broker isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/MQ.4/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/mq-controls.html#mq-4,Identify > Inventory > Tagging,AWS::AmazonMQ::Broker,tagged-amazonmq-broker (custom Security Hub rule),Change triggered,"To add tags to an Amazon MQ broker, see Tagging resources in the Amazon MQ Developer Guide."
MQ.5,ActiveMQ brokers should use active/standby deployment mode,This control checks whether the deployment mode for an Amazon MQ ActiveMQ broker is set to active/standby. The control fails if a single-instance broker (enabled by default) is set as the deployment mode.,LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/MQ.5/remediation,,1,NIST Special Publication 800-53 Revision 5,https://docs.aws.amazon.com/securityhub/latest/userguide/mq-controls.html#mq-5,Recover > Resilience > High availability,AWS::AmazonMQ::Broker,mq-active-deployment-mode,Change triggered,"To create a new ActiveMQ broker with active/standby deployment mode, see Creating and configuring an ActiveMQ broker in the Amazon MQ Developer Guide. For Deployment mode, choose Active/standby broker. You can't change the deployment mode for an existing broker. Instead, you must create a new broker and copy the settings over from the old broker."
MQ.6,RabbitMQ brokers should use cluster deployment mode,This control checks whether the deployment mode for an Amazon MQ RabbitMQ broker is set to cluster deployment. This control fails if a single-instance broker (enabled by default) is set as the deployment mode.,LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/MQ.6/remediation,,1,NIST Special Publication 800-53 Revision 5,https://docs.aws.amazon.com/securityhub/latest/userguide/mq-controls.html#mq-6,Recover > Resilience > High availability,AWS::AmazonMQ::Broker,mq-rabbit-deployment-mode,Change triggered,"To create a new RabbitMQ broker with cluster deployment mode, see Creating and connecting to a RabbitMQ broker in the Amazon MQ Developer Guide. For Deployment mode, choose Cluster deployment. You can't change the deployment mode for an existing broker. Instead, you must create a new broker and copy the settings over from the old broker."
MSK.1,MSK clusters should be encrypted in transit among broker nodes,This controls checks if a MSK cluster allows encryption in transit using HTTPS(TLS) among the broker nodes of the cluster. The control fails if plain text communication is enabled for in cluster broker node connection.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/MSK.1/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/msk-controls.html#msk-1,Protect > Data Protection > Encryption of data-in-transit,AWS::MSK::Cluster,msk-in-cluster-node-require-tls,Change triggered,"To update encryption settings for MSK clusters, see Updating security settings of a cluster in the Amazon Managed Streaming for Apache Kafka Developer Guide."
MSK.2,MSK clusters should have enhanced monitoring configured,"This control checks whether an Amazon MSK cluster has enhanced monitoring configured, specified by a monitoring level of at least ""PER_TOPIC_PER_BROKER"". The control fails if the monitoring level for the cluster is set to ""DEFAULT"" or ""PER_BROKER"".",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/MSK.2/remediation,,1,NIST Special Publication 800-53 Revision 5,https://docs.aws.amazon.com/securityhub/latest/userguide/msk-controls.html#msk-2,Detect > Detection services,AWS::MSK::Cluster,msk-enhanced-monitoring-enabled,Change triggered,"To configure enhanced monitoring for an MSK cluster, complete the following steps: Open the Amazon MSK console at https://console.aws.amazon.com/msk/home?region=us-east-1#/home/.In the navigation pane, choose Clusters. Then, choose a cluster.For Action, select Edit monitoring.Select the option for Enhanced topic-level monitoring.Choose Save changes. For more information about monitoring levels, see Updating security settings of a cluster in the Amazon Managed Streaming for Apache Kafka Developer Guide."
MSK.3,MSK Connect connectors should be encrypted in transit,This control checks whether an Amazon MSK Connect connector is encrypted in transit. The control fails if the connector isn't encrypted in transit.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/MSK.3/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/msk-controls.html#msk-3,Protect > Data Protection > Encryption of data-in-transit,AWS::KafkaConnect::Connector,msk-connect-connector-encrypted (custom Security Hub rule),Change triggered,"You can enable encryption in transit when you create an MSK Connect connector. You can't change encryption settings after creating a connector. For more information, see Create a connector in the Amazon Managed Streaming for Apache Kafka Developer Guide."
Macie.1,Macie should be enabled,This control checks whether Amazon Macie is enabled for an account. The control fails if Macie isn't enabled for the account.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Macie.1/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/macie-controls.html#macie-1,Detect > Detection services,AWS::::Account,macie-status-check,Periodic,"To enable Macie, see Enable Macie in the Amazon Macie User Guide."
Macie.2,Macie automated sensitive data discovery should be enabled,This control checks whether automated sensitive data discovery is enabled for an Amazon Macie administrator account. The control fails if automated sensitive data discovery isn't enabled for a Macie administrator account. The control doesn't generate a finding for member accounts.,HIGH,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Macie.2/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/macie-controls.html#macie-2,Detect > Detection services,AWS::::Account,macie-auto-sensitive-data-discovery-check,Periodic,"To create and configure automated sensitive data discovery jobs to analyze objects in S3 buckets, see Configuring automated sensitive data discovery for your account in the Amazon Macie User Guide."
Neptune.1,Neptune DB clusters should be encrypted at rest,This control checks whether a Neptune DB cluster is encrypted at rest. The control fails if a Neptune DB cluster isn't encrypted at rest.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Neptune.1/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/neptune-controls.html#neptune-1,Protect > Data Protection > Encryption of data-at-rest,AWS::RDS::DBCluster,neptune-cluster-encrypted,Change triggered,"You can enable encryption at rest when you create a Neptune DB cluster. You can't change encryption settings after creating a cluster. For more information, see Encrypting Neptune resources at rest in the Neptune User Guide."
Neptune.2,Neptune DB clusters should publish audit logs to CloudWatch Logs,This control checks whether a Neptune DB cluster publishes audit logs to Amazon CloudWatch Logs. The control fails if a Neptune DB cluster doesn't publish audit logs to CloudWatch Logs. `EnableCloudWatchLogsExport` should be set to Audit.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Neptune.2/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/neptune-controls.html#neptune-2,Identify > Logging,AWS::RDS::DBCluster,neptune-cluster-cloudwatch-log-export-enabled,Change triggered,"To publish Neptune audit logs to CloudWatch Logs, see Publishing Neptune logs to Amazon CloudWatch Logs in the Neptune User Guide. In the Log exports section, choose Audit."
Neptune.3,Neptune DB cluster snapshots should not be public,This control checks whether a Neptune manual DB cluster snapshot is public. The control fails if a Neptune manual DB cluster snapshot is public.,CRITICAL,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Neptune.3/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/neptune-controls.html#neptune-3,Protect > Secure network configuration > Resources not publicly accessible,AWS::RDS::DBClusterSnapshot,neptune-cluster-snapshot-public-prohibited,Change triggered,"To remove public access for Neptune manual DB cluster snapshots, see Sharing a DB cluster snapshot in the Neptune User Guide."
Neptune.4,Neptune DB clusters should have deletion protection enabled,This control checks if a Neptune DB cluster has deletion protection enabled. The control fails if a Neptune DB cluster doesn't have deletion protection enabled.,LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Neptune.4/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/neptune-controls.html#neptune-4,"Protect > Data protection > Data deletion
            protection",AWS::RDS::DBCluster,neptune-cluster-deletion-protection-enabled,Change triggered,"To enable deletion protection for an existing Neptune DB cluster, see Modifying the DB cluster by using the console, CLI, and API in the Amazon Aurora User Guide."
Neptune.5,Neptune DB clusters should have automated backups enabled,"This control checks whether a Neptune DB cluster has automated backups enabled, and a backup retention period greater than or equal to the specified time frame. The control fails if backups aren't enabled for the Neptune DB cluster, or if the retention period is less than the specified time frame. Unless you provide a custom parameter value for the backup retention period, Security Hub uses a default value of 7 days.",MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Neptune.5/remediation,"Parameter: minimumBackupRetentionPeriod
Description: Minimum backup retention period in days
Type: Integer
Default Value: 7
Min: 7
Max: 35
---
",2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/neptune-controls.html#neptune-5,"Recover > Resilience > Backups
            enabled",AWS::RDS::DBCluster,neptune-cluster-backup-retention-check,Change triggered,"To enable automated backups and set a backup retention period for your Neptune DB clusters, see Enabling automated backups in the Amazon RDS User Guide. For Backup retention period, choose a value greater than or equal to 7."
Neptune.6,Neptune DB cluster snapshots should be encrypted at rest,This control checks whether a Neptune DB cluster snapshot is encrypted at rest. The control fails if a Neptune DB cluster isn't encrypted at rest.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Neptune.6/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/neptune-controls.html#neptune-6,Protect > Data Protection > Encryption of data-at-rest,AWS::RDS::DBClusterSnapshot,neptune-cluster-snapshot-encrypted,Change triggered,"You can't encrypt an existing Neptune DB cluster snapshot. Instead, you must restore the snapshot to a new DB cluster and enable encryption on the cluster. You can create an encrypted snapshot from the encrypted cluster. For instructions, see Restoring from a DB cluster snapshot and Creating a DB cluster snapshot in Neptune in the Neptune User Guide."
Neptune.7,Neptune DB clusters should have IAM database authentication enabled,This control checks if a Neptune DB cluster has IAM database authentication enabled. The control fails if IAM database authentication isn't enabled for a Neptune DB cluster.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Neptune.7/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/neptune-controls.html#neptune-7,"Protect > Secure access management >
            Passwordless authentication",AWS::RDS::DBCluster,neptune-cluster-iam-database-authentication,Change triggered,"By default, IAM database authentication is disabled when you create a Neptune DB cluster. To enable it, see Enabling IAM database authentication in Neptune in the Neptune User Guide."
Neptune.8,Neptune DB clusters should be configured to copy tags to snapshots,This control checks if a Neptune DB cluster is configured to copy all tags to snapshots when the snapshots are created. The control fails if a Neptune DB cluster isn't configured to copy tags to snapshots.,LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Neptune.8/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/neptune-controls.html#neptune-8,Identify > Inventory > Tagging,AWS::RDS::DBCluster,neptune-cluster-copy-tags-to-snapshot-enabled,Change triggered,"To copy tags to snapshots for Neptune DB clusters, see Copying tags in Neptune in the Neptune User Guide."
Neptune.9,Neptune DB clusters should be deployed across multiple Availability Zones,This control checks if an Amazon Neptune DB cluster has read-replica instances in multiple Availability Zones (AZs). The control fails if the cluster is deployed in only one AZ.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Neptune.9/remediation,,1,NIST Special Publication 800-53 Revision 5,https://docs.aws.amazon.com/securityhub/latest/userguide/neptune-controls.html#neptune-9,Recover > Resilience > High availability,AWS::RDS::DBCluster,neptune-cluster-multi-az-enabled,Change triggered,"To deploy a Neptune DB cluster in multiple AZs,, see Read-replica DB instances in a Neptune DB cluster in the Neptune User Guide."
NetworkFirewall.1,Network Firewall firewalls should be deployed across multiple Availability Zones,This control evaluates whether a firewall managed through AWS Network Firewall is deployed across multiple Availability Zones (AZs). The control fails if a firewall is deployed in only one AZ.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/NetworkFirewall.1/remediation,,1,NIST Special Publication 800-53 Revision 5,https://docs.aws.amazon.com/securityhub/latest/userguide/networkfirewall-controls.html#networkfirewall-1,Recover > Resilience > High availability,AWS::NetworkFirewall::Firewall,netfw-multi-az-enabled,Change triggered,"Deploying a Network Firewall firewall across multiple AZsOpen the Amazon VPC console at https://console.aws.amazon.com/vpc/.In the navigation pane, under Network Firewall, choose Firewalls.On the Firewalls page, select the firewall that you want to edit.On the firewall details page, choose the Firewall details tab.In the Associated policy and VPC section, choose EditTo add a new AZ, choose Add New Subnet. Select the AZ and subnet that you would like to use. Ensure that you select at least two AZs.Choose Save."
NetworkFirewall.2,Network Firewall logging should be enabled,This control checks whether logging is enabled for an AWS Network Firewall firewall. The control fails if logging isn't enabled for at least one log type or if the logging destination doesn't exist.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/NetworkFirewall.2/remediation,"Parameter: logType
Description: Log type for the rule to check for firewalls.
Type: Enum
Default Value: N/A
Min: N/A
Max: N/A
---
",2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/networkfirewall-controls.html#networkfirewall-2,Identify > Logging,AWS::NetworkFirewall::LoggingConfiguration,netfw-logging-enabled,Periodic,"To enable logging for a firewall, see Updating a firewall's logging configuration in the AWS Network Firewall Developer Guide."
NetworkFirewall.3,Network Firewall policies should have at least one rule group associated,This control checks whether a Network Firewall policy has any stateful or stateless rule groups associated. This control fails if stateless or stateful rule groups are not assigned.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/NetworkFirewall.3/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/networkfirewall-controls.html#networkfirewall-3,Protect > Secure Network Configuration,AWS::NetworkFirewall::FirewallPolicy,netfw-policy-rule-group-associated,Change triggered,"To add a rule group to a Network Firewall policy, see Updating a firewall policy in the AWS Network Firewall Developer Guide. For information about creating and managing rule groups, see Rule groups in AWS Network Firewall."
NetworkFirewall.4,The default stateless action for Network Firewall policies should be drop or forward for full packets,"This control checks whether the default stateless action for full packets for a Network Firewall policy is drop or forward. The control passes if Drop or Forward is selected, and fails if Pass is selected.",MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/NetworkFirewall.4/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/networkfirewall-controls.html#networkfirewall-4,Protect > Secure Network Configuration,AWS::NetworkFirewall::FirewallPolicy,netfw-policy-default-action-full-packets,Change triggered,"To change your firewall policy, see Updating a firewall policy in the AWS Network Firewall Developer Guide. For Stateless default actions, choose Edit. Then, choose Drop or Forward to stateful rule groups as the Action."
NetworkFirewall.5,The default stateless action for Network Firewall policies should be drop or forward for fragmented packets,"This control checks whether the default stateless action for fragmented packets for a Network Firewall policy is drop or forward. The control passes if Drop or Forward is selected, and fails if Pass is selected.",MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/NetworkFirewall.5/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/networkfirewall-controls.html#networkfirewall-5,Protect > Secure Network Configuration,AWS::NetworkFirewall::FirewallPolicy,netfw-policy-default-action-fragment-packets,Change triggered,"To change your firewall policy, see Updating a firewall policy in the AWS Network Firewall Developer Guide. For Stateless default actions, choose Edit. Then, choose Drop or Forward to stateful rule groups as the Action."
NetworkFirewall.6,Stateless network firewall rule group should not be empty,This control checks if a Stateless Network Firewall Rule Group contains rules. The rule will fail if there are no rules in a Stateless Network Firewall Rule Group.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/NetworkFirewall.6/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/networkfirewall-controls.html#networkfirewall-6,Protect > Secure Network Configuration,AWS::NetworkFirewall::RuleGroup,netfw-stateless-rule-group-not-empty,Change triggered,"To add rules to your Network Firewall rule group, see Updating a stateful rule group in the AWS Network Firewall Developer Guide. On the firewall details page, for Stateless rule group, choose Edit to add rules."
NetworkFirewall.7,Network Firewall firewalls should be tagged,"This control checks whether an AWS Network Firewall firewall has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the firewall doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the firewall isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/NetworkFirewall.7/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/networkfirewall-controls.html#networkfirewall-7,Identify > Inventory > Tagging,AWS::NetworkFirewall::Firewall,tagged-networkfirewall-firewall (custom Security Hub rule),Change triggered,"To add tags to an Network Firewall firewall, see Tagging AWS Network Firewall resources in the AWS Network Firewall Developer Guide."
NetworkFirewall.8,Network Firewall firewall policies should be tagged,"This control checks whether an AWS Network Firewall firewall policy has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the firewall policy doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the firewall policy isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/NetworkFirewall.8/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/networkfirewall-controls.html#networkfirewall-8,Identify > Inventory > Tagging,AWS::NetworkFirewall::FirewallPolicy,tagged-networkfirewall-firewallpolicy (custom Security Hub rule),Change triggered,"To add tags to an Network Firewall policy, see Tagging AWS Network Firewall resources in the AWS Network Firewall Developer Guide."
NetworkFirewall.9,Network Firewall firewalls should have deletion protection enabled,This control checks whether an AWS Network Firewall firewall has deletion protection enabled. The control fails if deletion protection isn't enabled for a firewall.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/NetworkFirewall.9/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/networkfirewall-controls.html#networkfirewall-9,Protect > Network Security,AWS::NetworkFirewall::Firewall,netfw-deletion-protection-enabled,Change triggered,"To enable delete protection on an existing Network Firewall firewall, see Updating a firewall in the AWS Network Firewall Developer Guide. For Change protections, select Enable. You can also enable deletion protection by invoking the UpdateFirewallDeleteProtection API and setting the DeleteProtection field to true."
NetworkFirewall.10,Network Firewall firewalls should have subnet change protection enabled,This control checks whether subnet change protection is enabled for an AWS Network Firewall firewall. The control fails if subnet change protection isn't enabled for the firewall.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/NetworkFirewall.10/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/networkfirewall-controls.html#networkfirewall-10,Protect > Network Security,AWS::NetworkFirewall::Firewall,netfw-subnet-change-protection-enabled,Change triggered,"For information about enabling subnet change protection for an existing Network Firewall firewall, see Updating a firewall in the AWS Network Firewall Developer Guide."
Opensearch.1,OpenSearch domains should have encryption at rest enabled,This control checks whether Amazon OpenSearch domains have encryption-at-rest configuration enabled. The check fails if encryption at rest is not enabled.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Opensearch.1/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v3.2.1",https://docs.aws.amazon.com/securityhub/latest/userguide/opensearch-controls.html#opensearch-1,Protect > Data Protection > Encryption of data-at-rest,AWS::OpenSearch::Domain,opensearch-encrypted-at-rest,Change triggered,"To enable encryption at rest for new and existing OpenSearch domains, see Enabling encryption of data at rest in the Amazon OpenSearch Service Developer Guide."
Opensearch.2,OpenSearch domains should not be publicly accessible,This control checks whether an OpenSearch domain is publicly accessible. The control fails if an OpenSearch domain is publicly accessible. It does not evaluate the VPC subnet routing configuration to determine public access.,CRITICAL,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Opensearch.2/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v3.2.1",https://docs.aws.amazon.com/securityhub/latest/userguide/opensearch-controls.html#opensearch-2,Protect > Secure network configuration > Resources within VPC,AWS::OpenSearch::Domain,opensearch-in-vpc-only,Change triggered,"If you create a domain with a public endpoint, you cannot later place it within a VPC. Instead, you must create a new domain and migrate your data. The reverse is also true. If you create a domain within a VPC, it cannot have a public endpoint. Instead, you must either create another domain or disable this control. For instructions, see Launching your Amazon OpenSearch Service domains within a VPC in the Amazon OpenSearch Service Developer Guide."
Opensearch.3,OpenSearch domains should encrypt data sent between nodes,This control checks whether Amazon OpenSearch domains have node-to-node encryption enabled. This control fails if node-to-node encryption is disabled on the domain.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Opensearch.3/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/opensearch-controls.html#opensearch-3,Protect > Data Protection > Encryption of data-in-transit,AWS::OpenSearch::Domain,opensearch-node-to-node-encryption-check,Change triggered,"To enable node-to-node encryption on an OpenSearch domain, see Enabling node-to-node encryption in the Amazon OpenSearch Service Developer Guide."
Opensearch.4,OpenSearch domain error logging to CloudWatch Logs should be enabled,This control checks whether Amazon OpenSearch domains are configured to send error logs to CloudWatch Logs. This control fails if error logging to CloudWatch is not enabled for a domain.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Opensearch.4/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/opensearch-controls.html#opensearch-4,Identify > Logging,AWS::OpenSearch::Domain,opensearch-logs-to-cloudwatch,Change triggered,"To enable log publishing, see Enabling log publishing (console) in the Amazon OpenSearch Service Developer Guide."
Opensearch.5,OpenSearch domains should have audit logging enabled,This control checks whether Amazon OpenSearch Service domains have audit logging enabled.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Opensearch.5/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/opensearch-controls.html#opensearch-5,Identify > Logging,AWS::OpenSearch::Domain,opensearch-audit-logging-enabled,Change triggered,"For instructions on enabling audit logs, see Enabling audit logs in the Amazon OpenSearch Service Developer Guide."
Opensearch.6,OpenSearch domains should have at least three data nodes,"This control checks whether Amazon OpenSearch Service domains are configured with at least three data nodes and ""zoneAwarenessEnabled"" is true.",MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Opensearch.6/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/opensearch-controls.html#opensearch-6,Recover > Resilience > High availability,AWS::OpenSearch::Domain,opensearch-data-node-fault-tolerance,Change triggered,"To modify the number of data nodes in an OpenSearch domainSign in to the AWS console and open the Amazon OpenSearch Service console at https://console.aws.amazon.com/aos/.Under My domains, choose the name of the domain to edit, and choose Edit.Under Data nodes set Number of nodes to a number greater than 3. If you are deploying to three Availability Zones, set the number to a multiple of three to ensure equal distribution across Availability Zones. Choose Submit."
Opensearch.7,OpenSearch domains should have fine-grained access control enabled,This control checks whether Amazon OpenSearch domains have fine-grained access control enabled. This control fails if the fine-grained access control is not enabled.,HIGH,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Opensearch.7/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/opensearch-controls.html#opensearch-7,Protect > Secure Access Management > Sensitive API actions restricted,AWS::OpenSearch::Domain,opensearch-access-control-enabled,Change triggered,"To enable fine-grained access control, see Fine-grained access control in Amazon OpenSearch Service in the Amazon OpenSearch Service Developer Guide."
Opensearch.8,Connections to OpenSearch domains should be encrypted using the latest TLS security policy,This controls checks whether connections to an Amazon OpenSearch Service domain are using the latest TLS security policy. The control fails if the OpenSearch domain isn't using the latest supported policy or if HTTPs isn't enabled.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Opensearch.8/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/opensearch-controls.html#opensearch-8,Protect > Data Protection > Encryption of data-in-transit,AWS::OpenSearch::Domain,opensearch-https-required,Change triggered,"To enable TLS encryption, use the UpdateDomainConfig API operation. Configure the DomainEndpointOptions field to specify the value for TLSSecurityPolicy. For more information, see Node-to-node encryption in the Amazon OpenSearch Service Developer Guide."
Opensearch.9,OpenSearch domains should be tagged,"This control checks whether an Amazon OpenSearch service domain has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the domain doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the domain isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Opensearch.9/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/opensearch-controls.html#opensearch-9,Identify > Inventory > Tagging,AWS::OpenSearch::Domain,tagged-opensearch-domain (custom Security Hub rule),Change triggered,"To add tags to an OpenSearch Service domain, see Working with tags in the Amazon OpenSearch Service Developer Guide."
Opensearch.10,OpenSearch domains should have the latest software update installed,This control checks whether an Amazon OpenSearch Service domain has the latest software update installed. The control fails if a software update is available but not installed for the domain.,LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Opensearch.10/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/opensearch-controls.html#opensearch-10,"Identify > Vulnerability, patch, and version management",AWS::OpenSearch::Domain,opensearch-update-check,Change triggered,"To install software updates for an OpenSearch domain, see Starting an update in the Amazon OpenSearch Service Developer Guide."
Opensearch.11,OpenSearch domains should have at least three dedicated primary nodes,This control checks whether an Amazon OpenSearch domain is configured with at least three dedicated primary nodes. This control fails if the domain has fewer than three dedicated primary nodes.,LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Opensearch.11/remediation,,1,NIST Special Publication 800-53 Revision 5,https://docs.aws.amazon.com/securityhub/latest/userguide/opensearch-controls.html#opensearch-11,Recover > Resilience > High availability,AWS::OpenSearch::Domain,opensearch-primary-node-fault-tolerance,Change triggered,"To change the number of primary nodes for an OpenSearch domain, see Creating and managing Amazon OpenSearch Service domains in the Amazon OpenSearch Service Developer Guide."
PCA.1,AWS Private CA root certificate authority should be disabled,This control checks if AWS Private CA has a root certificate authority (CA) that is disabled. This control fails if the root CA is enabled.,LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/PCA.1/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/pca-controls.html#pca-1,Protect > Secure network configuration,AWS::ACMPCA::CertificateAuthority,acm-pca-root-ca-disabled,Periodic,"To disable the root CA, see Update CA status in the AWS Private Certificate Authority User Guide."
PCA.2,AWS Private CA certificate authorities should be tagged,"This control checks whether an AWS Private CA certificate authority has tags with the specific keys defined in the parameter requiredKeyTags. The control fails if the certificate authority doesn't have any tag keys or if it doesn't have all the keys specified in the parameter requiredKeyTags. If the parameter requiredKeyTags isn't provided, the control only checks for the existence of a tag key and fails if the certificate authority isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/PCA.2/remediation,"Parameter: requiredKeyTags
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/pca-controls.html#pca-2,Identify > Inventory > Tagging,AWS::ACMPCA::CertificateAuthority,acmpca-certificate-authority-tagged,Change triggered,"To add tags to an AWS Private CA authority, see Add tags for your private CA in the AWS Private Certificate Authority User Guide."
RDS.1,RDS snapshot should be private,This AWS control checks if Amazon Relational Database Service (Amazon RDS) snapshots are public.,CRITICAL,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/RDS.1/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v3.2.1",https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-1,Protect > Secure network configuration,AWS::RDS::DBClusterSnapshot,rds-snapshots-public-prohibited,Change triggered,"To remove public access from RDS snapshots, see Sharing a snapshot in the Amazon RDS User Guide. For DB snapshot visibility, we choose Private."
RDS.2,"RDS DB Instances should prohibit public access, as determined by the PubliclyAccessible configuration",This AWS control checks whether RDS instances are publicly accessible by evaluating the publiclyAccessible field in the instance configuration item.,CRITICAL,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/RDS.2/remediation,,5,"AWS Foundational Security Best Practices v1.0.0, CIS AWS Foundations Benchmark v3.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v3.2.1, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-2,Protect > Secure network configuration,AWS::RDS::DBInstance,rds-instance-public-access-check,Change triggered,"To remove public access from RDS DB instances, see Modifying an Amazon RDS DB instance in the Amazon RDS User Guide. For Public access, choose No."
RDS.3,RDS DB instances should have encryption at-rest enabled,This AWS control checks whether storage encryption is enabled for your RDS DB instances.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/RDS.3/remediation,,4,"AWS Foundational Security Best Practices v1.0.0, CIS AWS Foundations Benchmark v1.4.0, CIS AWS Foundations Benchmark v3.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-3,Protect > Data Protection > Encryption of data-at-rest,AWS::RDS::DBInstance,rds-storage-encrypted,Change triggered,"For information about encrypting DB instances in Amazon RDS, see Encrypting Amazon RDS resources in the Amazon RDS User Guide."
RDS.4,RDS cluster snapshots and database snapshots should be encrypted at rest,This control checks whether Amazon RDS cluster snapshots and database snapshots are encrypted.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/RDS.4/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-4,Protect > Data Protection > Encryption of data-at-rest,AWS::RDS::DBClusterSnapshot,rds-snapshot-encrypted,Change triggered,"To encrypt an RDS snapshot, see Encrypting Amazon RDS resources in the Amazon RDS User Guide. When you encrypt an RDS DB instance, the encrypted data includes the underlying storage for the instance, its automated backups, read replicas, and snapshots. You can only encrypt an RDS DB instance when you create it, not after the DB instance is created. However, because you can encrypt a copy of an unencrypted snapshot, you can effectively add encryption to an unencrypted DB instance. That is, you can create a snapshot of your DB instance, and then create an encrypted copy of that snapshot. You can then restore a DB instance from the encrypted snapshot, and thus you have an encrypted copy of your original DB instance."
RDS.5,RDS DB instances should be configured with multiple Availability Zones,This control checks whether high availability is enabled for your RDS DB instances.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/RDS.5/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-5,Recover > Resilience > High availability,AWS::RDS::DBInstance,rds-multi-az-support,Change triggered,"To deploy your DB instances in multiple AZs, Modifying a DB instance to be a Multi-AZ DB instance deployment in the Amazon RDS User Guide."
RDS.6,Enhanced monitoring should be configured for RDS DB instances,"This control checks whether enhanced monitoring is enabled for an Amazon Relational Database Service (Amazon RDS) DB instance. The control fails if enhanced monitoring isn't enabled for the instance. If you provide a custom value for the 'monitoringInterval' parameter, the control passes only if enhanced monitoring metrics are collected for the instance at the specified interval.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/RDS.6/remediation,"Parameter: monitoringInterval
Description: Number of seconds between monitoring metric collection intervals
Type: Enum
Default Value: N/A
Min: N/A
Max: N/A
---
",2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-6,Detect > Detection services,AWS::RDS::DBInstance,rds-enhanced-monitoring-enabled,Change triggered,"For detailed instructions on enabling Enhanced Monitoring for your DB instance, see Setting up for and enabling Enhanced Monitoring in the Amazon RDS User Guide."
RDS.7,RDS clusters should have deletion protection enabled,This control checks whether RDS clusters have deletion protection enabled.,LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/RDS.7/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-7,Protect > Data protection > Data deletion protection,AWS::RDS::DBCluster,rds-cluster-deletion-protection-enabled,Change triggered,"To enable deletion protection for an RDS DB cluster, see Modifying the DB cluster by using the console, CLI, and API in the Amazon RDS User Guide. For Deletion protection, choose Enable deletion protection."
RDS.8,RDS DB instances should have deletion protection enabled,This control checks whether RDS DB instances have deletion protection enabled.,LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/RDS.8/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-8,Identify > Logging,AWS::RDS::DBInstance,rds-instance-deletion-protection-enabled,Change triggered,"To enable deletion protection for an RDS DB instance, see Modifying an Amazon RDS DB instance in the Amazon RDS User Guide. For Deletion protection, choose Enable deletion protection."
RDS.9,RDS DB instances should publish logs to CloudWatch Logs,"This control checks whether an Amazon RDS DB instance is configured to publish the following logs to Amazon CloudWatch Logs. The control fails if the instance isn’t configured to publish the following logs to CloudWatch Logs: Oracle: (Alert, Audit, Trace, Listener), PostgreSQL: (Postgresql, Upgrade), MySQL: (Audit, Error, General, SlowQuery), MariaDB: (Audit, Error, General, SlowQuery), SQL Server: (Error, Agent), Aurora: (Audit, Error, General, SlowQuery), Aurora-MySQL: (Audit, Error, General, SlowQuery), Aurora-PostgreSQL: (Postgresql).",MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/RDS.9/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-9,Identify > Logging,AWS::RDS::DBInstance,rds-logging-enabled,Change triggered,"To publish RDS database logs to CloudWatch Logs, see Specifying the logs to publish to CloudWatch Logs in the Amazon RDS User Guide."
RDS.10,IAM authentication should be configured for RDS instances,This control checks whether an RDS DB instance has IAM database authentication enabled.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/RDS.10/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-10,"Protect > Secure access management >
    Passwordless authentication",AWS::RDS::DBInstance,rds-instance-iam-authentication-enabled,Change triggered,"To activate IAM database authentication on an RDS DB instance, see Enabling and disabling IAM database authentication in the Amazon RDS User Guide."
RDS.11,RDS instances should have automatic backups enabled,"This control checks whether an Amazon Relational Database Service instance has automated backups enabled, and a backup retention period greater than or equal to the specified time frame. Read replicas are excluded from evaluation. The control fails if backups aren't enabled for the instance, or if the retention period is less than the specified time frame. Unless you provide a custom parameter value for the backup retention period, Security Hub uses a default value of 7 days.",MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/RDS.11/remediation,"Parameter: backupRetentionMinimum
Description: Minimum backup retention period in days
Type: Integer
Default Value: 7
Min: 7
Max: 35
---
",2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-11,Recover > Resilience > Backups enabled,AWS::RDS::DBInstance,db-instance-backup-enabled,Change triggered,"To enable automated backups on an RDS DB instance, see Enabling automated backups in the Amazon RDS User Guide."
RDS.12,IAM authentication should be configured for RDS clusters,This control checks if an RDS DB cluster has IAM database authentication enabled.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/RDS.12/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-12,"Protect > Secure access management >
    Passwordless authentication",AWS::RDS::DBCluster,rds-cluster-iam-authentication-enabled,Change triggered,"To enable IAM authentication for a DB cluster, see Enabling and disabling IAM database authentication in the Amazon Aurora User Guide."
RDS.13,RDS automatic minor version upgrades should be enabled,This control checks if automatic minor version upgrades are enabled for the Amazon RDS database instance.,HIGH,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/RDS.13/remediation,,4,"AWS Foundational Security Best Practices v1.0.0, CIS AWS Foundations Benchmark v3.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-13,"Identify > Vulnerability, patch, and version management",AWS::RDS::DBInstance,rds-automatic-minor-version-upgrade-enabled,Change triggered,"To enable automatic minor version upgrades for an existing DB instance, see Modifying an Amazon RDS DB instance in the Amazon RDS User Guide. For Auto minor version upgrade, select Yes."
RDS.14,Amazon Aurora clusters should have backtracking enabled,"This control checks whether an Amazon Aurora cluster has backtracking enabled. The control fails if the cluster doesn't have backtracking enabled. If you provide a custom value for the 'BacktrackWindowInHours' parameter, the control passes only if the cluster is backtracked for the specified length of time.",MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/RDS.14/remediation,"Parameter: BacktrackWindowInHours
Description: Number of hours to backtrack an Aurora MySQL cluster
Type: Double
Default Value: N/A
Min: 0.1
Max: 72.0
---
",2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-14,Recover > Resilience > Backups enabled,AWS::RDS::DBCluster,aurora-mysql-backtracking-enabled,Change triggered,"To enable Aurora backtracking, see Configuring backtracking in the Amazon Aurora User Guide. Note that you cannot enable backtracking on an existing cluster. Instead, you can create a clone that has backtracking enabled. For more information about the limitations of Aurora backtracking, see the list of limitations in Overview of backtracking."
RDS.15,RDS DB clusters should be configured for multiple Availability Zones,This control checks if Amazon RDS DB clusters are configured with multiple Availability Zones.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/RDS.15/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-15,Recover > Resilience > High availability,AWS::RDS::DBCluster,rds-cluster-multi-az-enabled,Change triggered,"To deploy your DB clusters in multiple AZs, Modifying a DB instance to be a Multi-AZ DB instance deployment in the Amazon RDS User Guide. Remediation steps differ for Aurora global databases. To configure multiple Availability Zones for an Aurora global database, select your DB cluster. Then, choose Actions and Add reader, and specify multiple AZs. For more information, see Adding Aurora Replicas to a DB cluster in the Amazon Aurora User Guide."
RDS.16,RDS DB clusters should be configured to copy tags to snapshots,This control checks whether RDS DB clusters are configured to copy all tags to snapshots when the snapshots are created.,LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/RDS.16/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-16,Identify > Inventory,AWS::RDS::DBCluster,rds-cluster-copy-tags-to-snapshots-enabled (custom Security Hub rule),Change triggered,"To automatically copy tags to snapshots for an RDS DB cluster, see Modifying the DB cluster by using the console, CLI, and API in the Amazon Aurora User Guide. Select Copy tags to snapshots."
RDS.17,RDS DB instances should be configured to copy tags to snapshots,This control checks whether RDS DB instances are configured to copy all tags to snapshots when the snapshots are created.,LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/RDS.17/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-17,Identify > Inventory,AWS::RDS::DBInstance,rds-instance-copy-tags-to-snapshots-enabled (custom Security Hub rule),Change triggered,"To automatically copy tags to snapshots for an RDS DB instance, see Modifying an Amazon RDS DB instance in the Amazon RDS User Guide. Select Copy tags to snapshots."
RDS.18,RDS instances should be deployed in a VPC,This control checks whether an RDS instance is deployed in a VPC (EC2-VPC).,HIGH,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/RDS.18/remediation,,0,N/A,https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-18,"Protect > Secure network configuration >
    Resources within VPC",AWS::RDS::DBInstance,rds-deployed-in-vpc (custom Security Hub rule),Change triggered,"For instructions on moving RDS instances to a VPC, see Updating the VPC for a DB instance in the Amazon RDS User Guide."
RDS.19,Existing RDS event notification subscriptions should be configured for critical cluster events,"This control checks whether an Amazon RDS Event subscription for RDS clusters is configured to notify on event categories of both ""maintenance"" and ""failure"".",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/RDS.19/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-19,"Detect > Detection services > Application
    monitoring",AWS::RDS::EventSubscription,rds-cluster-event-notifications-configured (custom Security Hub rule),Change triggered,"To subscribe to RDS cluster event notifications, see Subscribing to Amazon RDS event notification in the Amazon RDS User Guide. Use the following values: Field Value Source type Clusters Clusters to include All clusters Event categories to include Select specific event categories or All event categories"
RDS.20,Existing RDS event notification subscriptions should be configured for critical database instance events,"This control checks whether an Amazon RDS Event subscription for RDS instances is configured to notify on event categories of both ""maintenance"", ""configuration change"", and ""failure"".",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/RDS.20/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-20,"Detect > Detection services > Application
    monitoring",AWS::RDS::EventSubscription,rds-instance-event-notifications-configured (custom Security Hub rule),Change triggered,"To subscribe to RDS instance event notifications, see Subscribing to Amazon RDS event notification in the Amazon RDS User Guide. Use the following values: Field Value Source type Instances Instances to include All instances Event categories to include Select specific event categories or All event categories"
RDS.21,An RDS event notifications subscription should be configured for critical database parameter group events,"This control checks whether an Amazon RDS Event subscription for RDS parameter groups is configured to notify on event category of ""configuration change"".",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/RDS.21/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-21,"Detect > Detection services > Application
    monitoring",AWS::RDS::EventSubscription,rds-pg-event-notifications-configured (custom Security Hub rule),Change triggered,"To subscribe to RDS database parameter group event notifications, see Subscribing to Amazon RDS event notification in the Amazon RDS User Guide. Use the following values: Field Value Source type Parameter groups Parameter groups to include All parameter groups Event categories to include Select specific event categories or All event categories"
RDS.22,An RDS event notifications subscription should be configured for critical database security group events,"This control checks whether an Amazon RDS Event subscription for RDS security groups is configured to notify on event categories of both ""configuration change"" and ""failure"".",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/RDS.22/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-22,"Detect > Detection Services > Application
    monitoring",AWS::RDS::EventSubscription,rds-sg-event-notifications-configured (custom Security Hub rule),Change triggered,"To subscribe to RDS instance event notifications, see Subscribing to Amazon RDS event notification in the Amazon RDS User Guide. Use the following values: Field Value Source type Security groups Security groups to include All security groups Event categories to include Select specific event categories or All event categories"
RDS.23,RDS instances should not use a database engine default port,This control checks whether RDS instances use the default port of that database engine.,LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/RDS.23/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-23,Protect > Secure network configuration,AWS::RDS::DBInstance,rds-no-default-ports (custom Security Hub rule),Change triggered,"To modify the default port of an existing RDS DB instance, see Modifying an Amazon RDS DB instance in the Amazon RDS User Guide. To modify the default port of an existing RDS DB cluster, see Modifying the DB cluster by using the console, CLI, and API in the Amazon Aurora User Guide. For Database port, change the port value to a non-default value."
RDS.24,RDS Database Clusters should use a custom administrator username,This control checks whether an RDS database cluster has changed the admin username from its default value. This rule will fail if the admin username is set to the default value.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/RDS.24/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-24,Identify > Resource Configuration,AWS::RDS::DBCluster,rds-cluster-default-admin-check,Change triggered,"For changing the admin username associated with the Amazon RDS database cluster, create a new RDS database cluster and change the default admin username while creating the database."
RDS.25,RDS database instances should use a custom administrator username,This control checks whether an Amazon Relational Database Service (Amazon RDS) database instance has changed the admin username from its default value. This rule will only run on RDS database instances. The rule will fail if the admin username is set to the default value.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/RDS.25/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-25,Identify > Resource Configuration,AWS::RDS::DBInstance,rds-instance-default-admin-check,Change triggered,"To change the administrative username associated with an RDS database instance, first create a new RDS database instance. Change the default administrative username while creating the database."
RDS.26,RDS DB instances should be protected by a backup plan,"This control evaluates if Amazon RDS DB instances are covered by a backup plan. This control fails if an RDS DB instance isn't covered by a backup plan. If you provide a custom value for the 'backupVaultLockCheck' parameter, the control passes only if the instance is backed up in an AWS Backup locked vault.",MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/RDS.26/remediation,"Parameter: backupVaultLockCheck
Description: The control produces a PASSED finding if the parameter is set to true and the resource uses AWS Backup Vault Lock
Type: Boolean
Default Value: N/A
Min: N/A
Max: N/A
---
",1,NIST Special Publication 800-53 Revision 5,https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-26,Recover > Resilience > Backups enabled,AWS::RDS::DBInstance,rds-resources-protected-by-backup-plan,Periodic,"To add an RDS DB instance to an AWS Backup backup plan, see Assigning resources to a backup plan in the AWS Backup Developer Guide."
RDS.27,RDS DB clusters should be encrypted at rest,This control checks if an RDS DB cluster is encrypted at rest. The control fails if an RDS DB cluster isn't encrypted at rest.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/RDS.27/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-27,Protect > Data Protection > Encryption of data-at-rest,AWS::RDS::DBCluster,rds-cluster-encrypted-at-rest,Change triggered,"You can enable encryption at rest when you create an RDS DB cluster. You can't change encryption settings after creating a cluster. For more information, see Encrypting an Amazon Aurora DB cluster in the Amazon Aurora User Guide."
RDS.28,RDS DB clusters should be tagged,"This control checks whether an Amazon RDS DB cluster has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the DB cluster doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the DB cluster isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/RDS.28/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-28,Identify > Inventory > Tagging,AWS::RDS::DBCluster,tagged-rds-dbcluster (custom Security Hub rule),Change triggered,"To add tags to an RDS DB cluster, see Tagging Amazon RDS resources in the Amazon RDS User Guide."
RDS.29,RDS DB cluster snapshots should be tagged,"This control checks whether an Amazon RDS DB cluster snapshot has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the DB cluster snapshot doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the DB cluster snapshot isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/RDS.29/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-29,Identify > Inventory > Tagging,AWS::RDS::DBClusterSnapshot,tagged-rds-dbclustersnapshot (custom Security Hub rule),Change triggered,"To add tags to an RDS DB cluster snapshot, see Tagging Amazon RDS resources in the Amazon RDS User Guide."
RDS.30,RDS DB instances should be tagged,"This control checks whether an Amazon RDS DB instance has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the DB instance doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the DB instance isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/RDS.30/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-30,Identify > Inventory > Tagging,AWS::RDS::DBInstance,tagged-rds-dbinstance (custom Security Hub rule),Change triggered,"To add tags to an RDS DB instance, see Tagging Amazon RDS resources in the Amazon RDS User Guide."
RDS.31,RDS DB security groups should be tagged,"This control checks whether an Amazon RDS DB security group has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the DB security group doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the DB security group isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,UNAVAILABLE,https://docs.aws.amazon.com/console/securityhub/RDS.31/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-31,Identify > Inventory > Tagging,AWS::RDS::DBSecurityGroup,tagged-rds-dbsecuritygroup (custom Security Hub rule),Change triggered,"To add tags to an RDS DB security group, see Tagging Amazon RDS resources in the Amazon RDS User Guide."
RDS.32,RDS DB snapshots should be tagged,"This control checks whether an Amazon RDS DB snapshot has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the DB snapshot doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the DB snapshot isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/RDS.32/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-32,Identify > Inventory > Tagging,AWS::RDS::DBSnapshot,tagged-rds-dbsnapshot (custom Security Hub rule),Change triggered,"To add tags to an RDS DB snapshot, see Tagging Amazon RDS resources in the Amazon RDS User Guide."
RDS.33,RDS DB subnet groups should be tagged,"This control checks whether an Amazon RDS DB subnet group has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the DB subnet group doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the DB subnet group isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/RDS.33/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-33,Identify > Inventory > Tagging,AWS::RDS::DBSubnetGroup,tagged-rds-dbsubnetgroups (custom Security Hub rule),Change triggered,"To add tags to an RDS DB subnet group, see Tagging Amazon RDS resources in the Amazon RDS User Guide."
RDS.34,Aurora MySQL DB clusters should publish audit logs to CloudWatch Logs,This control checks whether an Amazon Aurora MySQL DB cluster is configured to publish audit logs to Amazon CloudWatch Logs. The control fails if the cluster isn’t configured to publish audit logs to CloudWatch Logs.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/RDS.34/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-34,Identify > Logging,AWS::RDS::DBCluster,rds-aurora-mysql-audit-logging-enabled,Change triggered,"To publish Aurora MySQL DB cluster audit logs to CloudWatch Logs, see Publishing Amazon Aurora MySQL logs to Amazon CloudWatch Logs in the Amazon Aurora User Guide."
RDS.35,RDS DB clusters should have automatic minor version upgrade enabled,This control checks if automatic minor version upgrade is enabled for an Amazon RDS database cluster. This control fails if automatic minor version upgrade isn't enabled for an RDS cluster.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/RDS.35/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-35,"Identify > Vulnerability, patch, and version management",AWS::RDS::DBCluster,rds-cluster-auto-minor-version-upgrade-enable,Change triggered,"To enable automatic minor version upgrade on Multi-AZ DB clusters, see Modifying a Multi-AZ DB cluster in the Amazon RDS User Guide."
RDS.36,RDS for PostgreSQL DB instances should publish logs to CloudWatch Logs,This control checks whether an Amazon RDS for PostgreSQL DB instance is configured to publish logs to Amazon CloudWatch Logs. The control fails if the PostgreSQL DB instance isn't configured to publish the log types mentioned in the 'logTypes' parameter to CloudWatch Logs.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/RDS.36/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-36,Identify > Logging,AWS::RDS::DBInstance,rds-postgresql-logs-to-cloudwatch,Change triggered,"To publish PostgreSQL DB instance logs to CloudWatch Logs, see Publishing PostgreSQL logs to Amazon CloudWatch Logs in the Amazon RDS User Guide."
RDS.37,Aurora PostgreSQL DB clusters should publish logs to CloudWatch Logs,This control checks whether an Amazon Aurora PostgreSQL DB cluster is configured to publish PostgreSQL logs to Amazon CloudWatch Logs. The control fails if the Aurora PostgreSQL DB cluster isn't configured to publish PostgreSQL logs to CloudWatch Logs.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/RDS.37/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-37,Identify > Logging,AWS::RDS::DBCluster,rds-aurora-postgresql-logs-to-cloudwatch,Change triggered,"To publish Aurora PostgreSQL DB cluster logs to CloudWatch Logs, see Publishing Aurora PostgreSQL logs to Amazon CloudWatch Logs in the Amazon RDS User Guide."
RDS.38,RDS for PostgreSQL DB instances should be encrypted in transit,This control checks whether a connection to an Amazon RDS for PostgreSQL database (DB) instance is encrypted in transit. The control fails if the rds.force_ssl parameter for the parameter group associated with the instance is set to 0.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/RDS.38/remediation,,1,AWS Foundational Security Best Practices v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-38,Protect > Data Protection > Encryption of data-in-transit,AWS::RDS::DBInstance,rds-postgres-instance-encrypted-in-transit,Periodic,"To require all connections to your RDS for PostgreSQL DB instance to use SSL, see Using SSL with a PostgreSQL DB instance in the Amazon RDS User Guide."
RDS.39,RDS for MySQL DB instances should be encrypted in transit,This control checks whether a connection to an Amazon RDS for MySQL database (DB) instance is encrypted in transit. The control fails if the rds.require_secure_transport parameter for the parameter group associated with the instance is set to 0 (off).,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/RDS.39/remediation,,1,AWS Foundational Security Best Practices v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-39,Protect > Data Protection > Encryption of data-in-transit,AWS::RDS::DBInstance,rds-mysql-instance-encrypted-in-transit,Periodic,"To require all connections to your RDS for MySQL DB instance to use SSL, see SSL/TLS support for MySQL DB instances on Amazon RDS in the Amazon RDS User Guide."
RDS.40,RDS for SQL Server DB instances should publish logs to CloudWatch Logs,This control checks whether an Amazon RDS for Microsoft SQL Server DB instance is configured to publish logs to Amazon CloudWatch Logs. The control fails if the RDS for SQL Server DB instance isn't configured to publish logs to CloudWatch Logs. You can optionally specify the types of logs that a DB instance should be configured to publish.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/RDS.40/remediation,"Parameter: logTypes
Description: A list of the types of logs that an RDS for SQL Server DB instance should be configured to publish to CloudWatch Logs. This control fails if a DB instance isn't configured to publish a type of log specified in the list.
Type: EnumList
Default Value: ['agent', 'error']
Min: N/A
Max: N/A
---
",2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-40,Identify > Logging,AWS::RDS::DBInstance,rds-sql-server-logs-to-cloudwatch,Change triggered,"For information about publishing logs to CloudWatch Logs for an RDS for SQL Server DB instance, see Amazon RDS for Microsoft SQL Server database log files in the Amazon Relational Database Service User Guide."
Redshift.1,Amazon Redshift clusters should prohibit public access,This control checks whether Amazon Redshift clusters are publicly accessible. It evaluates the publiclyAccessible field in the cluster configuration item.,CRITICAL,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Redshift.1/remediation,,4,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v3.2.1, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/redshift-controls.html#redshift-1,"Protect > Secure network configuration >
    Resources not publicly accessible",AWS::Redshift::Cluster,redshift-cluster-public-access-check,Change triggered,"To update an Amazon Redshift cluster to disable public access, see Modifying a cluster in the Amazon Redshift Management Guide. Set Publicly accessible to No."
Redshift.2,Connections to Amazon Redshift clusters should be encrypted in transit,This control checks whether connections to Amazon Redshift clusters are required to use encryption in transit. The check fails if the Amazon Redshift cluster parameter require_SSL is not set to 1.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Redshift.2/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/redshift-controls.html#redshift-2,Protect > Data Protection > Encryption of data-in-transit,AWS::Redshift::Cluster,redshift-require-tls-ssl,Change triggered,"To update an Amazon Redshift parameter group to require encryption, see Modifying a parameter group in the Amazon Redshift Management Guide. Set require_ssl to True."
Redshift.3,Amazon Redshift clusters should have automatic snapshots enabled,"This control checks whether an Amazon Redshift cluster has automated snapshots enabled, and a retention period greater than or equal to the specified time frame. The control fails if automated snapshots aren't enabled for the cluster, or if the retention period is less than the specified time frame. Unless you provide a custom parameter value for the retention period, Security Hub uses a default value of 7 days.",MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Redshift.3/remediation,"Parameter: MinRetentionPeriod
Description: Minimum snapshot retention period in days
Type: Integer
Default Value: 7
Min: 7
Max: 35
---
",2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/redshift-controls.html#redshift-3,Recover > Resilience > Backups enabled,AWS::Redshift::Cluster,redshift-backup-enabled,Change triggered,"To update the snapshot retention period for an Amazon Redshift cluster, see Modifying a cluster in the Amazon Redshift Management Guide. For Backup, set Snapshot retention to a value of 7 or greater."
Redshift.4,Amazon Redshift clusters should have audit logging enabled,This control checks whether an Amazon Redshift cluster has audit logging enabled.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Redshift.4/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/redshift-controls.html#redshift-4,Identify > Logging,AWS::Redshift::Cluster,redshift-cluster-audit-logging-enabled (custom Security Hub rule),Change triggered,"To configure audit logging for an Amazon Redshift cluster, see Configuring auditing using the console in the Amazon Redshift Management Guide."
Redshift.6,Amazon Redshift should have automatic upgrades to major versions enabled,This control checks whether an Amazon Redshift cluster is configured with automatic upgrades to major versions.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Redshift.6/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/redshift-controls.html#redshift-6,"Identify > Vulnerability, patch, and version management",AWS::Redshift::Cluster,redshift-cluster-maintenancesettings-check,Change triggered,"To remediate this issue from the AWS CLI, use the Amazon Redshift modify-cluster command, and set the --allow-version-upgrade attribute. clustername is the name of your Amazon Redshift cluster."
Redshift.7,Redshift clusters should use enhanced VPC routing,This control checks whether a Redshift cluster has EnhancedVpcRouting enabled.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Redshift.7/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/redshift-controls.html#redshift-7,Protect > Secure network configuration > API private access,AWS::Redshift::Cluster,redshift-enhanced-vpc-routing-enabled,Change triggered,"For detailed remediation instructions, see Enabling enhanced VPC routing in the Amazon Redshift Management Guide."
Redshift.8,Amazon Redshift clusters should not use the default Admin username,This control checks whether a Redshift cluster has changed the Admin username from its default value. This control will fail if the admin username for a Redshift cluster is set to 'awsuser'.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Redshift.8/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/redshift-controls.html#redshift-8,Identify > Resource Configuration,AWS::Redshift::Cluster,redshift-default-admin-check,Change triggered,"You can't change the admin username for your Amazon Redshift cluster after creating it. To create a new cluster with a non-default username, see Step 1: Create a sample Amazon Redshift cluster in the Amazon Redshift Getting Started Guide."
Redshift.9,Redshift clusters should not use the default database name,This control checks whether a Redshift cluster has changed the database name from its default value. This control will fail if the database name for a Redshift cluster is set to “dev”,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Redshift.9/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/redshift-controls.html#redshift-9,Identify > Resource Configuration,AWS::Redshift::Cluster,redshift-default-db-name-check,Change triggered,"You can't change the database name for your Amazon Redshift cluster after it is created. For instructions on creating a new cluster, see Getting started with Amazon Redshift in the Amazon Redshift Getting Started Guide."
Redshift.10,Redshift clusters should be encrypted at rest,This control checks if an Amazon Redshift cluster is encrypted at rest. The control fails if a Redshift cluster isn't encrypted at rest.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Redshift.10/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/redshift-controls.html#redshift-10,Protect > Data Protection > Encryption of data-at-rest,AWS::Redshift::Cluster,redshift-cluster-kms-enabled,Change triggered,"To modify a Redshift cluster to use KMS encryption, see Changing cluster encryption in the Amazon Redshift Management Guide."
Redshift.11,Redshift clusters should be tagged,"This control checks whether an Amazon Redshift cluster set has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the cluster doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the cluster isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Redshift.11/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/redshift-controls.html#redshift-11,Identify > Inventory > Tagging,AWS::Redshift::Cluster,tagged-redshift-cluster (custom Security Hub rule),Change triggered,"To add tags to a Redshift cluster, see Tagging resources in Amazon Redshift in the Amazon Redshift Management Guide."
Redshift.12,Redshift event notification subscriptions should be tagged,"This control checks whether an Amazon Redshift event notification subscription has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the event notification subscription doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the event notification subscription isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Redshift.12/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/redshift-controls.html#redshift-12,Identify > Inventory > Tagging,AWS::Redshift::EventSubscription,tagged-redshift-eventsubscription (custom Security Hub rule),Change triggered,"To add tags to a Redshift event notification subscription, see Tagging resources in Amazon Redshift in the Amazon Redshift Management Guide."
Redshift.13,Redshift cluster snapshots should be tagged,"This control checks whether an Amazon Redshift cluster snapshot has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the cluster snapshot doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the cluster snapshot isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Redshift.13/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/redshift-controls.html#redshift-13,Identify > Inventory > Tagging,AWS::Redshift::ClusterSnapshot,tagged-redshift-clustersnapshot (custom Security Hub rule),Change triggered,"To add tags to a Redshift cluster snapshot, see Tagging resources in Amazon Redshift in the Amazon Redshift Management Guide."
Redshift.14,Redshift cluster subnet groups should be tagged,"This control checks whether an Amazon Redshift cluster subnet group has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the cluster subnet group doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the cluster subnet group isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Redshift.14/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/redshift-controls.html#redshift-14,Identify > Inventory > Tagging,AWS::Redshift::ClusterSubnetGroup,tagged-redshift-clustersubnetgroup (custom Security Hub rule),Change triggered,"To add tags to a Redshift cluster subnet group, see Tagging resources in Amazon Redshift in the Amazon Redshift Management Guide."
Redshift.15,Redshift security groups should allow ingress on the cluster port only from restricted origins,This control checks whether a security group associated with an Amazon Redshift cluster has ingress rules that permit access to the cluster port from the internet (0.0.0.0/0 or ::/0). The control fails if the security group ingress rules permit access to the cluster port from the internet.,HIGH,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Redshift.15/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/redshift-controls.html#redshift-15,Protect > Secure network configuration > Security group configuration,AWS::Redshift::Cluster,redshift-unrestricted-port-access,Periodic,"To restrict ingress on the Redshift cluster port to restricted origins, see Work with security group rules in the Amazon VPC User Guide. Update rules where the port range matches the Redshift cluster port and the IP port range is 0.0.0.0/0."
Redshift.16,Redshift cluster subnet groups should have subnets from multiple Availability Zones,The control checks whether an Amazon Redshift cluster subnet group has subnets from more than one Availability Zone (AZ). The control fails if the cluster subnet group doesn't have subnets from at least two different AZs.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Redshift.16/remediation,,1,NIST Special Publication 800-53 Revision 5,https://docs.aws.amazon.com/securityhub/latest/userguide/redshift-controls.html#redshift-16,Recover > Resilience > High availability,AWS::Redshift::ClusterSubnetGroup,redshift-cluster-subnet-group-multi-az,Change triggered,"To modify a Redshift cluster subnet group to span multiple AZs, see Modifying a cluster subnet group in the Amazon Redshift Management Guide."
Route53.1,Route 53 health checks should be tagged,"This control checks whether an Amazon Route 53 health check has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the health check doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the health check isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,UNAVAILABLE,https://docs.aws.amazon.com/console/securityhub/Route53.1/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/route53-controls.html#route53-1,Identify > Inventory > Tagging,AWS::Route53::HealthCheck,tagged-route53-healthcheck (custom Security Hub rule),Change triggered,"To add tags to a Route 53 health check, see Naming and tagging health checks in the Amazon Route 53 Developer Guide."
Route53.2,Route 53 public hosted zones should log DNS queries,This control checks if DNS query logging is enabled for an Amazon Route 53 public hosted zone. The control fails if DNS query logging isn't enabled for a Route 53 public hosted zone.,MEDIUM,UNAVAILABLE,https://docs.aws.amazon.com/console/securityhub/Route53.2/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/route53-controls.html#route53-2,Identify > Logging,AWS::Route53::HostedZone,route53-query-logging-enabled,Change triggered,"To log DNS queries for Route 53 public hosted zones, see Configuring logging for DNS queries in the Amazon Route 53 Developer Guide."
S3.1,S3 general purpose buckets should have block public access settings enabled,This control checks whether the preceding Amazon S3 block public access settings are configured at the account level for an S3 general purpose bucket. The control fails if one or more of the block public access settings are set to false.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/S3.1/remediation,,6,"AWS Foundational Security Best Practices v1.0.0, CIS AWS Foundations Benchmark v1.4.0, CIS AWS Foundations Benchmark v3.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v3.2.1, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/s3-controls.html#s3-1,Protect > Secure network configuration,AWS::::Account,s3-account-level-public-access-blocks-periodic,Periodic,"To enable Amazon S3 Block Public Access for your AWS account, see Configuring block public access settings for your account in the Amazon Simple Storage Service User Guide."
S3.2,S3 general purpose buckets should block public read access,"This control checks whether an Amazon S3 general purpose bucket permits public read access. It evaluates the block public access settings, the bucket policy, and the bucket access control list (ACL). The control fails if the bucket permits public read access.",CRITICAL,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/S3.2/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v3.2.1",https://docs.aws.amazon.com/securityhub/latest/userguide/s3-controls.html#s3-2,Protect > Secure network configuration,AWS::S3::Bucket,s3-bucket-public-read-prohibited,Periodic and change triggered,"To block public read access on your Amazon S3 buckets, see Configuring block public access settings for your S3 buckets in the Amazon Simple Storage Service User Guide."
S3.3,S3 general purpose buckets should block public write access,"This control checks whether an Amazon S3 general purpose bucket permits public write access. It evaluates the block public access settings, the bucket policy, and the bucket access control list (ACL). The control fails if the bucket permits public write access.",CRITICAL,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/S3.3/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v3.2.1",https://docs.aws.amazon.com/securityhub/latest/userguide/s3-controls.html#s3-3,Protect > Secure network configuration,AWS::S3::Bucket,s3-bucket-public-write-prohibited,Periodic and change triggered,"To block public write access on your Amazon S3 buckets, see Configuring block public access settings for your S3 buckets in the Amazon Simple Storage Service User Guide."
S3.5,S3 general purpose buckets should require requests to use SSL,This control checks whether an Amazon S3 general purpose bucket has a policy that requires requests to use SSL. The control fails if the bucket policy doesn't require requests to use SSL.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/S3.5/remediation,,6,"AWS Foundational Security Best Practices v1.0.0, CIS AWS Foundations Benchmark v1.4.0, CIS AWS Foundations Benchmark v3.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v3.2.1, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/s3-controls.html#s3-5,Protect > Secure access management,AWS::S3::Bucket,s3-bucket-ssl-requests-only,Change triggered,"To update an Amazon S3 bucket policy to deny nonsecure transport, see Adding a bucket policy by using the Amazon S3 console in the Amazon Simple Storage Service User Guide. Add a policy statement similar to the one in the following policy. Replace amzn-s3-demo-bucket with the name of the bucket you're modifying. For more information, see What S3 bucket policy should I use to comply with the AWS Config rule s3-bucket-ssl-requests-only? in the AWS Official Knowledge Center."
S3.6,S3 general purpose bucket policies should restrict access to other AWS accounts,This control checks whether an Amazon S3 general purpose bucket policy prevents principals from other AWS accounts from performing denied actions on resources in the S3 bucket. The control fails if the bucket policy allows one or more of the preceding actions for a principal in another AWS account.,HIGH,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/S3.6/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/s3-controls.html#s3-6,"Protect > Secure access management > Sensitive
    API operations actions restricted",AWS::S3::Bucket,s3-bucket-blacklisted-actions-prohibited,Change triggered,"To update an Amazon S3 bucket policy to remove permissions, see.Adding a bucket policy by using the Amazon S3 console in the Amazon Simple Storage Service User Guide. On the Edit bucket policy page, in the policy editing text box, take one of the following actions: Remove the statements that grant other AWS accounts access to denied actions. Remove the permitted denied actions from the statements."
S3.7,S3 general purpose buckets should use cross-Region replication,This control checks whether an Amazon S3 general purpose bucket has cross-Region replication enabled. The control fails if the bucket doesn't have cross-Region replication enabled.,LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/S3.7/remediation,,2,"NIST Special Publication 800-53 Revision 5, PCI DSS v3.2.1",https://docs.aws.amazon.com/securityhub/latest/userguide/s3-controls.html#s3-7,Protect > Secure access management,AWS::S3::Bucket,s3-bucket-cross-region-replication-enabled,Change triggered,"To enable Cross-Region Replication on an S3 bucket, see Configuring replication for source and destination buckets owned by the same account in the Amazon Simple Storage Service User Guide. For Source bucket, choose Apply to all objects in the bucket."
S3.8,S3 general purpose buckets should block public access,"This control checks whether an Amazon S3 general purpose bucket blocks public access at the bucket level. The control fails if any of the following settings are set to false: ignorePublicAcls, blockPublicPolicy, blockPublicAcls, restrictPublicBuckets.",HIGH,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/S3.8/remediation,,5,"AWS Foundational Security Best Practices v1.0.0, CIS AWS Foundations Benchmark v1.4.0, CIS AWS Foundations Benchmark v3.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/s3-controls.html#s3-8,"Protect > Secure access management > Access
    control",AWS::S3::Bucket,s3-bucket-level-public-access-prohibited,Change triggered,"For information on how to remove public access at a bucket level, see Blocking public access to your Amazon S3 storage in the Amazon S3 User Guide."
S3.9,S3 general purpose buckets should have server access logging enabled,"This control checks whether server access logging is enabled for an Amazon S3 general purpose bucket. The control fails if server access logging isn't enabled. When logging is enabled, Amazon S3 delivers access logs for a source bucket to a chosen target bucket. The target bucket must be in the same AWS Region as the source bucket and must not have a default retention period configured. The target logging bucket does not need to have server access logging enabled, and you should suppress findings for this bucket.",MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/S3.9/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/s3-controls.html#s3-9,Identify > Logging,AWS::S3::Bucket,s3-bucket-logging-enabled,Change triggered,"To enable Amazon S3 server access logging, see Enabling Amazon S3 server access logging in the Amazon S3 User Guide."
S3.10,S3 general purpose buckets with versioning enabled should have Lifecycle configurations,This control checks whether an Amazon S3 general purpose versioned bucket has a Lifecycle configuration. The control fails if the bucket doesn't have a Lifecycle configuration.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/S3.10/remediation,,1,NIST Special Publication 800-53 Revision 5,https://docs.aws.amazon.com/securityhub/latest/userguide/s3-controls.html#s3-10,Identify > Logging,AWS::S3::Bucket,s3-version-lifecycle-policy-check,Change triggered,"For more information on configuring lifecycle on an Amazon S3 bucket, see Setting lifecycle configuration on a bucket and Managing your storage lifecycle."
S3.11,S3 general purpose buckets should have event notifications enabled,"This control checks whether S3 Event Notifications are enabled on an Amazon S3 general purpose bucket. The control fails if S3 Event Notifications are not enabled on a bucket. If you provide custom values for the 'eventTypes' parameter, the control passes only if event notifications are enabled for the specified types of events.",MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/S3.11/remediation,"Parameter: eventTypes
Description:  List of preferred S3 event types
Type: EnumList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,NIST Special Publication 800-53 Revision 5,https://docs.aws.amazon.com/securityhub/latest/userguide/s3-controls.html#s3-11,Identify > Logging,AWS::S3::Bucket,s3-event-notifications-enabled,Change triggered,"For information about detecting changes to S3 buckets and objects, see Amazon S3 Event Notifications in the Amazon S3 User Guide."
S3.12,ACLs should not be used to manage user access to S3 general purpose buckets,This control checks whether an Amazon S3 general purpose bucket provides user permissions with an access control list (ACL). The control fails if an ACL is configured for managing user access on the bucket.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/S3.12/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/s3-controls.html#s3-12,Protect > Secure access management > Access control,AWS::S3::Bucket,s3-bucket-acl-prohibited,Change triggered,"To pass this control, you should disable ACLs for your S3 buckets. For instructions, see Controlling ownership of objects and disabling ACLs for your bucket in the Amazon Simple Storage Service User Guide. To create an S3 bucket policy, see Adding a bucket policy by using the Amazon S3 console. To create an IAM user policy on an S3 bucket, see Controlling access to a bucket with user policies."
S3.13,S3 general purpose buckets should have Lifecycle configurations,"This control checks whether an Amazon S3 general purpose bucket has a Lifecycle configuration. The control fails if the bucket doesn't have a Lifecycle configuration. You can provide custom values for one or more if the preceding parameters, the control passes only if the policy includes the specified storage class, deletion time, and transition time.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/S3.13/remediation,"Parameter: targetTransitionDays
Description: Number of days after object creation when objects are transitioned to a specified storage class
Type: Integer
Default Value: N/A
Min: 1
Max: 36500
---
Parameter: targetExpirationDays
Description: Number of days after object creation when objects are deleted
Type: Integer
Default Value: N/A
Min: 1
Max: 36500
---
Parameter: targetTransitionStorageClass
Description: Destination S3 storage class type
Type: Enum
Default Value: N/A
Min: N/A
Max: N/A
---
",2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/s3-controls.html#s3-13,Protect > Data protection,AWS::S3::Bucket,s3-lifecycle-policy-check,Change triggered,"For information about configuring lifecycle policies on an Amazon S3 bucket, see Setting lifecycle configuration on a bucket and see Managing your storage lifecycle in the Amazon S3 User Guide."
S3.14,S3 general purpose buckets should have versioning enabled,This control checks whether an Amazon S3 general purpose bucket has versioning enabled. The control fails if versioning is suspended for the bucket.,LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/S3.14/remediation,,1,NIST Special Publication 800-53 Revision 5,https://docs.aws.amazon.com/securityhub/latest/userguide/s3-controls.html#s3-14,Protect > Data protection > Data deletion protection,AWS::S3::Bucket,s3-bucket-versioning-enabled,Change triggered,"To use versioning on an S3 bucket, see Enabling versioning on buckets in the Amazon S3 User Guide."
S3.15,S3 general purpose buckets should have Object Lock enabled,"This control checks whether an Amazon S3 general purpose bucket has Object Lock enabled. The control fails if Object Lock isn’t enabled for the bucket. If you provide a custom value for the 'mode' parameter, the control passes only if S3 Object Lock uses the specified retention mode.",MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/S3.15/remediation,"Parameter: mode
Description: S3 Object Lock retention mode
Type: Enum
Default Value: N/A
Min: N/A
Max: N/A
---
",2,"NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/s3-controls.html#s3-15,Protect > Data protection > Data deletion protection,AWS::S3::Bucket,s3-bucket-default-lock-enabled,Change triggered,"To configure Object Lock for new and existing S3 buckets, see Configuring S3 Object Lock in the Amazon S3 User Guide."
S3.17,S3 general purpose buckets should be encrypted at rest with AWS KMS keys,This control checks whether an Amazon S3 general purpose bucket is encrypted with an AWS KMS key (SSE-KMS or DSSE-KMS). The control fails if the bucket is encrypted with default encryption (SSE-S3).,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/S3.17/remediation,,2,"NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/s3-controls.html#s3-17,Protect > Data Protection > Encryption of data-at-rest,AWS::S3::Bucket,s3-default-encryption-kms,Change triggered,"To encrypt an S3 bucket using SSE-KMS, see Specifying server-side encryption with AWS KMS (SSE-KMS) in the Amazon S3 User Guide. To encrypt an S3 bucket using DSSE-KMS, see Specifying dual-layer server-side encryption with AWS KMS keys (DSSE-KMS) in the Amazon S3 User Guide."
S3.19,S3 access points should have block public access settings enabled,This control checks whether an Amazon S3 access point has block public access settings enabled. The control fails if block public access settings aren't enabled for the access point.,CRITICAL,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/S3.19/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/s3-controls.html#s3-19,Protect > Secure access management > Resource not publicly accessible,AWS::S3::AccessPoint,s3-access-point-public-access-blocks,Change triggered,"Amazon S3 currently doesn't support changing an access point's block public access settings after the access point has been created. All block public access settings are enabled by default when you create a new access point. We recommend that you keep all settings enabled unless you know that you have a specific need to disable any of them. For more information, see Managing public access to access points in the Amazon Simple Storage Service User Guide."
S3.20,S3 general purpose buckets should have MFA delete enabled,This control checks if multi-factor authentication (MFA) delete is enabled on an Amazon S3 general purpose bucket. The control fails if MFA delete isn't enabled on the bucket.,LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/S3.20/remediation,,3,"CIS AWS Foundations Benchmark v1.4.0, CIS AWS Foundations Benchmark v3.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/s3-controls.html#s3-20,Protect > Data protection > Data deletion protection,AWS::S3::Bucket,s3-bucket-mfa-delete-enabled,Change triggered,"To enable S3 Versioning and configure MFA delete on a bucket, see Configuring MFA delete in the Amazon Simple Storage Service User Guide."
S3.22,S3 general purpose buckets should log object-level write events,This control checks whether an AWS account has at least one AWS CloudTrail multi-Region trail that logs all write data events for Amazon S3 buckets. The control fails if the account doesn't have a multi-Region trail that logs write data events for S3 buckets.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/S3.22/remediation,,2,"CIS AWS Foundations Benchmark v3.0.0, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/s3-controls.html#s3-22,Identify > Logging,AWS::::Account,cloudtrail-all-write-s3-data-event-check,Periodic,"To enable object-level logging for S3 buckets, see Enabling CloudTrail event logging for S3 buckets and objects in the Amazon Simple Storage Service User Guide."
S3.23,S3 general purpose buckets should log object-level read events,This control checks whether an AWS account has at least one AWS CloudTrail multi-Region trail that logs all read data events for Amazon S3 buckets. The control fails if the account doesn't have a multi-Region trail that logs read data events for S3 buckets.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/S3.23/remediation,,2,"CIS AWS Foundations Benchmark v3.0.0, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/s3-controls.html#s3-23,Identify > Logging,AWS::::Account,cloudtrail-all-read-s3-data-event-check,Periodic,"To enable object-level logging for S3 buckets, see Enabling CloudTrail event logging for S3 buckets and objects in the Amazon Simple Storage Service User Guide."
S3.24,S3 Multi-Region Access Points should have block public access settings enabled,This control checks whether an Amazon S3 Multi-Region Access Point has block public access settings enabled. The control fails if the Multi-Region Access Point doesn't have block public access settings enabled.,HIGH,UNAVAILABLE,https://docs.aws.amazon.com/console/securityhub/S3.24/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/s3-controls.html#s3-24,Protect > Secure network configuration > Resources not publicly accessible,AWS::S3::MultiRegionAccessPoint,s3-mrap-public-access-blocked (custom Security Hub rule),Change triggered,"By default, all Block Public Access settings are enabled for an S3 Multi-Region Access Point. For more information , see Blocking public access with Amazon S3 Multi-Region Access Points in the Amazon Simple Storage Service User Guide. You can't change the Block Public Access settings for a Multi-Region Access Point after it has been created."
SES.1,SES contact lists should be tagged,"This control checks whether an Amazon SES contact list has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the contact list doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the contact list isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/SES.1/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/ses-controls.html#ses-1,Identify > Inventory > Tagging,AWS::SES::ContactList,tagged-ses-contactlist (custom Security Hub rule),Change triggered,"To add tags to an Amazon SES contact list, see TagResource in the Amazon SES API v2 Reference."
SES.2,SES configuration sets should be tagged,"This control checks whether an Amazon SES configuration set has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the configuration set doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the configuration set isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/SES.2/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/ses-controls.html#ses-2,Identify > Inventory > Tagging,AWS::SES::ConfigurationSet,tagged-ses-configurationset (custom Security Hub rule),Change triggered,"To add tags to an Amazon SES configuration set, see TagResource in the Amazon SES API v2 Reference."
SNS.1,SNS topics should be encrypted at-rest using AWS KMS,This control checks whether an SNS topic is encrypted at rest using AWS KMS. The controls fails if an SNS topic doesn't use a KMS key for server-side encryption (SSE).,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/SNS.1/remediation,,1,NIST Special Publication 800-53 Revision 5,https://docs.aws.amazon.com/securityhub/latest/userguide/sns-controls.html#sns-1,Protect > Data Protection > Encryption of data-at-rest,AWS::SNS::Topic,sns-encrypted-kms,Change triggered,"To enable SSE for an SNS topic, see Enabling server-side encryption (SSE) for an Amazon SNS topic in the Amazon Simple Notification Service Developer Guide. Before you can use SSE, you must also configure AWS KMS key policies to allow encryption of topics and encryption and decryption of messages. For more information, see Configuring AWS KMS permissions in the Amazon Simple Notification Service Developer Guide."
SNS.3,SNS topics should be tagged,"This control checks whether an Amazon SNS topic has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the topic doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the topic isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/SNS.3/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/sns-controls.html#sns-3,Identify > Inventory > Tagging,AWS::SNS::Topic,tagged-sns-topic (custom Security Hub rule),Change triggered,"To add tags to an SNS topic, see Configuring Amazon SNS topic tags in the Amazon Simple Notification Service Developer Guide."
SNS.4,SNS topic access policies should not allow public access,This control checks whether an Amazon SNS topic access policy allows public access. The control fails if the SNS topic access policy allows public access.,HIGH,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/SNS.4/remediation,,1,AWS Foundational Security Best Practices v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/sns-controls.html#sns-4,Protect > Secure network configuration > Resources not publicly accessible,AWS::SNS::Topic,sns-topic-no-public-access,Change triggered,"To update access policies for an SNS topic, see Overview of managing access in Amazon SNS in the Amazon Simple Notification Service Developer Guide."
SQS.1,Amazon SQS queues should be encrypted at rest,This control checks whether Amazon SQS queues are encrypted at rest.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/SQS.1/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/sqs-controls.html#sqs-1,Protect > Data Protection > Encryption of data-at-rest,AWS::SQS::Queue,sqs-queue-encrypted (custom Security Hub rule),Change triggered,"To configure SSE for an SQS queue, see Configuring server-side encryption (SSE) for a queue (console) in the Amazon Simple Queue Service Developer Guide."
SQS.2,SQS queues should be tagged,"This control checks whether an Amazon SQS queue has tags with the specific keys defined in the requiredTagKeys parameter. The control fails if the queue doesn’t have any tag keys or if it doesn’t have all the keys specified in the requiredTagKeys parameter. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the queue isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/SQS.2/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/sqs-controls.html#sqs-2,Identify > Inventory > Tagging,AWS::SQS::Queue,tagged-sqs-queue (custom Security Hub rule),Change triggered,"To add tags to an existing queue using the Amazon SQS console, see Configuring cost allocation tags for an Amazon SQS queue (console) in the Amazon Simple Queue Service Developer Guide."
SQS.3,SQS queue access policies should not allow public access,This controls checks whether an Amazon SQS access policy allows public access to an SQS queue. The control fails if an SQS access policy allows public access to the queue.,HIGH,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/SQS.3/remediation,,1,AWS Foundational Security Best Practices v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/sqs-controls.html#sqs-3,Protect > Secure access management > Resource not publicly accessible,AWS::SQS::Queue,sqs-queue-no-public-access,Change triggered,"For information about configuring the SQS access policy for an SQS queue, see Using custom policies with the Amazon SQS Access Policy Language in the Amazon Simple Queue Service Developer Guide."
SSM.1,EC2 instances should be managed by AWS Systems Manager,This AWS control checks whether the Amazon EC2 instances in your account are managed by AWS Systems Manager.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/SSM.1/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v3.2.1",https://docs.aws.amazon.com/securityhub/latest/userguide/ssm-controls.html#ssm-1,Identify > Inventory,AWS::SSM::PatchCompliance,ec2-instance-managed-by-systems-manager,Change triggered,"To manage EC2 instances with Systems Manager, see Amazon EC2 host management in the AWS Systems Manager User Guide. In the Configuration options section, you can keep the default choices or change them as necessary for your preferred configuration."
SSM.2,EC2 instances managed by Systems Manager should have a patch compliance status of COMPLIANT after a patch installation,This AWS control checks whether the compliance status of the Amazon EC2 Systems Manager patch compliance is COMPLIANT or NON_COMPLIANT after the patch installation on the instance. It only checks instances that are managed by AWS Systems Manager Patch Manager.,HIGH,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/SSM.2/remediation,,4,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v3.2.1, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/ssm-controls.html#ssm-2,Detect > Detection services,AWS::SSM::PatchCompliance,ec2-managedinstance-patch-compliance-status-check,Change triggered,"Systems Manager recommends using patch policies to configure patching for your managed instances. You can also use Systems Manager documents, as described in the following procedure, to patch an instance. To remediate noncompliant patchesOpen the AWS Systems Manager console at https://console.aws.amazon.com/systems-manager/. For Node Management, choose Run Command, and then choose Run command. Choose the option for AWS-RunPatchBaseline. Change the Operation to Install. Choose Choose instances manually, and then choose the noncompliant instances. Choose Run. After the command is complete, to monitor the new compliance status of your patched instances, choose Compliance in the navigation pane."
SSM.3,EC2 instances managed by Systems Manager should have an association compliance status of COMPLIANT,This AWS control checks whether the status of the AWS Systems Manager association compliance is COMPLIANT or NON_COMPLIANT after the association is executed on an instance.,LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/SSM.3/remediation,,4,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v3.2.1, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/ssm-controls.html#ssm-3,Detect > Detection services,AWS::SSM::AssociationCompliance,ec2-managedinstance-association-compliance-status-check,Change triggered,"A failed association can be related to different things, including targets and Systems Manager document names. To remediate this issue, you must first identify and investigate the association by viewing association history. For instructions on viewing association history, see Viewing association histories in the AWS Systems Manager User Guide. After investigating, you can edit the association to correct the identified issue. You can edit an association to specify a new name, schedule, severity level, or targets. After you edit an association, AWS Systems Manager creates a new version. For instructions on editing an association, see Editing and creating a new version of an association in the AWS Systems Manager User Guide."
SSM.4,SSM documents should not be public,"This control checks whether AWS Systems Manager documents that the account owns are public. This control fails if SSM documents that have ""Self"" as the owner are public.",CRITICAL,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/SSM.4/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/ssm-controls.html#ssm-4,Protect > Secure network configuration > Resources not publicly accessible,AWS::SSM::Document,ssm-document-not-public,Periodic,"To block public sharing for Systems Manager documents, see Block public sharing for SSM documents in the AWS Systems Manager User Guide."
SageMaker.1,Amazon SageMaker notebook instances should not have direct internet access,This AWS control checks whether direct internet access is disabled for an Amazon SageMaker notebook instance by examining the DirectInternetAccess field is disabled for an Amazon SageMaker notebook instance.,HIGH,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/SageMaker.1/remediation,,4,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v3.2.1, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/sagemaker-controls.html#sagemaker-1,Protect > Secure network configuration,AWS::SageMaker::NotebookInstance,sagemaker-notebook-no-direct-internet-access,Periodic,"You can't change the internet access setting after creating a notebook instance. Instead, you can stop, delete, and recreate the instance with blocked internet access. To delete a notebook instance that permits direct internet access, see Use notebook instances to build models: Clean up in the Amazon SageMaker AI Developer Guide. To recreate a notebook instance that denies internet access, see Create a notebook instance. For Network, Direct internet access, choose Disable—Access the internet through a VPC."
SageMaker.2,SageMaker notebook instances should be launched in a custom VPC,This control checks if an Amazon SageMaker notebook instance is launched within a custom VPC. The control fails if a SageMaker notebook instance is not launched within a custom VPC.,HIGH,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/SageMaker.2/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/sagemaker-controls.html#sagemaker-2,Protect > Secure network configuration > Resources within VPC,AWS::SageMaker::NotebookInstance,sagemaker-notebook-instance-inside-vpc,Change triggered,"You can't change the VPC setting after creating a notebook instance. Instead, you can stop, delete, and recreate the instance. For instructions, see Use notebook instances to build models: Clean up in the Amazon SageMaker AI Developer Guide."
SageMaker.3,Users should not have root access to SageMaker notebook instances,This control checks whether root access is turned off for Amazon SageMaker notebook instances. The control fails if root access is turned on for a SageMaker notebook instance.,HIGH,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/SageMaker.3/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/sagemaker-controls.html#sagemaker-3,Protect > Secure access management > Root user access restrictions,AWS::SageMaker::NotebookInstance,sagemaker-notebook-instance-root-access-check,Change triggered,"To restrict root access to SageMaker AI notebook instances, see Control root access to a SageMaker AI notebook instance in the Amazon SageMaker AI Developer Guide."
SageMaker.4,SageMaker endpoint production variants should have an initial instance count greater than 1,This control checks whether production variants of an Amazon SageMaker endpoint have an initial instance count greater than 1. The control fails if the endpoint's production variants have only 1 initial instance.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/SageMaker.4/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/sagemaker-controls.html#sagemaker-4,Recover > Resilience > High availability,AWS::SageMaker::EndpointConfig,sagemaker-endpoint-config-prod-instance-count,Periodic,"For more information about the parameters of endpoint configuration, see Create an endpoint configuration in the Amazon SageMaker AI Developer Guide."
SageMaker.5,SageMaker models should block inbound traffic,This control checks whether an Amazon SageMaker hosted model blocks inbound network traffic. The control fails if the EnableNetworkIsolation parameter for the hosted model is set to False.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/SageMaker.5/remediation,,1,AWS Foundational Security Best Practices v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/sagemaker-controls.html#sagemaker-5,Protect > Secure network configuration > Resources not publicly accessible,AWS::SageMaker::Model,sagemaker-model-isolation-enabled,Change triggered,"For more information about network isolation for SageMaker AI models, see Run training and inference containers in internet-free mode in the Amazon SageMaker AI Developer Guide. You can enable network isolation when you create your training job or model by setting the value of the EnableNetworkIsolation parameter to True."
SecretsManager.1,Secrets Manager secrets should have automatic rotation enabled,"This control checks whether a secret stored in AWS Secrets Manager is configured with automatic rotation. The control fails if the secret isn't configured with automatic rotation. If you provide a custom value for the 'maximumAllowedRotationFrequency' parameter, the control passes only if the secret is automatically rotated within the specified window of time.",MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/SecretsManager.1/remediation,"Parameter: maximumAllowedRotationFrequency
Description: Maximum number of days allowed for secret rotation frequency
Type: Integer
Default Value: N/A
Min: 1
Max: 365
---
",3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/secretsmanager-controls.html#secretsmanager-1,Protect > Secure development,AWS::SecretsManager::Secret,secretsmanager-rotation-enabled-check,Change triggered,"To turn on automatic rotation for Secrets Manager secrets, see Set up automatic rotation for AWS Secrets Manager secrets using the console in the AWS Secrets Manager User Guide. You must choose and configure an AWS Lambda function for rotation."
SecretsManager.2,Secrets Manager secrets configured with automatic rotation should rotate successfully,This control checks whether an AWS Secrets Manager secret rotated successfully based on the rotation schedule. The control fails if RotationOccurringAsScheduled is false. The control does not evaluate secrets that do not have rotation configured.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/SecretsManager.2/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/secretsmanager-controls.html#secretsmanager-2,Protect > Secure development,AWS::SecretsManager::Secret,secretsmanager-scheduled-rotation-success-check,Change triggered,"If the automatic rotation fails, then Secrets Manager might have encountered errors with the configuration. To rotate secrets in Secrets Manager, you use a Lambda function that defines how to interact with the database or service that owns the secret. For help diagnosing and fixing common errors related to secrets rotation, see Troubleshooting AWS Secrets Manager rotation of secrets in the AWS Secrets Manager User Guide."
SecretsManager.3,Remove unused Secrets Manager secrets,"This control checks whether an AWS Secrets Manager secret has been accessed within the specified time frame. The control fails if a secret is unused beyond the specified time frame. Unless you provide a custom parameter value for the access period, Security Hub uses a default value of 90 days.",MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/SecretsManager.3/remediation,"Parameter: unusedForDays
Description: Maximum number of days that a secret can remain unused
Type: Integer
Default Value: 90
Min: 1
Max: 365
---
",2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/secretsmanager-controls.html#secretsmanager-3,Protect > Secure access management,AWS::SecretsManager::Secret,secretsmanager-secret-unused,Periodic,"To delete inactive Secrets Manager secrets, see Delete an AWS Secrets Manager secret in the AWS Secrets Manager User Guide."
SecretsManager.4,Secrets Manager secrets should be rotated within a specified number of days,"This control checks whether an AWS Secrets Manager secret is rotated at least once within the specified time frame. The control fails if a secret isn't rotated at least this frequently. Unless you provide a custom parameter value for the rotation period, Security Hub uses a default value of 90 days.",MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/SecretsManager.4/remediation,"Parameter: maxDaysSinceRotation
Description: Maximum number of days that a secret can remain unchanged
Type: Integer
Default Value: 90
Min: 1
Max: 180
---
",3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/secretsmanager-controls.html#secretsmanager-4,Protect > Secure access management,AWS::SecretsManager::Secret,secretsmanager-secret-periodic-rotation,Periodic,"To turn on automatic rotation for Secrets Manager secrets, see Set up automatic rotation for AWS Secrets Manager secrets using the console in the AWS Secrets Manager User Guide. You must choose and configure an AWS Lambda function for rotation."
SecretsManager.5,Secrets Manager secrets should be tagged,"This control checks whether an AWS Secrets Manager secret has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if a secret doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the secret isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/SecretsManager.5/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/secretsmanager-controls.html#secretsmanager-5,Identify > Inventory > Tagging,AWS::SecretsManager::Secret,tagged-secretsmanager-secret (custom Security Hub rule),Change triggered,"To add tags to a Secrets Manager secret, see Tag AWS Secrets Manager secrets in the AWS Secrets Manager User Guide."
ServiceCatalog.1,Service Catalog portfolios should be shared within an AWS organization only,This control checks whether AWS Service Catalog shares portfolios within an organization when the integration with AWS Organizations is enabled. The control fails if portfolios aren't shared within an organization.,HIGH,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/ServiceCatalog.1/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/servicecatalog-controls.html#servicecatalog-1,Protect > Secure access management,AWS::ServiceCatalog::Portfolio,service-catalog-shared-within-organization,Change triggered,"To enable portfolio sharing with Organizations, see Sharing with AWS Organizations in the Service Catalog Administrator Guide"
StepFunctions.1,Step Functions state machines should have logging turned on,"This controls checks whether an AWS Step Functions state machine has logging turned on. The control fails if a state machine doesn't have logging turned on. If you provide a custom value for the 'logLevel' parameter, the control passes only if the state machine has the specified logging level turned on.",MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/StepFunctions.1/remediation,"Parameter: logLevel
Description: Minimum logging level
Type: Enum
Default Value: N/A
Min: N/A
Max: N/A
---
",2,"AWS Foundational Security Best Practices v1.0.0, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/stepfunctions-controls.html#stepfunctions-1,Identify > Logging,AWS::StepFunctions::StateMachine,step-functions-state-machine-logging-enabled,Change triggered,"To turn on logging for a Step Functions state machine, see Configure logging in the AWS Step Functions Developer Guide."
StepFunctions.2,Step Functions activities should be tagged,"This control checks whether an AWS Step Functions activity has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the activity doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the activity isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/StepFunctions.2/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/stepfunctions-controls.html#stepfunctions-2,Identify > Inventory > Tagging,AWS::StepFunctions::Activity,tagged-stepfunctions-activity (custom Security Hub rule),Change triggered,"To add tags to an Step Functions activity, see Tagging in Step Functions in the AWS Step Functions Developer Guide."
Transfer.1,Transfer Family workflows should be tagged,"This control checks whether an AWS Transfer Family workflow has tags with the specific keys defined in the parameter requiredTagKeys. The control fails if the workflow doesn’t have any tag keys or if it doesn’t have all the keys specified in the parameter requiredTagKeys. If the parameter requiredTagKeys isn't provided, the control only checks for the existence of a tag key and fails if the workflow isn't tagged with any key. System tags, which are automatically applied and begin with aws:, are ignored.",LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Transfer.1/remediation,"Parameter: requiredTagKeys
Description: List of non-system tag keys that the evaluated resource must contain. Tag keys are case sensitive.
Type: StringList
Default Value: N/A
Min: N/A
Max: N/A
---
",1,AWS Resource Tagging Standard v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/transfer-controls.html#transfer-1,Identify > Inventory > Tagging,AWS::Transfer::Workflow,tagged-transfer-workflow (custom Security Hub rule),Change triggered,"To add tags to a Transfer Family workflow (console)Open the AWS Transfer Family console.On the navigation pane, choose Workflows. Then, select the workflow that you want to tag.Choose Manage tags, and add the tags."
Transfer.2,Transfer Family servers should not use FTP protocol for endpoint connection,This control checks whether an AWS Transfer Family server uses a protocol other than FTP for endpoint connection. The control fails if the server uses FTP protocol for a client to connect to the server's endpoint.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Transfer.2/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/transfer-controls.html#transfer-2,Protect > Data Protection > Encryption of data-in-transit,AWS::Transfer::Server,transfer-family-server-no-ftp,Periodic,"To modify the protocol for a Transfer Family server, see Edit the file transfer protocols in the AWS Transfer Family User Guide."
Transfer.3,Transfer Family connectors should have logging enabled,This control checks whether Amazon CloudWatch logging is enabled for an AWS Transfer Family connector. The control fails if CloudWatch logging isn't enabled for the connector.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/Transfer.3/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/transfer-controls.html#transfer-3,Identify > Logging,AWS::Transfer::Connector,transfer-connector-logging-enabled,Change triggered,"For information about enabling CloudWatch logging for a Transfer Family connector, see Amazon CloudWatch logging for AWS Transfer Family servers in the AWS Transfer Family User Guide."
WAF.1,AWS WAF Classic Global Web ACL logging should be enabled,This control checks whether logging is enabled for a WAF global Web ACL. This control fails if logging is not enabled for the Web ACL.,MEDIUM,UNAVAILABLE,https://docs.aws.amazon.com/console/securityhub/WAF.1/remediation,,3,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/waf-controls.html#waf-1,Identify > Logging,AWS::WAF::WebACL,waf-classic-logging-enabled,Periodic,"To enable logging for an AWS WAF web ACL, see Logging web ACL traffic information in the AWS WAF Developer Guide."
WAF.2,AWS WAF Classic Regional rules should have at least one condition,This control checks whether a WAF Regional rule has at least one condition. The control fails if no conditions are present within a rule.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/WAF.2/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/waf-controls.html#waf-2,Protect > Secure network configuration,AWS::WAFRegional::Rule,waf-regional-rule-not-empty,Change triggered,"To add a condition to an empty rule, see Adding and removing conditions in a rule in the AWS WAF Developer Guide."
WAF.3,AWS WAF Classic Regional rule groups should have at least one rule,This control checks whether a WAF Regional rule group has at least one rule. The control fails if no rules are present within a rule group.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/WAF.3/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/waf-controls.html#waf-3,Protect > Secure network configuration,AWS::WAFRegional::RuleGroup,waf-regional-rulegroup-not-empty,Change triggered,"To add rules and rule conditions to an empty rule group, see Adding and deleting rules from an AWS WAF Classic rule group and Adding and removing conditions in a rule in the AWS WAF Developer Guide."
WAF.4,AWS WAF Classic Regional web ACLs should have at least one rule or rule group,This control checks whether a WAF Regional web ACL contains any WAF rules or WAF rule groups. This control fails if a web ACL does not contain any WAF rules or rule groups.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/WAF.4/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/waf-controls.html#waf-4,Protect > Secure network configuration,AWS::WAFRegional::WebACL,waf-regional-webacl-not-empty,Change triggered,"To add rules or rule groups to an empty AWS WAF Classic Regional web ACL, see Editing a Web ACL in the AWS WAF Developer Guide."
WAF.6,AWS WAF Classic global rules should have at least one condition,This control checks whether a WAF global rule has at least one condition. This control fails if no conditions are present within a rule.,MEDIUM,UNAVAILABLE,https://docs.aws.amazon.com/console/securityhub/WAF.6/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/waf-controls.html#waf-6,Protect > Secure network configuration,AWS::WAF::Rule,waf-global-rule-not-empty,Change triggered,"For instructions on creating a rule and adding conditions, see Creating a rule and adding conditions in the AWS WAF Developer Guide."
WAF.7,AWS WAF Classic global rule groups should have at least one rule,This control checks whether a WAF global rule group has at least one rule. The control fails if no rules are present within a rule group.,MEDIUM,UNAVAILABLE,https://docs.aws.amazon.com/console/securityhub/WAF.7/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/waf-controls.html#waf-7,Protect > Secure network configuration,AWS::WAF::RuleGroup,waf-global-rulegroup-not-empty,Change triggered,"For instructions on adding a rule to a rule group, see Creating an AWS WAF Classic rule group in the AWS WAF Developer Guide."
WAF.8,AWS WAF Classic global web ACLs should have at least one rule or rule group,This control checks whether a WAF global web ACL contains any WAF rules or WAF rule groups. This control fails if a web ACL does not contain any WAF rules or WAF rule groups.,MEDIUM,UNAVAILABLE,https://docs.aws.amazon.com/console/securityhub/WAF.8/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/waf-controls.html#waf-8,Protect > Secure network configuration,AWS::WAF::WebACL,waf-global-webacl-not-empty,Change triggered,"To add rules or rule groups to an empty AWS WAF global web ACL, see Editing a web ACL in the AWS WAF Developer Guide. For Filter, choose Global (CloudFront)."
WAF.10,AWS WAF web ACLs should have at least one rule or rule group,This control checks whether a WAFV2 web ACL contains at least one WAF rule or WAF rule group. The control fails if a web ACL does not contain any WAF rule or rule group.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/WAF.10/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/waf-controls.html#waf-10,Protect > Secure network configuration,AWS::WAFv2::WebACL,wafv2-webacl-not-empty,Change triggered,"To add rules or rule groups to an empty WAFV2 web ACL, see Editing a Web ACL in the AWS WAF Developer Guide."
WAF.11,AWS WAF web ACL logging should be enabled,This control checks whether logging is enabled for an AWS WAFV2 web ACL. This control fails if logging is not enabled for the web ACL.,LOW,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/WAF.11/remediation,,2,"NIST Special Publication 800-53 Revision 5, PCI DSS v4.0.1",https://docs.aws.amazon.com/securityhub/latest/userguide/waf-controls.html#waf-11,Identify > Logging,AWS::WAFv2::WebACL,wafv2-logging-enabled,Periodic,"To activate logging for an AWS WAF web ACL, see Managing logging for a web ACL in the AWS WAF Developer Guide."
WAF.12,AWS WAF rules should have CloudWatch metrics enabled,This control checks whether an AWS WAF rule or rule group has CloudWatch metrics enabled. This control fails if the rule or rule group does not have CloudWatch metrics enabled.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/WAF.12/remediation,,2,"AWS Foundational Security Best Practices v1.0.0, NIST Special Publication 800-53 Revision 5",https://docs.aws.amazon.com/securityhub/latest/userguide/waf-controls.html#waf-12,Identify > Logging,AWS::WAFv2::RuleGroup,wafv2-rulegroup-logging-enabled,Change triggered,"To enable CloudWatch metrics on an AWS WAF rule group, invoke the UpdateRuleGroup API. To enable CloudWatch metrics on an AWS WAF rule, invoke the UpdateWebACL API. Set the CloudWatchMetricsEnabled field to true. When you use the AWS WAF console to create rules or rule groups, CloudWatch metrics are automatically enabled."
WorkSpaces.1,WorkSpaces user volumes should be encrypted at rest,This control checks whether a user volume in an Amazon WorkSpaces WorkSpace is encrypted at rest. The control fails if the WorkSpace user volume isn't encrypted at rest.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/WorkSpaces.1/remediation,,1,AWS Foundational Security Best Practices v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/workspaces-controls.html#workspaces-1,Protect > Data Protection > Encryption of data-at-rest,AWS::WorkSpaces::Workspace,workspaces-user-volume-encryption-enabled,Change triggered,"To encrypt a WorkSpaces user volume, see Encrypt a WorkSpace in the Amazon WorkSpaces Administration Guide."
WorkSpaces.2,WorkSpaces root volumes should be encrypted at rest,This control checks whether a root volume in an Amazon WorkSpaces WorkSpace is encrypted at rest. The control fails if the WorkSpace root volume isn't encrypted at rest.,MEDIUM,AVAILABLE,https://docs.aws.amazon.com/console/securityhub/WorkSpaces.2/remediation,,1,AWS Foundational Security Best Practices v1.0.0,https://docs.aws.amazon.com/securityhub/latest/userguide/workspaces-controls.html#workspaces-2,Protect > Data Protection > Encryption of data-at-rest,AWS::WorkSpaces::Workspace,workspaces-root-volume-encryption-enabled,Change triggered,"To encrypt a WorkSpaces root volume, see Encrypt a WorkSpace in the Amazon WorkSpaces Administration Guide."
